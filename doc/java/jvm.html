<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.428571; overflow-x: hidden; background: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-variant-alternates: inherit; font-variant-ligatures: inherit; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-variant-position: inherit; font-variant-emoji: inherit; font-feature-settings: inherit; font-optical-sizing: inherit; font-variation-settings: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right-width: 0px; border-right-style: none; border-right-color: currentcolor; background-color: inherit; }
.CodeMirror-linenumber { -webkit-user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: medium; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: medium !important; border-style: none !important; border-color: currentcolor !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; border-bottom-style: none; border-bottom-color: currentcolor; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: medium; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex: 2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.428571rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: "ï„¥"; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: "ï„£"; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left-width: 28px; border-left-style: solid; border-left-color: transparent; border-right-width: 28px; border-right-style: solid; border-right-color: transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: "ï„£"; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right-width: 8px; border-right-style: solid; border-right-color: transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "âˆ’"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }
.md-alert.md-alert-note { border-left-color: rgb(9, 105, 218); }
.md-alert.md-alert-important { border-left-color: rgb(130, 80, 223); }
.md-alert.md-alert-warning { border-left-color: rgb(154, 103, 0); }
.md-alert.md-alert-tip { border-left-color: rgb(31, 136, 61); }
.md-alert.md-alert-caution { border-left-color: rgb(207, 34, 46); }
.md-alert { padding: 0px 1em; margin-bottom: 16px; color: inherit; border-left-width: 0.25em; border-left-style: solid; border-left-color: rgb(0, 0, 0); }
.md-alert-text-note { color: rgb(9, 105, 218); }
.md-alert-text-important { color: rgb(130, 80, 223); }
.md-alert-text-warning { color: rgb(154, 103, 0); }
.md-alert-text-tip { color: rgb(31, 136, 61); }
.md-alert-text-caution { color: rgb(207, 34, 46); }
.md-alert-text { font-size: 0.9rem; font-weight: 700; }
.md-alert-text svg { fill: currentcolor; position: relative; top: 0.125em; margin-right: 1ch; overflow: visible; }
.md-alert-text-container::after { content: attr(data-text); text-transform: capitalize; pointer-events: none; margin-right: 1ch; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: medium !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right-width: 30px; border-right-style: solid; border-right-color: transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right-width: medium; border-right-style: none; border-right-color: currentcolor; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right-width: medium; border-right-style: none; border-right-color: currentcolor; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    pre {
        page-break-inside: avoid;
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.mac-os #write{
    caret-color: AccentColor;
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}


 @media print { @page {margin: 0 0 0 0;} body.typora-export {padding-left: 0; padding-right: 0;} #write {padding:0;}}
</style><title>jvm</title>
</head>
<body class='typora-export typora-export-show-outline typora-export-no-collapse-outline'><div class='typora-export-content'>
<div class="typora-export-sidebar"><div class="outline-content"><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#"><strong>ğŸ </strong></a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ä¸€jvmçš„ä½“ç³»ç»“æ„">ä¸€ã€JVMçš„ä½“ç³»ç»“æ„</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#11-ç±»åŠ è½½å™¨">1.1 ç±»åŠ è½½å™¨</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ä»‹ç»">ä»‹ç»</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™">ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ç±»åŠ è½½å™¨æ€»ç»“">ç±»åŠ è½½å™¨æ€»ç»“</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#è‡ªå®šä¹‰ç±»åŠ è½½å™¨">è‡ªå®šä¹‰ç±»åŠ è½½å™¨</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ç±»æ–‡ä»¶ç»“æ„">ç±»æ–‡ä»¶ç»“æ„</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#åŒäº²å§”æ´¾æœºåˆ¶">åŒäº²å§”æ´¾æœºåˆ¶</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#æ€ä¹ˆæ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹">æ€ä¹ˆæ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ç±»åŠ è½½çš„æµç¨‹">ç±»åŠ è½½çš„æµç¨‹</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#12-è¿è¡Œæ—¶æ•°æ®åŒº">1.2 è¿è¡Œæ—¶æ•°æ®åŒº</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ç¨‹åºè®¡æ•°å™¨">ç¨‹åºè®¡æ•°å™¨</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#è™šæ‹Ÿæœºæ ˆ">è™šæ‹Ÿæœºæ ˆ</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#æœ¬åœ°æ–¹æ³•æ ˆ">æœ¬åœ°æ–¹æ³•æ ˆ</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#å †">å †</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#æ–¹æ³•åŒº">æ–¹æ³•åŒº</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#è¿è¡Œæ—¶å¸¸é‡æ± ">è¿è¡Œæ—¶å¸¸é‡æ± </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#å­—ç¬¦ä¸²å¸¸é‡æ± ">å­—ç¬¦ä¸²å¸¸é‡æ± </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#æ— ç”¨çš„ç±»">æ— ç”¨çš„ç±»ï¼Ÿ</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#åºŸå¼ƒçš„å¸¸é‡">åºŸå¼ƒçš„å¸¸é‡</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ç›´æ¥å†…å­˜">ç›´æ¥å†…å­˜</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#13-æ‰§è¡Œå¼•æ“">1.3 æ‰§è¡Œå¼•æ“</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#14-ä»£ç æ¼”ç¤º">1.4 ä»£ç æ¼”ç¤º</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#äºŒhotspotè™šæ‹Ÿæœº">äºŒã€HotSpotè™šæ‹Ÿæœº</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#21-å¯¹è±¡åˆ›å»ºçš„è¿‡ç¨‹">2.1 å¯¹è±¡åˆ›å»ºçš„è¿‡ç¨‹</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#22-å¯¹è±¡çš„å†…å­˜å¸ƒå±€">2.2 å¯¹è±¡çš„å†…å­˜å¸ƒå±€</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#23-å¯¹è±¡çš„è®¿é—®å®šä½">2.3 å¯¹è±¡çš„è®¿é—®å®šä½</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ä¸‰åƒåœ¾å›æ”¶å™¨gc">ä¸‰ã€åƒåœ¾å›æ”¶å™¨(GC)</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#31-å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡">3.1 å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡ï¼Ÿ</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#32-å¼•ç”¨çš„ç±»å‹">3.2 å¼•ç”¨çš„ç±»å‹</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#33-åƒåœ¾å›æ”¶ç®—æ³•">3.3 åƒåœ¾å›æ”¶ç®—æ³•</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#34-å¸¸è§çš„åƒåœ¾å›æ”¶å™¨">3.4 å¸¸è§çš„åƒåœ¾å›æ”¶å™¨</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#341-serialæ”¶é›†å™¨">3.4.1 Serialæ”¶é›†å™¨</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#342-serialoldæ”¶é›†å™¨">3.4.2 SerialOldæ”¶é›†å™¨</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#343-parallel-scavenge-æ”¶é›†å™¨">3.4.3 Parallel Scavenge æ”¶é›†å™¨ </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#344-parallel-old-æ”¶é›†å™¨">3.4.4 Parallel Old æ”¶é›†å™¨</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#345-parnewæ”¶é›†å™¨">3.4.5 ParNewæ”¶é›†å™¨</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#346-cms-æ”¶é›†å™¨">3.4.6 CMS æ”¶é›†å™¨</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#347-g1æ”¶é›†å™¨">3.4.7 G1æ”¶é›†å™¨</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#35-fullgc-ä¸minorgc">3.5 FullGC ä¸minorGC</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#å››å†…å­˜åˆ†é…ç­–ç•¥ä¸å›æ”¶ç­–ç•¥">å››ã€å†…å­˜åˆ†é…ç­–ç•¥ä¸å›æ”¶ç­–ç•¥</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#41--minor-gc-å’Œ-full-gc">4.1  Minor GC å’Œ Full GC</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#42-å†…å­˜åˆ†é…ç­–ç•¥">4.2 å†…å­˜åˆ†é…ç­–ç•¥</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#43-full-gc-çš„è§¦å‘æ¡ä»¶">4.3 Full GC çš„è§¦å‘æ¡ä»¶</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#äº”é‡ç‚¹çŸ¥è¯†è¡¥å……">äº”ã€é‡ç‚¹çŸ¥è¯†è¡¥å……</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#51-å¸¸é‡æ± ">5.1 å¸¸é‡æ± </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#52-stringç±»ä¸å¸¸é‡æ± ">5.2 Stringç±»ä¸å¸¸é‡æ± </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#53-string-s1--new-stringabcè¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡">5.3 String s1 = new String("abc");è¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Ÿ</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#å…­jvmå‚æ•°">å…­ã€JVMå‚æ•°</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#å †å†…å­˜ç›¸å…³">å †å†…å­˜ç›¸å…³</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#åƒåœ¾æ”¶é›†ç›¸å…³">åƒåœ¾æ”¶é›†ç›¸å…³</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#å¤„ç†oom">å¤„ç†OOM</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#å…¶ä»–">å…¶ä»–</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ä¸ƒjdkç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·æ€»ç»“">ä¸ƒã€JDKç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·æ€»ç»“</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#jdk-å‘½ä»¤è¡Œå·¥å…·">JDK å‘½ä»¤è¡Œå·¥å…·</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#jdk-å¯è§†åŒ–åˆ†æå·¥å…·">JDK å¯è§†åŒ–åˆ†æå·¥å…·</a></div><ul class="outline-children"></ul></li></ul></li></div></div><div id='write'  class=''><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n3"><a class="md-toc-inner" href="#"><strong>ğŸ </strong></a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n4"><a class="md-toc-inner" href="#ä¸€jvmçš„ä½“ç³»ç»“æ„">ä¸€ã€JVMçš„ä½“ç³»ç»“æ„</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n6"><a class="md-toc-inner" href="#11-ç±»åŠ è½½å™¨">1.1 ç±»åŠ è½½å™¨</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n8"><a class="md-toc-inner" href="#ä»‹ç»">ä»‹ç»</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n17"><a class="md-toc-inner" href="#ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™">ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n20"><a class="md-toc-inner" href="#ç±»åŠ è½½å™¨æ€»ç»“">ç±»åŠ è½½å™¨æ€»ç»“</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n34"><a class="md-toc-inner" href="#è‡ªå®šä¹‰ç±»åŠ è½½å™¨">è‡ªå®šä¹‰ç±»åŠ è½½å™¨</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n43"><a class="md-toc-inner" href="#ç±»æ–‡ä»¶ç»“æ„">ç±»æ–‡ä»¶ç»“æ„</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n46"><a class="md-toc-inner" href="#åŒäº²å§”æ´¾æœºåˆ¶">åŒäº²å§”æ´¾æœºåˆ¶</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n72"><a class="md-toc-inner" href="#æ€ä¹ˆæ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹">æ€ä¹ˆæ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n79"><a class="md-toc-inner" href="#ç±»åŠ è½½çš„æµç¨‹">ç±»åŠ è½½çš„æµç¨‹</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n174"><a class="md-toc-inner" href="#12-è¿è¡Œæ—¶æ•°æ®åŒº">1.2 è¿è¡Œæ—¶æ•°æ®åŒº</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n203"><a class="md-toc-inner" href="#ç¨‹åºè®¡æ•°å™¨">ç¨‹åºè®¡æ•°å™¨</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n212"><a class="md-toc-inner" href="#è™šæ‹Ÿæœºæ ˆ">è™šæ‹Ÿæœºæ ˆ</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n233"><a class="md-toc-inner" href="#æœ¬åœ°æ–¹æ³•æ ˆ">æœ¬åœ°æ–¹æ³•æ ˆ</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n267"><a class="md-toc-inner" href="#å †">å †</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n279"><a class="md-toc-inner" href="#æ–¹æ³•åŒº">æ–¹æ³•åŒº</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n303"><a class="md-toc-inner" href="#è¿è¡Œæ—¶å¸¸é‡æ± ">è¿è¡Œæ—¶å¸¸é‡æ± </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n324"><a class="md-toc-inner" href="#å­—ç¬¦ä¸²å¸¸é‡æ± ">å­—ç¬¦ä¸²å¸¸é‡æ± </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n347"><a class="md-toc-inner" href="#æ— ç”¨çš„ç±»">æ— ç”¨çš„ç±»ï¼Ÿ</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n357"><a class="md-toc-inner" href="#åºŸå¼ƒçš„å¸¸é‡">åºŸå¼ƒçš„å¸¸é‡</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n359"><a class="md-toc-inner" href="#ç›´æ¥å†…å­˜">ç›´æ¥å†…å­˜</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n376"><a class="md-toc-inner" href="#13-æ‰§è¡Œå¼•æ“">1.3 æ‰§è¡Œå¼•æ“</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n378"><a class="md-toc-inner" href="#14-ä»£ç æ¼”ç¤º">1.4 ä»£ç æ¼”ç¤º</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n410"><a class="md-toc-inner" href="#äºŒhotspotè™šæ‹Ÿæœº">äºŒã€HotSpotè™šæ‹Ÿæœº</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n411"><a class="md-toc-inner" href="#21-å¯¹è±¡åˆ›å»ºçš„è¿‡ç¨‹">2.1 å¯¹è±¡åˆ›å»ºçš„è¿‡ç¨‹</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n460"><a class="md-toc-inner" href="#22-å¯¹è±¡çš„å†…å­˜å¸ƒå±€">2.2 å¯¹è±¡çš„å†…å­˜å¸ƒå±€</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n469"><a class="md-toc-inner" href="#23-å¯¹è±¡çš„è®¿é—®å®šä½">2.3 å¯¹è±¡çš„è®¿é—®å®šä½</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n482"><a class="md-toc-inner" href="#ä¸‰åƒåœ¾å›æ”¶å™¨gc">ä¸‰ã€åƒåœ¾å›æ”¶å™¨(GC)</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n483"><a class="md-toc-inner" href="#31-å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡">3.1 å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡ï¼Ÿ</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n523"><a class="md-toc-inner" href="#32-å¼•ç”¨çš„ç±»å‹">3.2 å¼•ç”¨çš„ç±»å‹</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n557"><a class="md-toc-inner" href="#33-åƒåœ¾å›æ”¶ç®—æ³•">3.3 åƒåœ¾å›æ”¶ç®—æ³•</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n608"><a class="md-toc-inner" href="#34-å¸¸è§çš„åƒåœ¾å›æ”¶å™¨">3.4 å¸¸è§çš„åƒåœ¾å›æ”¶å™¨</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n642"><a class="md-toc-inner" href="#341-serialæ”¶é›†å™¨">3.4.1 Serialæ”¶é›†å™¨</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n652"><a class="md-toc-inner" href="#342-serialoldæ”¶é›†å™¨">3.4.2 SerialOldæ”¶é›†å™¨</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n659"><a class="md-toc-inner" href="#343-parallel-scavenge-æ”¶é›†å™¨">3.4.3 Parallel Scavenge æ”¶é›†å™¨ </a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n669"><a class="md-toc-inner" href="#344-parallel-old-æ”¶é›†å™¨">3.4.4 Parallel Old æ”¶é›†å™¨</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n671"><a class="md-toc-inner" href="#345-parnewæ”¶é›†å™¨">3.4.5 ParNewæ”¶é›†å™¨</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n678"><a class="md-toc-inner" href="#346-cms-æ”¶é›†å™¨">3.4.6 CMS æ”¶é›†å™¨</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n707"><a class="md-toc-inner" href="#347-g1æ”¶é›†å™¨">3.4.7 G1æ”¶é›†å™¨</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n833"><a class="md-toc-inner" href="#35-fullgc-ä¸minorgc">3.5 FullGC ä¸minorGC</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n871"><a class="md-toc-inner" href="#å››å†…å­˜åˆ†é…ç­–ç•¥ä¸å›æ”¶ç­–ç•¥">å››ã€å†…å­˜åˆ†é…ç­–ç•¥ä¸å›æ”¶ç­–ç•¥</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n872"><a class="md-toc-inner" href="#41--minor-gc-å’Œ-full-gc">4.1  Minor GC å’Œ Full GC</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n878"><a class="md-toc-inner" href="#42-å†…å­˜åˆ†é…ç­–ç•¥">4.2 å†…å­˜åˆ†é…ç­–ç•¥</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n893"><a class="md-toc-inner" href="#43-full-gc-çš„è§¦å‘æ¡ä»¶">4.3 Full GC çš„è§¦å‘æ¡ä»¶</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n909"><a class="md-toc-inner" href="#äº”é‡ç‚¹çŸ¥è¯†è¡¥å……">äº”ã€é‡ç‚¹çŸ¥è¯†è¡¥å……</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n910"><a class="md-toc-inner" href="#51-å¸¸é‡æ± ">5.1 å¸¸é‡æ± </a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n937"><a class="md-toc-inner" href="#52-stringç±»ä¸å¸¸é‡æ± ">5.2 Stringç±»ä¸å¸¸é‡æ± </a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n960"><a class="md-toc-inner" href="#53-string-s1--new-stringabcè¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡">5.3 String s1 = new String("abc");è¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Ÿ</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n971"><a class="md-toc-inner" href="#å…­jvmå‚æ•°">å…­ã€JVMå‚æ•°</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n972"><a class="md-toc-inner" href="#å †å†…å­˜ç›¸å…³">å †å†…å­˜ç›¸å…³</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n995"><a class="md-toc-inner" href="#åƒåœ¾æ”¶é›†ç›¸å…³">åƒåœ¾æ”¶é›†ç›¸å…³</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n1014"><a class="md-toc-inner" href="#å¤„ç†oom">å¤„ç†OOM</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n1028"><a class="md-toc-inner" href="#å…¶ä»–">å…¶ä»–</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n1050"><a class="md-toc-inner" href="#ä¸ƒjdkç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·æ€»ç»“">ä¸ƒã€JDKç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·æ€»ç»“</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n1051"><a class="md-toc-inner" href="#jdk-å‘½ä»¤è¡Œå·¥å…·">JDK å‘½ä»¤è¡Œå·¥å…·</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n1066"><a class="md-toc-inner" href="#jdk-å¯è§†åŒ–åˆ†æå·¥å…·">JDK å¯è§†åŒ–åˆ†æå·¥å…·</a></span></p></div><h1><a href='../../README.html'><strong>ğŸ </strong></a></h1><h1 id='ä¸€jvmçš„ä½“ç³»ç»“æ„'><span>ä¸€ã€JVMçš„ä½“ç³»ç»“æ„</span></h1><p><img src="assets/image-20240618145427762.png" referrerpolicy="no-referrer" alt="image-20240618145427762.png"></p><h3 id='11-ç±»åŠ è½½å™¨'><span>1.1 ç±»åŠ è½½å™¨</span></h3><blockquote><p><strong><span>ç±»åŠ è½½å™¨çš„ä¸»è¦ä½œç”¨å°±æ˜¯åŠ è½½ Java ç±»çš„å­—èŠ‚ç ï¼ˆ </span><code>.class</code><span> æ–‡ä»¶ï¼‰åˆ° JVM ä¸­ï¼ˆåœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¯¥ç±»çš„ </span><code>Class</code><span> å¯¹è±¡ï¼‰ã€‚</span></strong><span> å­—èŠ‚ç å¯ä»¥æ˜¯ Java æºç¨‹åºï¼ˆ</span><code>.java</code><span>æ–‡ä»¶ï¼‰ç»è¿‡ </span><code>javac</code><span> ç¼–è¯‘å¾—æ¥ï¼Œä¹Ÿå¯ä»¥æ˜¯é€šè¿‡å·¥å…·åŠ¨æ€ç”Ÿæˆæˆ–è€…é€šè¿‡ç½‘ç»œä¸‹è½½å¾—æ¥ã€‚</span></p></blockquote><h4 id='ä»‹ç»'><span>ä»‹ç»</span></h4><ul><li><p><span>ç±»åŠ è½½å™¨æ˜¯ä¸€ä¸ªè´Ÿè´£åŠ è½½ç±»çš„å¯¹è±¡ï¼Œç”¨äºå®ç°ç±»åŠ è½½è¿‡ç¨‹ä¸­çš„åŠ è½½è¿™ä¸€æ­¥ã€‚</span></p></li><li><p><span>æ¯ä¸ªè¢«åŠ è½½åçš„ Java ç±»éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘åŠ è½½å®ƒçš„ </span><code>ClassLoader</code><span>ã€‚</span></p></li><li><p><span>æ•°ç»„ç±»ä¸æ˜¯é€šè¿‡ </span><code>ClassLoader</code><span> åˆ›å»ºçš„ï¼ˆæ•°ç»„ç±»æ²¡æœ‰å¯¹åº”çš„äºŒè¿›åˆ¶å­—èŠ‚æµï¼‰ï¼Œæ˜¯ç”± JVM ç›´æ¥ç”Ÿæˆçš„ã€‚</span></p></li></ul><h4 id='ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™'><span>ç±»åŠ è½½å™¨åŠ è½½è§„åˆ™</span></h4><p><span>JVM å¯åŠ¨çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰çš„ç±»ï¼Œè€Œæ˜¯æ ¹æ®éœ€è¦å»åŠ¨æ€åŠ è½½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¤§éƒ¨åˆ†ç±»åœ¨å…·ä½“ç”¨åˆ°çš„æ—¶å€™æ‰ä¼šå»åŠ è½½ï¼Œè¿™æ ·å¯¹å†…å­˜æ›´åŠ å‹å¥½ã€‚</span></p><p><span>å¯¹äºå·²ç»åŠ è½½çš„ç±»ä¼šè¢«æ”¾åœ¨ </span><code>ClassLoader</code><span> ä¸­ã€‚åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šé¦–å…ˆåˆ¤æ–­å½“å‰ç±»æ˜¯å¦è¢«åŠ è½½è¿‡ã€‚å·²ç»è¢«åŠ è½½çš„ç±»ä¼šç›´æ¥è¿”å›ï¼Œå¦åˆ™æ‰ä¼šå°è¯•åŠ è½½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ªç±»åŠ è½½å™¨æ¥è¯´ï¼Œç›¸åŒäºŒè¿›åˆ¶åç§°çš„ç±»åªä¼šè¢«åŠ è½½ä¸€æ¬¡ã€‚</span></p><h4 id='ç±»åŠ è½½å™¨æ€»ç»“'><span>ç±»åŠ è½½å™¨æ€»ç»“</span></h4><p><span>JVM ä¸­å†…ç½®äº†ä¸‰ä¸ªé‡è¦çš„ </span><code>ClassLoader</code><span>ï¼š</span></p><ol start='' ><li><p><strong><code>BootstrapClassLoader</code><span>(å¯åŠ¨ç±»åŠ è½½å™¨)</span></strong><span>ï¼šæœ€é¡¶å±‚çš„åŠ è½½ç±»ï¼Œç”± C++å®ç°ï¼Œé€šå¸¸è¡¨ç¤ºä¸º nullï¼Œå¹¶ä¸”æ²¡æœ‰çˆ¶çº§ï¼Œä¸»è¦ç”¨æ¥åŠ è½½ JDK å†…éƒ¨çš„æ ¸å¿ƒç±»åº“ï¼ˆ </span><code>%JAVA_HOME%/lib</code><span>ç›®å½•ä¸‹çš„ </span><code>rt.jar</code><span>ã€</span><code>resources.jar</code><span>ã€</span><code>charsets.jar</code><span>ç­‰ jar åŒ…å’Œç±»ï¼‰ä»¥åŠè¢« </span><code>-Xbootclasspath</code><span>å‚æ•°æŒ‡å®šçš„è·¯å¾„ä¸‹çš„æ‰€æœ‰ç±»ã€‚</span></p></li><li><p><strong><code>ExtensionClassLoader</code><span>(æ‰©å±•ç±»åŠ è½½å™¨)</span></strong><span>ï¼šä¸»è¦è´Ÿè´£åŠ è½½ </span><code>%JRE_HOME%/lib/ext</code><span> ç›®å½•ä¸‹çš„ jar åŒ…å’Œç±»ä»¥åŠè¢« </span><code>java.ext.dirs</code><span> ç³»ç»Ÿå˜é‡æ‰€æŒ‡å®šçš„è·¯å¾„ä¸‹çš„æ‰€æœ‰ç±»ã€‚</span></p></li><li><p><strong><code>AppClassLoader</code><span>(åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨)</span></strong><span>ï¼šé¢å‘æˆ‘ä»¬ç”¨æˆ·çš„åŠ è½½å™¨ï¼Œè´Ÿè´£åŠ è½½å½“å‰åº”ç”¨ classpath ä¸‹çš„æ‰€æœ‰ jar åŒ…å’Œç±»ã€‚</span></p></li></ol><p><span>é™¤äº†è¿™ä¸‰ç§ç±»åŠ è½½å™¨ä¹‹å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥åŠ å…¥è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨æ¥è¿›è¡Œæ‹“å±•ï¼Œä»¥æ»¡è¶³è‡ªå·±çš„ç‰¹æ®Šéœ€æ±‚ã€‚å°±æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ Java ç±»çš„å­—èŠ‚ç ï¼ˆ </span><code>.class</code><span> æ–‡ä»¶ï¼‰è¿›è¡ŒåŠ å¯†ï¼ŒåŠ è½½æ—¶å†åˆ©ç”¨è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨å¯¹å…¶è§£å¯†ã€‚</span></p><p><span>é™¤äº† </span><code>BootstrapClassLoader</code><span> æ˜¯ JVM è‡ªèº«çš„ä¸€éƒ¨åˆ†ä¹‹å¤–ï¼Œå…¶ä»–æ‰€æœ‰çš„ç±»åŠ è½½å™¨éƒ½æ˜¯åœ¨ JVM å¤–éƒ¨å®ç°çš„ï¼Œå¹¶ä¸”å…¨éƒ½ç»§æ‰¿è‡ª </span><code>ClassLoader</code><span>æŠ½è±¡ç±»ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œä»¥ä¾¿è®©åº”ç”¨ç¨‹åºè‡ªå·±å†³å®šå¦‚ä½•å»è·å–æ‰€éœ€çš„ç±»ã€‚</span></p><p><span>æ¯ä¸ª </span><code>ClassLoader</code><span> å¯ä»¥é€šè¿‡</span><code>getParent()</code><span>è·å–å…¶çˆ¶ </span><code>ClassLoader</code><span>ï¼Œå¦‚æœè·å–åˆ° </span><code>ClassLoader</code><span> ä¸º</span><code>null</code><span>çš„è¯ï¼Œé‚£ä¹ˆè¯¥ç±»æ˜¯é€šè¿‡ </span><code>BootstrapClassLoader</code><span> åŠ è½½çš„ã€‚</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">abstract</span> <span class="cm-keyword">class</span> <span class="cm-def">ClassLoader</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  ...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// çˆ¶åŠ è½½å™¨</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">final</span> <span class="cm-variable">ClassLoader</span> <span class="cm-variable">parent</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-meta">@CallerSensitive</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">public</span> <span class="cm-keyword">final</span> <span class="cm-variable">ClassLoader</span> <span class="cm-variable">getParent</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-comment">//...</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  ...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 253px;"></div><div class="CodeMirror-gutters" style="display: none; height: 253px;"></div></div></div></pre><p><strong><span>ä¸ºä»€ä¹ˆ è·å–åˆ° </span><code>ClassLoader</code><span> ä¸º</span><code>null</code><span>å°±æ˜¯ </span><code>BootstrapClassLoader</code><span> åŠ è½½çš„å‘¢ï¼Ÿ</span></strong><span> è¿™æ˜¯å› ä¸º</span><code>BootstrapClassLoader</code><span> ç”± C++ å®ç°ï¼Œç”±äºè¿™ä¸ª C++ å®ç°çš„ç±»åŠ è½½å™¨åœ¨ Java ä¸­æ˜¯æ²¡æœ‰ä¸ä¹‹å¯¹åº”çš„ç±»çš„ï¼Œæ‰€ä»¥æ‹¿åˆ°çš„ç»“æœæ˜¯ nullã€‚</span></p><h4 id='è‡ªå®šä¹‰ç±»åŠ è½½å™¨'><span>è‡ªå®šä¹‰ç±»åŠ è½½å™¨</span></h4><p><span>æˆ‘ä»¬å‰é¢ä¹Ÿè¯´è¯´äº†ï¼Œé™¤äº† </span><code>BootstrapClassLoader</code><span> å…¶ä»–ç±»åŠ è½½å™¨å‡ç”± Java å®ç°ä¸”å…¨éƒ¨ç»§æ‰¿è‡ª</span><code>java.lang.ClassLoader</code><span>ã€‚å¦‚æœæˆ‘ä»¬è¦è‡ªå®šä¹‰è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œå¾ˆæ˜æ˜¾éœ€è¦ç»§æ‰¿ </span><code>ClassLoader</code><span>æŠ½è±¡ç±»ã€‚</span></p><p><code>ClassLoader</code><span> ç±»æœ‰ä¸¤ä¸ªå…³é”®çš„æ–¹æ³•ï¼š</span></p><ul><li><p><code>protected Class loadClass(String name, boolean resolve)</code><span>ï¼šåŠ è½½æŒ‡å®šäºŒè¿›åˆ¶åç§°çš„ç±»ï¼Œå®ç°äº†åŒäº²å§”æ´¾æœºåˆ¶ ã€‚</span><code>name</code><span> ä¸ºç±»çš„äºŒè¿›åˆ¶åç§°ï¼Œ</span><code>resolve</code><span> å¦‚æœä¸º trueï¼Œåœ¨åŠ è½½æ—¶è°ƒç”¨ </span><code>resolveClass(Class&lt;?&gt; c)</code><span> æ–¹æ³•è§£æè¯¥ç±»ã€‚</span></p></li><li><p><code>protected Class findClass(String name)</code><span>ï¼šæ ¹æ®ç±»çš„äºŒè¿›åˆ¶åç§°æ¥æŸ¥æ‰¾ç±»ï¼Œé»˜è®¤å®ç°æ˜¯ç©ºæ–¹æ³•ã€‚</span></p></li></ul><p><span>å¦‚æœæˆ‘ä»¬ä¸æƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Œå°±é‡å†™ </span><code>ClassLoader</code><span> ç±»ä¸­çš„ </span><code>findClass()</code><span> æ–¹æ³•å³å¯ï¼Œæ— æ³•è¢«çˆ¶ç±»åŠ è½½å™¨åŠ è½½çš„ç±»æœ€ç»ˆä¼šé€šè¿‡è¿™ä¸ªæ–¹æ³•è¢«åŠ è½½ã€‚ä½†æ˜¯ï¼Œå¦‚æœæƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹åˆ™éœ€è¦é‡å†™ </span><code>loadClass()</code><span> æ–¹æ³•ã€‚</span></p><h4 id='ç±»æ–‡ä»¶ç»“æ„'><span>ç±»æ–‡ä»¶ç»“æ„</span></h4><p><span>æ ¹æ® Java è™šæ‹Ÿæœºè§„èŒƒï¼ŒClass æ–‡ä»¶é€šè¿‡ </span><code>ClassFile</code><span> å®šä¹‰ï¼Œæœ‰ç‚¹ç±»ä¼¼ C è¯­è¨€çš„ç»“æ„ä½“ã€‚</span></p><p><img src="assets/image-20240618160902424.png" referrerpolicy="no-referrer" alt="image-20240618160902424"></p><h4 id='åŒäº²å§”æ´¾æœºåˆ¶'><span>åŒäº²å§”æ´¾æœºåˆ¶</span></h4><ul><li><p><strong><span>å½“ä¸€ä¸ªç±»æ”¶åˆ°äº†åŠ è½½è¯·æ±‚æ—¶ï¼Œå®ƒä¸ä¼šå…ˆè‡ªå·±å»å°è¯•åŠ è½½ï¼Œè€Œæ˜¯å§”æ´¾ç»™çˆ¶ç±»å®Œæˆã€‚</span></strong><span> æ¯”å¦‚æˆ‘ç°åœ¨è¦newä¸€ä¸ªPersonï¼Œè¿™ä¸ªPersonæ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»ï¼Œå¦‚æœæˆ‘ä»¬è¦åŠ è½½å®ƒï¼Œå°±ä¼šå…ˆå§”æ´¾AppClassLoaderï¼Œåªæœ‰å½“çˆ¶ç±»åŠ è½½å™¨éƒ½åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªè¯·æ±‚ï¼ˆä¹Ÿå°±æ˜¯çˆ¶ç±»åŠ è½½å™¨éƒ½æ²¡æœ‰æ‰¾åˆ°åŠ è½½æ‰€éœ€çš„Classï¼‰æ—¶ï¼Œå­ç±»åŠ è½½å™¨æ‰ä¼šè‡ªè¡Œå°è¯•åŠ è½½ã€‚</span></p></li><li><p><span>è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯ä¿è¯ä½¿ç”¨ä¸åŒçš„ç±»åŠ è½½å™¨å¾—åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªç»“æœã€‚ä¿è¯äº† Java ç¨‹åºçš„ç¨³å®šè¿è¡Œï¼Œå¯ä»¥é¿å…ç±»çš„é‡å¤åŠ è½½ï¼ˆJVM åŒºåˆ†ä¸åŒç±»çš„æ–¹å¼ä¸ä»…ä»…æ ¹æ®ç±»åï¼Œç›¸åŒçš„ç±»æ–‡ä»¶è¢«ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½äº§ç”Ÿçš„æ˜¯ä¸¤ä¸ªä¸åŒçš„ç±»ï¼‰ï¼Œä¹Ÿä¿è¯äº† Java çš„æ ¸å¿ƒ API ä¸è¢«ç¯¡æ”¹ã€‚</span></p><blockquote><p><span>å¦‚æœæ²¡æœ‰ä½¿ç”¨åŒäº²å§”æ´¾æ¨¡å‹ï¼Œè€Œæ˜¯æ¯ä¸ªç±»åŠ è½½å™¨åŠ è½½è‡ªå·±çš„è¯å°±ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç§°ä¸º </span><code>java.lang.Object</code><span> ç±»çš„è¯ï¼Œé‚£ä¹ˆç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œç³»ç»Ÿå°±ä¼šå‡ºç°ä¸¤ä¸ªä¸åŒçš„ </span><code>Object</code><span> ç±»ã€‚åŒäº²å§”æ´¾æ¨¡å‹å¯ä»¥ä¿è¯åŠ è½½çš„æ˜¯ JRE é‡Œçš„é‚£ä¸ª </span><code>Object</code><span> ç±»ï¼Œè€Œä¸æ˜¯ä½ å†™çš„ </span><code>Object</code><span> ç±»ã€‚è¿™æ˜¯å› ä¸º </span><code>AppClassLoader</code><span> åœ¨åŠ è½½ä½ çš„ </span><code>Object</code><span> ç±»æ—¶ï¼Œä¼šå§”æ‰˜ç»™ </span><code>ExtClassLoader</code><span> å»åŠ è½½ï¼Œè€Œ </span><code>ExtClassLoader</code><span> åˆä¼šå§”æ‰˜ç»™ </span><code>BootstrapClassLoader</code><span>ï¼Œ</span><code>BootstrapClassLoader</code><span> å‘ç°è‡ªå·±å·²ç»åŠ è½½è¿‡äº† </span><code>Object</code><span> ç±»ï¼Œä¼šç›´æ¥è¿”å›ï¼Œä¸ä¼šå»åŠ è½½ä½ å†™çš„ </span><code>Object</code><span> ç±»ã€‚</span></p></blockquote></li></ul><ul><li><p><strong><span>æ‰§è¡Œæµç¨‹</span></strong><span>ï¼šå½“ä¸€ä¸ªç±»åŠ è½½å™¨æ¥æ”¶åˆ°åŠ è½½è¯·æ±‚æ—¶ï¼Œå®ƒä¼šå…ˆå°†è¯·æ±‚è½¬å‘ç»™çˆ¶ç±»åŠ è½½å™¨ã€‚åœ¨çˆ¶ç±»åŠ è½½å™¨æ²¡æœ‰æ‰¾åˆ°æ‰€è¯·æ±‚çš„ç±»çš„æƒ…å†µä¸‹ï¼Œè¯¥ç±»åŠ è½½å™¨æ‰ä¼šå°è¯•å»åŠ è½½ã€‚</span></p><ul><li><p><span>åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šé¦–å…ˆåˆ¤æ–­å½“å‰ç±»æ˜¯å¦è¢«åŠ è½½è¿‡ã€‚å·²ç»è¢«åŠ è½½çš„ç±»ä¼šç›´æ¥è¿”å›ï¼Œå¦åˆ™æ‰ä¼šå°è¯•åŠ è½½ï¼ˆæ¯ä¸ªçˆ¶ç±»åŠ è½½å™¨éƒ½ä¼šèµ°ä¸€éè¿™ä¸ªæµç¨‹ï¼‰ã€‚</span></p></li><li><p><span>ç±»åŠ è½½å™¨åœ¨è¿›è¡Œç±»åŠ è½½çš„æ—¶å€™ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆï¼ˆè°ƒç”¨çˆ¶åŠ è½½å™¨ </span><code>loadClass()</code><span>æ–¹æ³•æ¥åŠ è½½ç±»ï¼‰ã€‚è¿™æ ·çš„è¯ï¼Œæ‰€æœ‰çš„è¯·æ±‚æœ€ç»ˆéƒ½ä¼šä¼ é€åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ </span><code>BootstrapClassLoader</code><span> ä¸­ã€‚</span></p></li><li><p><span>åªæœ‰å½“çˆ¶åŠ è½½å™¨åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªåŠ è½½è¯·æ±‚ï¼ˆå®ƒçš„æœç´¢èŒƒå›´ä¸­æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€çš„ç±»ï¼‰æ—¶ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ï¼ˆè°ƒç”¨è‡ªå·±çš„ </span><code>findClass()</code><span> æ–¹æ³•æ¥åŠ è½½ç±»ï¼‰ã€‚</span></p></li><li><p><span>å¦‚æœå­ç±»åŠ è½½å™¨ä¹Ÿæ— æ³•åŠ è½½è¿™ä¸ªç±»ï¼Œé‚£ä¹ˆå®ƒä¼šæŠ›å‡ºä¸€ä¸ª </span><code>ClassNotFoundException</code><span> å¼‚å¸¸ã€‚</span></p></li></ul></li><li><p><strong><span>JVM åˆ¤å®šä¸¤ä¸ª Java ç±»æ˜¯å¦ç›¸åŒçš„å…·ä½“è§„åˆ™</span></strong><span>ï¼šJVM ä¸ä»…è¦çœ‹ç±»çš„å…¨åæ˜¯å¦ç›¸åŒï¼Œè¿˜è¦çœ‹åŠ è½½æ­¤ç±»çš„ç±»åŠ è½½å™¨æ˜¯å¦ä¸€æ ·ã€‚åªæœ‰ä¸¤è€…éƒ½ç›¸åŒçš„æƒ…å†µï¼Œæ‰è®¤ä¸ºä¸¤ä¸ªç±»æ˜¯ç›¸åŒçš„ã€‚å³ä½¿ä¸¤ä¸ªç±»æ¥æºäºåŒä¸€ä¸ª </span><code>Class</code><span> æ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ªè™šæ‹ŸæœºåŠ è½½ï¼Œåªè¦åŠ è½½å®ƒä»¬çš„ç±»åŠ è½½å™¨ä¸åŒï¼Œé‚£è¿™ä¸¤ä¸ªç±»å°±å¿…å®šä¸ç›¸åŒã€‚</span></p><p>&nbsp;</p></li></ul><p><img src="./images/ç±»åŠ è½½å™¨.png" referrerpolicy="no-referrer" alt="ç±»åŠ è½½å™¨.png"></p><p>&nbsp;</p><h4 id='æ€ä¹ˆæ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹'><span>æ€ä¹ˆæ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ</span></h4><p><span>è‡ªå®šä¹‰åŠ è½½å™¨çš„è¯ï¼Œéœ€è¦ç»§æ‰¿ </span><code>ClassLoader</code><span> ã€‚å¦‚æœæˆ‘ä»¬ä¸æƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Œå°±é‡å†™ </span><code>ClassLoader</code><span> ç±»ä¸­çš„ </span><code>findClass()</code><span> æ–¹æ³•å³å¯ï¼Œæ— æ³•è¢«çˆ¶ç±»åŠ è½½å™¨åŠ è½½çš„ç±»æœ€ç»ˆä¼šé€šè¿‡è¿™ä¸ªæ–¹æ³•è¢«åŠ è½½ã€‚ä½†æ˜¯ï¼Œå¦‚æœæƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹åˆ™éœ€è¦é‡å†™ </span><code>loadClass()</code><span> æ–¹æ³•ã€‚</span></p><p><span>ä¸ºä»€ä¹ˆæ˜¯é‡å†™ </span><code>loadClass()</code><span> æ–¹æ³•æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹å‘¢ï¼ŸåŒäº²å§”æ´¾æ¨¡å‹çš„æ‰§è¡Œæµç¨‹å·²ç»è§£é‡Šäº†ï¼š</span></p><blockquote><p><span>ç±»åŠ è½½å™¨åœ¨è¿›è¡Œç±»åŠ è½½çš„æ—¶å€™ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆï¼ˆè°ƒç”¨çˆ¶åŠ è½½å™¨ </span><code>loadClass()</code><span>æ–¹æ³•æ¥åŠ è½½ç±»ï¼‰ã€‚</span></p></blockquote><p><span>é‡å†™ </span><code>loadClass()</code><span>æ–¹æ³•ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ”¹å˜ä¼ ç»ŸåŒäº²å§”æ´¾æ¨¡å‹çš„æ‰§è¡Œæµç¨‹ã€‚ä¾‹å¦‚ï¼Œå­ç±»åŠ è½½å™¨å¯ä»¥åœ¨å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨ä¹‹å‰ï¼Œå…ˆè‡ªå·±å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œæˆ–è€…åœ¨çˆ¶ç±»åŠ è½½å™¨è¿”å›ä¹‹åï¼Œå†å°è¯•ä»å…¶ä»–åœ°æ–¹åŠ è½½è¿™ä¸ªç±»ã€‚å…·ä½“çš„è§„åˆ™ç”±æˆ‘ä»¬è‡ªå·±å®ç°ï¼Œæ ¹æ®é¡¹ç›®éœ€æ±‚å®šåˆ¶åŒ–ã€‚</span></p><p><span>æˆ‘ä»¬æ¯”è¾ƒç†Ÿæ‚‰çš„ Tomcat æœåŠ¡å™¨ä¸ºäº†èƒ½å¤Ÿä¼˜å…ˆåŠ è½½ Web åº”ç”¨ç›®å½•ä¸‹çš„ç±»ï¼Œç„¶åå†åŠ è½½å…¶ä»–ç›®å½•ä¸‹çš„ç±»ï¼Œå°±è‡ªå®šä¹‰äº†ç±»åŠ è½½å™¨ </span><code>WebAppClassLoader</code><span> æ¥æ‰“ç ´åŒäº²å§”æ‰˜æœºåˆ¶ã€‚è¿™ä¹Ÿæ˜¯ Tomcat ä¸‹ Web åº”ç”¨ä¹‹é—´çš„ç±»å®ç°éš”ç¦»çš„å…·ä½“åŸç†ã€‚</span></p><h4 id='ç±»åŠ è½½çš„æµç¨‹'><span>ç±»åŠ è½½çš„æµç¨‹</span></h4><p><span>ä»ç±»è¢«åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜å¼€å§‹ï¼Œåˆ°é‡Šæ”¾å†…å­˜ä¸€å…±æœ‰7ä¸ªæ­¥éª¤ï¼šåŠ è½½ï¼ŒéªŒè¯ï¼Œå‡†å¤‡ï¼Œè§£æï¼Œåˆå§‹åŒ–ï¼Œä½¿ç”¨ï¼Œå¸è½½ã€‚</span></p><ol start='' ><li><p><strong><span>åŠ è½½</span></strong><span>ï¼š</span><strong><span>æŸ¥æ‰¾å¹¶åŠ è½½ç±»çš„äºŒè¿›åˆ¶æ•°æ®(classæ–‡ä»¶)</span></strong><span>ï¼›æ–¹æ³•åŒºï¼šç±»çš„ç±»ä¿¡æ¯ã€‚å †ï¼šclassæ–‡ä»¶å¯¹åº”çš„ç±»å®ä¾‹ã€‚</span></p><ul><li><p><span>é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµï¼›</span></p></li><li><p><span>å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ï¼›</span></p></li><li><p><span>åœ¨å †ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡ä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®è®¿é—®çš„å…¥å£ï¼›</span></p></li></ul><blockquote><p><strong><span>åŠ è½½è¿™ä¸€æ­¥ä¸»è¦æ˜¯é€šè¿‡æˆ‘ä»¬åé¢è¦è®²åˆ°çš„ </span></strong><span>ç±»åŠ è½½å™¨å®Œæˆçš„ã€‚ç±»åŠ è½½å™¨æœ‰å¾ˆå¤šç§ï¼Œå½“æˆ‘ä»¬æƒ³è¦åŠ è½½ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå…·ä½“æ˜¯å“ªä¸ªç±»åŠ è½½å™¨åŠ è½½ç”± </span><strong><span>åŒäº²å§”æ´¾æ¨¡å‹</span></strong><span> å†³å®šï¼ˆä¸è¿‡ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½æ‰“ç ´ç”±åŒäº²å§”æ´¾æ¨¡å‹ï¼‰ã€‚</span></p><p><span>æ¯ä¸ª Java ç±»éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘åŠ è½½å®ƒçš„ </span><code>ClassLoader</code><span>ã€‚ä¸è¿‡ï¼Œæ•°ç»„ç±»ä¸æ˜¯é€šè¿‡ </span><code>ClassLoader</code><span> åˆ›å»ºçš„ï¼Œè€Œæ˜¯ JVM åœ¨éœ€è¦çš„æ—¶å€™è‡ªåŠ¨åˆ›å»ºçš„ï¼Œæ•°ç»„ç±»é€šè¿‡</span><code>getClassLoader()</code><span>æ–¹æ³•è·å– </span><code>ClassLoader</code><span> çš„æ—¶å€™å’Œè¯¥æ•°ç»„çš„å…ƒç´ ç±»å‹çš„ </span><code>ClassLoader</code><span> æ˜¯ä¸€è‡´çš„ã€‚</span></p><p><span>ä¸€ä¸ªéæ•°ç»„ç±»çš„åŠ è½½é˜¶æ®µï¼ˆåŠ è½½é˜¶æ®µè·å–ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµçš„åŠ¨ä½œï¼‰æ˜¯å¯æ§æ€§æœ€å¼ºçš„é˜¶æ®µï¼Œè¿™ä¸€æ­¥æˆ‘ä»¬å¯ä»¥å»å®Œæˆè¿˜å¯ä»¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨å»æ§åˆ¶å­—èŠ‚æµçš„è·å–æ–¹å¼ï¼ˆé‡å†™ä¸€ä¸ªç±»åŠ è½½å™¨çš„ </span><code>loadClass()</code><span> æ–¹æ³•ï¼‰ã€‚</span></p><p><span>åŠ è½½é˜¶æ®µä¸è¿æ¥é˜¶æ®µçš„éƒ¨åˆ†åŠ¨ä½œ(å¦‚ä¸€éƒ¨åˆ†å­—èŠ‚ç æ–‡ä»¶æ ¼å¼éªŒè¯åŠ¨ä½œ)æ˜¯äº¤å‰è¿›è¡Œçš„ï¼ŒåŠ è½½é˜¶æ®µå°šæœªç»“æŸï¼Œè¿æ¥é˜¶æ®µå¯èƒ½å°±å·²ç»å¼€å§‹äº†ã€‚</span></p><p><img src="assets/image-20240618163649091.png" referrerpolicy="no-referrer" alt="image-20240618163649091.png"></p></blockquote></li><li><p><strong><span>è¿æ¥</span></strong></p><ul><li><p><strong><span>éªŒè¯</span></strong><span>:  </span><strong><span>ç¡®ä¿åŠ è½½çš„ç±»ç¬¦åˆJVMè§„èŒƒå’Œå®‰å…¨</span></strong><span>ï¼Œä¿è¯è¢«æ ¡éªŒç±»çš„æ–¹æ³•åœ¨è¿è¡Œæ—¶ä¸ä¼šåšå‡ºå±å®³è™šæ‹Ÿæœºçš„äº‹ä»¶ï¼›</span></p><ul><li><p><span>æ–‡ä»¶æ ¼å¼éªŒè¯ï¼ˆClass æ–‡ä»¶æ ¼å¼æ£€æŸ¥ï¼‰</span></p></li><li><p><span>å…ƒæ•°æ®éªŒè¯ï¼ˆå­—èŠ‚ç è¯­ä¹‰æ£€æŸ¥ï¼‰</span></p></li><li><p><span>å­—èŠ‚ç éªŒè¯ï¼ˆç¨‹åºè¯­ä¹‰æ£€æŸ¥ï¼‰</span></p></li><li><p><span>ç¬¦å·å¼•ç”¨éªŒè¯ï¼ˆç±»çš„æ­£ç¡®æ€§æ£€æŸ¥ï¼‰</span></p></li></ul><blockquote><p><img src="assets/image-20240618161521174.png" referrerpolicy="no-referrer" alt="image-20240618161521174.png"></p><p><span>æ–‡ä»¶æ ¼å¼éªŒè¯è¿™ä¸€é˜¶æ®µæ˜¯åŸºäºè¯¥ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµè¿›è¡Œçš„ï¼Œä¸»è¦ç›®çš„æ˜¯ä¿è¯è¾“å…¥çš„å­—èŠ‚æµèƒ½æ­£ç¡®åœ°è§£æå¹¶å­˜å‚¨äºæ–¹æ³•åŒºä¹‹å†…ï¼Œæ ¼å¼ä¸Šç¬¦åˆæè¿°ä¸€ä¸ª Java ç±»å‹ä¿¡æ¯çš„è¦æ±‚ã€‚é™¤äº†è¿™ä¸€é˜¶æ®µä¹‹å¤–ï¼Œå…¶ä½™ä¸‰ä¸ªéªŒè¯é˜¶æ®µéƒ½æ˜¯åŸºäºæ–¹æ³•åŒºçš„å­˜å‚¨ç»“æ„ä¸Šè¿›è¡Œçš„ï¼Œä¸ä¼šå†ç›´æ¥è¯»å–ã€æ“ä½œå­—èŠ‚æµäº†ã€‚</span></p><p><span>ç¬¦å·å¼•ç”¨éªŒè¯å‘ç”Ÿåœ¨ç±»åŠ è½½è¿‡ç¨‹ä¸­çš„è§£æé˜¶æ®µï¼Œå…·ä½“ç‚¹è¯´æ˜¯ JVM å°†ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨çš„æ—¶å€™ï¼ˆè§£æé˜¶æ®µä¼šä»‹ç»ç¬¦å·å¼•ç”¨å’Œç›´æ¥å¼•ç”¨ï¼‰ã€‚</span></p><p><span>ç¬¦å·å¼•ç”¨éªŒè¯çš„ä¸»è¦ç›®çš„æ˜¯ç¡®ä¿è§£æé˜¶æ®µèƒ½æ­£å¸¸æ‰§è¡Œï¼Œå¦‚æœæ— æ³•é€šè¿‡ç¬¦å·å¼•ç”¨éªŒè¯ï¼ŒJVM ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ¯”å¦‚ï¼š</span></p></blockquote></li><li><p><strong><span>å‡†å¤‡</span></strong><span>ï¼š</span><strong><span>ä¸ºstaticå˜é‡åœ¨æ–¹æ³•åŒºä¸­åˆ†é…å†…å­˜ç©ºé—´ï¼Œè®¾ç½®å˜é‡åˆå§‹å€¼</span></strong><span>ï¼›</span></p><blockquote><ul><li><p><span>staticå˜é‡åˆ†é…ç©ºé—´å’Œèµ‹å€¼æ˜¯ä¸¤ä¸ªæ­¥éª¤ï¼Œåˆ†é…ç©ºé—´åœ¨å‡†å¤‡é˜¶æ®µå®Œæˆï¼Œèµ‹å€¼åœ¨åˆå§‹åŒ–é˜¶æ®µå®Œæˆã€‚</span></p></li><li><p><span>å¦‚æœstaticå˜é‡æ˜¯finalåŸºæœ¬ç±»å‹ä»¥åŠå­—ç¬¦ä¸²å¸¸é‡ï¼Œé‚£ä¹ˆç¼–è¯‘é˜¶æ®µå€¼å°±ç¡®å®šäº†ï¼Œèµ‹å€¼åœ¨å‡†å¤‡é˜¶æ®µå®Œæˆã€‚</span></p></li><li><p><span>å¦‚æœstaticå˜é‡æ˜¯finalçš„,ä½†å±äºå¼•ç”¨ç±»å‹ï¼Œé‚£ä¹ˆèµ‹å€¼ä¹Ÿä¼šåœ¨åˆå§‹åŒ–é˜¶æ®µå®Œæˆ</span></p></li></ul><p><span>ä»æ¦‚å¿µä¸Šè®²ï¼Œç±»å˜é‡æ‰€ä½¿ç”¨çš„å†…å­˜éƒ½åº”å½“åœ¨ </span><strong><span>æ–¹æ³•åŒº</span></strong><span> ä¸­è¿›è¡Œåˆ†é…ã€‚åœ¨ JDK 7 åŠä¹‹åï¼ŒHotSpot å·²ç»æŠŠåŸæœ¬æ”¾åœ¨æ°¸ä¹…ä»£çš„å­—ç¬¦ä¸²å¸¸é‡æ± ã€é™æ€å˜é‡ç­‰ç§»åŠ¨åˆ°å †ä¸­ï¼Œè¿™ä¸ªæ—¶å€™ç±»å˜é‡åˆ™ä¼šéšç€ Class å¯¹è±¡ä¸€èµ·å­˜æ”¾åœ¨ Java å †ä¸­ã€‚</span></p><p><span>è¿™é‡Œæ‰€è®¾ç½®çš„åˆå§‹å€¼&quot;é€šå¸¸æƒ…å†µ&quot;ä¸‹æ˜¯æ•°æ®ç±»å‹é»˜è®¤çš„é›¶å€¼ï¼ˆå¦‚ 0ã€0Lã€nullã€false ç­‰ï¼‰ï¼Œæ¯”å¦‚æˆ‘ä»¬å®šä¹‰äº†</span><code>public static int value=111</code><span> ï¼Œé‚£ä¹ˆ value å˜é‡åœ¨å‡†å¤‡é˜¶æ®µçš„åˆå§‹å€¼å°±æ˜¯ 0 è€Œä¸æ˜¯ 111ï¼ˆåˆå§‹åŒ–é˜¶æ®µæ‰ä¼šèµ‹å€¼ï¼‰ã€‚ç‰¹æ®Šæƒ…å†µï¼šæ¯”å¦‚ç»™ value å˜é‡åŠ ä¸Šäº† final å…³é”®å­—</span><code>public static final int value=111</code><span> ï¼Œé‚£ä¹ˆå‡†å¤‡é˜¶æ®µ value çš„å€¼å°±è¢«èµ‹å€¼ä¸º 111.</span></p></blockquote></li><li><p><strong><span>è§£æ</span></strong><span>: </span><strong><span>è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹</span></strong><span>ï¼ˆç¬¦å·å¼•ç”¨æ¯”å¦‚æˆ‘ç°åœ¨import java.util.ArrayListè¿™å°±ç®—ç¬¦å·å¼•ç”¨ï¼Œç›´æ¥å¼•ç”¨å°±æ˜¯æŒ‡é’ˆæˆ–è€…å¯¹è±¡åœ°å€ï¼Œæ³¨æ„å¼•ç”¨å¯¹è±¡ä¸€å®šæ˜¯åœ¨å†…å­˜è¿›è¡Œï¼‰ã€‚å…¶ä¸­è§£æè¿‡ç¨‹åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥åœ¨åˆå§‹åŒ–é˜¶æ®µä¹‹åå†å¼€å§‹ï¼Œè¿™æ˜¯ä¸ºäº†æ”¯æŒ Java çš„åŠ¨æ€ç»‘å®š</span></p><blockquote><p><span>ç¬¦å·å¼•ç”¨ï¼šç¬¦å·å¼•ç”¨ä»¥ä¸€ç»„ç¬¦å·æ¥æè¿°æ‰€å¼•ç”¨çš„ç›®æ ‡ï¼Œç¬¦å·å¯ä»¥æ˜¯ä»»ä½•å½¢å¼çš„å­—é¢é‡ï¼Œåªè¦ä½¿ç”¨æ—¶èƒ½æ— æ­§ä¹‰çš„å®šä½åˆ°ç›®æ ‡å³å¯</span></p><p><span>ç›´æ¥å¼•ç”¨ï¼šç›´æ¥å¼•ç”¨æ˜¯å¯ä»¥ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆï¼Œç›¸å¯¹åç§»é‡æˆ–è€…æ˜¯ä¸€ä¸ªèƒ½é—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„ã€‚</span></p><p><span>ä¸¾ä¸ªä¾‹å­ï¼šåœ¨ç¨‹åºæ‰§è¡Œæ–¹æ³•æ—¶ï¼Œç³»ç»Ÿéœ€è¦æ˜ç¡®çŸ¥é“è¿™ä¸ªæ–¹æ³•æ‰€åœ¨çš„ä½ç½®ã€‚Java è™šæ‹Ÿæœºä¸ºæ¯ä¸ªç±»éƒ½å‡†å¤‡äº†ä¸€å¼ æ–¹æ³•è¡¨æ¥å­˜æ”¾ç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•ã€‚å½“éœ€è¦è°ƒç”¨ä¸€ä¸ªç±»çš„æ–¹æ³•çš„æ—¶å€™ï¼Œåªè¦çŸ¥é“è¿™ä¸ªæ–¹æ³•åœ¨æ–¹æ³•è¡¨ä¸­çš„åç§»é‡å°±å¯ä»¥ç›´æ¥è°ƒç”¨è¯¥æ–¹æ³•äº†ã€‚é€šè¿‡è§£ææ“ä½œç¬¦å·å¼•ç”¨å°±å¯ä»¥ç›´æ¥è½¬å˜ä¸ºç›®æ ‡æ–¹æ³•åœ¨ç±»ä¸­æ–¹æ³•è¡¨çš„ä½ç½®ï¼Œä»è€Œä½¿å¾—æ–¹æ³•å¯ä»¥è¢«è°ƒç”¨ã€‚</span></p><p><span>ç»¼ä¸Šï¼Œè§£æé˜¶æ®µæ˜¯è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯å¾—åˆ°ç±»æˆ–è€…å­—æ®µã€æ–¹æ³•åœ¨å†…å­˜ä¸­çš„æŒ‡é’ˆæˆ–è€…åç§»é‡ã€‚</span></p></blockquote></li></ul></li><li><p><strong><span>åˆå§‹åŒ–</span></strong><span>ï¼š</span><strong><span>JVMå¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ï¼Œå¯¹é™æ€å˜é‡èµ‹äºˆæ­£ç¡®å€¼ã€‚</span></strong><span>åˆå§‹åŒ–å…¶å®å°±æ˜¯æ‰§è¡Œç±»æ„é€ å™¨æ–¹æ³•çš„</span><clinit><span>()çš„è¿‡ç¨‹ï¼Œè€Œä¸”è¦ä¿è¯æ‰§è¡Œå‰çˆ¶ç±»çš„</span><clinit><span>()æ–¹æ³•æ‰§è¡Œå®Œæ¯•ã€‚è¿™ä¸ªæ–¹æ³•ç”±ç¼–è¯‘å™¨æ”¶é›†ï¼Œé¡ºåºæ‰§è¡Œæ‰€æœ‰ç±»å˜é‡ï¼ˆstaticä¿®é¥°çš„æˆå‘˜å˜é‡ï¼‰æ˜¾å¼åˆå§‹åŒ–å’Œé™æ€ä»£ç å—ä¸­è¯­å¥ã€‚æ­¤æ—¶å‡†å¤‡é˜¶æ®µæ—¶çš„é‚£ä¸ª static int a ç”±é»˜è®¤åˆå§‹åŒ–çš„0å˜æˆäº†æ˜¾å¼åˆå§‹åŒ–çš„3. ç”±äºæ‰§è¡Œé¡ºåºç¼˜æ•…ï¼Œåˆå§‹åŒ–é˜¶æ®µç±»å˜é‡å¦‚æœåœ¨é™æ€ä»£ç å—ä¸­åˆè¿›è¡Œäº†æ›´æ”¹ï¼Œä¼šè¦†ç›–ç±»å˜é‡çš„æ˜¾å¼åˆå§‹åŒ–ï¼Œæœ€ç»ˆå€¼ä¼šä¸ºé™æ€ä»£ç å—ä¸­çš„èµ‹å€¼ã€‚</span></p><blockquote><ol start='' ><li><p><span>å½“é‡åˆ° </span><code>new</code><span>ã€</span><code>getstatic</code><span>ã€</span><code>putstatic</code><span>ï¼Œ</span><code>invokestatic</code><span>è¿™ 4 æ¡å­—èŠ‚ç æŒ‡ä»¤æ—¶ï¼Œæ¯”å¦‚ newä¸€ä¸ªç±»ï¼Œè¯»å–ä¸€ä¸ªé™æ€å­—æ®µ(æœªè¢« final ä¿®é¥°)ã€æˆ–è°ƒç”¨ä¸€ä¸ªç±»çš„é™æ€æ–¹æ³•æ—¶ã€‚ </span></p><ul><li><p><strong><span>å½“ jvm æ‰§è¡Œ </span><code>new</code><span> æŒ‡ä»¤æ—¶ä¼šåˆå§‹åŒ–ç±»ã€‚</span></strong><span>å³å½“ç¨‹åºåˆ›å»ºä¸€ä¸ªç±»çš„å®ä¾‹å¯¹è±¡ã€‚</span></p></li><li><p><span>å½“ jvm æ‰§è¡Œ </span><code>getstatic</code><span> æŒ‡ä»¤æ—¶ä¼šåˆå§‹åŒ–ç±»ã€‚å³</span><strong><span>ç¨‹åºè®¿é—®ç±»çš„é™æ€å˜é‡</span></strong><span>(ä¸æ˜¯é™æ€å¸¸é‡ï¼Œå¸¸é‡ä¼šè¢«åŠ è½½åˆ°è¿è¡Œæ—¶å¸¸é‡æ± )ã€‚</span></p></li><li><p><span>å½“ jvm æ‰§è¡Œ </span><code>putstatic</code><span> æŒ‡ä»¤æ—¶ä¼šåˆå§‹åŒ–ç±»ã€‚å³</span><strong><span>ç¨‹åºç»™ç±»çš„é™æ€å˜é‡èµ‹å€¼</span></strong><span>ã€‚</span></p></li><li><p><span>å½“ jvm æ‰§è¡Œ </span><code>invokestatic</code><span> æŒ‡ä»¤æ—¶ä¼šåˆå§‹åŒ–ç±»ã€‚å³</span><strong><span>new ä¼šå¯¼è‡´åˆå§‹åŒ–</span></strong><span>ã€‚</span></p></li></ul></li><li><p><span>ä½¿ç”¨ </span><code>java.lang.reflect</code><span> åŒ…çš„æ–¹æ³•å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨æ—¶å¦‚ </span><code>Class.forName(&quot;...&quot;)</code><span>, </span><code>newInstance()</code><span> ç­‰ç­‰ã€‚å¦‚æœç±»æ²¡åˆå§‹åŒ–ï¼Œéœ€è¦è§¦å‘å…¶åˆå§‹åŒ–ã€‚</span></p></li><li><p><span>åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œå¦‚æœå…¶çˆ¶ç±»è¿˜æœªåˆå§‹åŒ–ï¼Œåˆ™å…ˆè§¦å‘è¯¥çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚</span></p></li><li><p><span>å½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œç”¨æˆ·éœ€è¦å®šä¹‰ä¸€ä¸ªè¦æ‰§è¡Œçš„ä¸»ç±» (åŒ…å« </span><code>main</code><span> æ–¹æ³•çš„é‚£ä¸ªç±»)ï¼Œè™šæ‹Ÿæœºä¼šå…ˆåˆå§‹åŒ–è¿™ä¸ªç±»ã€‚</span></p></li><li><p><code>MethodHandle</code><span> å’Œ </span><code>VarHandle</code><span> å¯ä»¥çœ‹ä½œæ˜¯è½»é‡çº§çš„åå°„è°ƒç”¨æœºåˆ¶ï¼Œè€Œè¦æƒ³ä½¿ç”¨è¿™ 2 ä¸ªè°ƒç”¨ï¼Œ</span>
<span>å°±å¿…é¡»å…ˆä½¿ç”¨ </span><code>findStaticVarHandle</code><span> æ¥åˆå§‹åŒ–è¦è°ƒç”¨çš„ç±»ã€‚</span></p></li><li><p><strong><span>ã€Œè¡¥å……ï¼Œæ¥è‡ª</span><a href='https://github.com/Snailclimb/JavaGuide/issues/745'><span>issue745open in new window</span></a><span>ã€</span></strong><span> å½“ä¸€ä¸ªæ¥å£ä¸­å®šä¹‰äº† JDK8 æ–°åŠ å…¥çš„é»˜è®¤æ–¹æ³•ï¼ˆè¢« default å…³é”®å­—ä¿®é¥°çš„æ¥å£æ–¹æ³•ï¼‰æ—¶ï¼Œå¦‚æœæœ‰è¿™ä¸ªæ¥å£çš„å®ç°ç±»å‘ç”Ÿäº†åˆå§‹åŒ–ï¼Œé‚£è¯¥æ¥å£è¦åœ¨å…¶ä¹‹å‰è¢«åˆå§‹åŒ–ã€‚</span></p></li></ol><p><span>ä»¥ä¸‹æƒ…å†µä¸ä¼šåˆå§‹åŒ–</span></p><ul><li><p><span>è®¿é—®ç±»çš„ static ï¬nal é™æ€å¸¸é‡ï¼ˆåŸºæœ¬ç±»å‹å’Œå­—ç¬¦ä¸²ï¼‰</span></p></li><li><p><span>ç±»å¯¹è±¡.class ä¸ä¼šè§¦å‘åˆå§‹åŒ–</span></p></li><li><p><span>åˆ›å»ºè¯¥ç±»å¯¹è±¡çš„æ•°ç»„</span></p></li><li><p><span>ç±»åŠ è½½å™¨çš„.loadClassæ–¹æ³•</span></p></li><li><p><span>Class.forNamedçš„å‚æ•°2ä¸ºfalseæ—¶</span></p></li></ul><p><strong><span>éªŒè¯ç±»æ˜¯å¦è¢«åˆå§‹åŒ–ï¼Œå¯ä»¥çœ‹æ”¹ç±»çš„é™æ€ä»£ç å—æ˜¯å¦è¢«æ‰§è¡Œ</span></strong></p></blockquote></li><li><p><strong><span>å¸è½½</span></strong><span>ï¼š</span><strong><span>GCå°†æ— ç”¨å¯¹è±¡ä»å†…å­˜ä¸­å¸é™¤</span></strong><span>ã€‚å¸è½½ç±»éœ€è¦æ»¡è¶³ 3 ä¸ªè¦æ±‚:</span></p><ul><li><p><span>è¯¥ç±»çš„æ‰€æœ‰çš„å®ä¾‹å¯¹è±¡éƒ½å·²è¢« GCï¼Œä¹Ÿå°±æ˜¯è¯´å †ä¸å­˜åœ¨è¯¥ç±»çš„å®ä¾‹å¯¹è±¡ã€‚</span></p></li><li><p><span>è¯¥ç±»æ²¡æœ‰åœ¨å…¶ä»–ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨</span></p></li><li><p><span>è¯¥ç±»çš„ç±»åŠ è½½å™¨çš„å®ä¾‹å·²è¢« GC</span></p></li></ul><p><span>æ‰€ä»¥ï¼Œåœ¨ JVM ç”Ÿå‘½å‘¨æœŸå†…ï¼Œç”± jvm è‡ªå¸¦çš„ç±»åŠ è½½å™¨åŠ è½½çš„ç±»æ˜¯ä¸ä¼šè¢«å¸è½½çš„ã€‚ä½†æ˜¯ç”±æˆ‘ä»¬è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨åŠ è½½çš„ç±»æ˜¯å¯èƒ½è¢«å¸è½½çš„ã€‚</span></p></li></ol><h3 id='12-è¿è¡Œæ—¶æ•°æ®åŒº'><span>1.2 è¿è¡Œæ—¶æ•°æ®åŒº</span></h3><p><img src="./images/JVMè¿è¡Œæ—¶æ•°æ®åŒºåŸŸ.png" referrerpolicy="no-referrer" alt="JVMè¿è¡Œæ—¶æ•°æ®åŒºåŸŸ.png"></p><p><img src="./images/Javaè¿è¡Œæ—¶æ•°æ®åŒºåŸŸJDK1.8.png" referrerpolicy="no-referrer" alt="Javaè¿è¡Œæ—¶æ•°æ®åŒºåŸŸJDK1.8.png"></p><p>&nbsp;</p><p><strong><span>çº¿ç¨‹ç§æœ‰çš„</span></strong><span>:</span></p><ul><li><p><span>ç¨‹åºè®¡æ•°å™¨</span></p></li><li><p><span>è™šæ‹Ÿæœºæ ˆ</span></p></li><li><p><span>æœ¬åœ°æ–¹æ³•æ ˆ</span></p></li></ul><p><strong><span>çº¿ç¨‹å…±äº«çš„</span></strong><span>ï¼š</span></p><ul><li><p><span>å †</span></p></li><li><p><span>æ–¹æ³•åŒº</span></p></li><li><p><span>ç›´æ¥å†…å­˜</span></p></li></ul><h4 id='ç¨‹åºè®¡æ•°å™¨'><span>ç¨‹åºè®¡æ•°å™¨</span></h4><ul><li><p><span>å­—èŠ‚ç è§£é‡Šå™¨é€šè¿‡æ”¹å˜ç¨‹åºè®¡æ•°å™¨æ¥ä¾æ¬¡è¯»å–æŒ‡ä»¤ï¼Œä»è€Œ</span><strong><span>å®ç°ä»£ç çš„æµç¨‹æ§åˆ¶</span></strong><span>ï¼Œå¦‚:é¡ºåºæ‰§è¡Œï¼Œé€‰æ‹©ï¼Œå¾ªç¯ï¼Œå¼‚å¸¸å¤„ç†ã€‚</span></p></li><li><p><span>åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œç¨‹åºè®¡æ•°å™¨ç”¨äº</span><strong><span>è®°å½•å½“å‰çº¿ç¨‹çš„æ‰§è¡Œä½ç½®</span></strong><span>ï¼Œä»è€Œå½“çº¿ç¨‹è¢«åˆ‡æ¢å›æ¥çš„æ—¶å€™èƒ½å¤Ÿç›´åˆ°è¯¥çº¿ç¨‹ä¸Šæ¬¡è¿è¡Œåˆ°å“ªäº†ã€‚</span></p></li><li><p><span>å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ª</span><code>java</code><span>æ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼Œå¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯æœ¬åœ°æ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨åˆ™åº”è¯¥ä¸ºç©ºã€‚</span></p></li><li><p><span>æ­¤å†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªæ²¡æœ‰è§„å®šä»»ä½•</span><code>OutOfMemoryError</code><span>æƒ…å†µçš„åŒºåŸŸã€‚</span></p></li></ul><h4 id='è™šæ‹Ÿæœºæ ˆ'><span>è™šæ‹Ÿæœºæ ˆ</span></h4><ul><li><p><strong><span>æ¯ä¸ªçº¿ç¨‹è¿è¡Œæ‰€éœ€è¦çš„å†…å­˜ï¼Œç§°ä¸ºè™šæ‹Ÿæœºæ ˆã€‚</span></strong></p></li><li><p><strong><span>é™¤äº†ä¸€äº› Native æ–¹æ³•è°ƒç”¨æ˜¯é€šè¿‡æœ¬åœ°æ–¹æ³•æ ˆå®ç°çš„(åé¢ä¼šæåˆ°)ï¼Œå…¶ä»–æ‰€æœ‰çš„ Java æ–¹æ³•è°ƒç”¨éƒ½æ˜¯é€šè¿‡æ ˆæ¥å®ç°çš„ï¼ˆä¹Ÿéœ€è¦å’Œå…¶ä»–è¿è¡Œæ—¶æ•°æ®åŒºåŸŸæ¯”å¦‚ç¨‹åºè®¡æ•°å™¨é…åˆï¼‰ã€‚</span></strong></p></li><li><p><strong><span>javaè™šæ‹Ÿæœºæ ˆæ˜¯ç”±ä¸€ä¸ªä¸ªæ ˆå¸§ç»„æˆï¼Œå¯¹åº”ç€æ¯æ¬¡æ–¹æ³•è°ƒç”¨æ—¶æ‰€å çš„å†…å­˜ã€‚æ¯ä¸ªæ ˆå¸§éƒ½æœ‰ï¼šå±€éƒ¨å˜é‡è¡¨ï¼Œæ“ä½œæ•°æ ˆï¼ŒåŠ¨æ€é“¾æ¥ï¼Œæ–¹æ³•è¿”å›åœ°å€ç­‰ä¿¡æ¯ã€‚</span></strong></p><ul><li><p><strong><span>å±€éƒ¨å˜é‡è¡¨</span></strong><span>ä¸»è¦å­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„å„ç§</span><code>Java</code><span>è™šæ‹Ÿæœºçš„å„ç§åŸºæœ¬æ•°æ®ç±»å‹(boolean,byte,char,short,int float,long,double)ï¼Œå¯¹è±¡å¼•ç”¨ï¼ˆreferenceç±»å‹ï¼Œå®ƒå¹¶ä¸ç­‰åŒäºå¯¹è±¡æœ¬èº«ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡èµ·å§‹åœ°å€çš„å¼•ç”¨æŒ‡é’ˆï¼Œä¹Ÿå¯èƒ½æ˜¯æŒ‡å‘ä¸€ä¸ªä»£è¡¨å¯¹è±¡çš„å¥æŸ„æˆ–è€…ä¸æ­¤å¯¹è±¡ç›¸å…³çš„ä½ç½®ï¼‰ã€</span><code>returnAddress</code><span>ç±»å‹(æŒ‡å‘äº†ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼Œåˆè¡·æ˜¯ç”¨æ¥å®ç°Javaè¯­è¨€ä¸­çš„finallyè¯­å¥å—)ã€‚</span></p></li><li><p><strong><span>æ“ä½œæ•°æ ˆ</span></strong><span> ä¸»è¦ä½œä¸ºæ–¹æ³•è°ƒç”¨çš„ä¸­è½¬ç«™ä½¿ç”¨ï¼Œç”¨äºå­˜æ”¾æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä¸­é—´è®¡ç®—ç»“æœã€‚å¦å¤–ï¼Œè®¡ç®—è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä¸´æ—¶å˜é‡ä¹Ÿä¼šæ”¾åœ¨æ“ä½œæ•°æ ˆä¸­ã€‚</span></p></li><li><p><strong><span>åŠ¨æ€é“¾æ¥</span></strong><span> ä¸»è¦æœåŠ¡ä¸€ä¸ªæ–¹æ³•éœ€è¦è°ƒç”¨å…¶ä»–æ–¹æ³•çš„åœºæ™¯ã€‚Class æ–‡ä»¶çš„å¸¸é‡æ± é‡Œä¿å­˜æœ‰å¤§é‡çš„ç¬¦å·å¼•ç”¨æ¯”å¦‚æ–¹æ³•å¼•ç”¨çš„ç¬¦å·å¼•ç”¨ã€‚å½“ä¸€ä¸ªæ–¹æ³•è¦è°ƒç”¨å…¶ä»–æ–¹æ³•ï¼Œéœ€è¦å°†å¸¸é‡æ± ä¸­æŒ‡å‘æ–¹æ³•çš„ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºå…¶åœ¨å†…å­˜åœ°å€ä¸­çš„ç›´æ¥å¼•ç”¨ã€‚åŠ¨æ€é“¾æ¥çš„ä½œç”¨å°±æ˜¯ä¸ºäº†å°†ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºè°ƒç”¨æ–¹æ³•çš„ç›´æ¥å¼•ç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿè¢«ç§°ä¸º </span><strong><span>åŠ¨æ€è¿æ¥</span></strong><span> ã€‚</span></p></li><li><p><strong><span>æ–¹æ³•è¿”å›åœ°å€</span></strong><span>ï¼šæ–¹æ³•æ­£å¸¸é€€å‡ºæˆ–è€…å¼‚å¸¸é€€å‡ºçš„å®šä¹‰</span></p></li></ul></li><li><p><strong><span>æ¯ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸€æ¬¡æ´»åŠ¨æ ˆå¸§ï¼Œå¯¹åº”ç€å½“å‰æ­£åœ¨æ‰§è¡Œçš„é‚£ä¸ªæ–¹æ³•ã€‚</span></strong></p></li><li><p><strong><span>ä¸¤ç±»å¼‚å¸¸</span></strong><span>ï¼šå¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼Œå°†ä¼šæŠ›å‡º</span><code>StackOverflowError</code><span>å¼‚å¸¸ï¼›å¦‚æœ</span><code>java</code><span>è™šæ‹Ÿæœºæ ˆå®¹é‡å¯ä»¥åŠ¨æ€æ‰©å±•(HotSpotä¸èƒ½æ‰©å±•)ï¼Œå½“æ ˆæ‰©å±•æ—¶æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ä¼šæŠ›å‡º</span><code>OutOfMemoryError</code><span>å¼‚å¸¸ã€‚</span></p><blockquote><ul><li><p><span>å½“æ¯ä¸ªæ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™ï¼ŒJavaè™šæ‹Ÿæœºéƒ½ä¼šåŒæ­¥åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œæ¯ä¸ªæ–¹æ³•è¢«è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæ¯•çš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§å†è™šæ‹Ÿæœºä»å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚</span></p></li><li><p><span>åŸºæœ¬æ•°æ®ç±»å‹åŒ…æ‹¬ boolean, byte,char,short,int,float,double,long.</span></p></li><li><p><span>å¯¹è±¡å¼•ç”¨ï¼šreferenceç±»å‹ï¼Œå®ƒå¹¶ä¸ç­‰åŒäºå¯¹è±¡æœ¬èº«ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡èµ·å§‹åœ°å€çš„å¼•ç”¨æŒ‡é’ˆï¼Œä¹Ÿå¯èƒ½ä½¿æŒ‡å‘ä¸€ä¸ªä»£è¡¨å¯¹è±¡çš„å¥æŸ„æˆ–è€…å…¶ä»–ä¸æ­¤å¯¹è±¡ç›¸å…³çš„ä½ç½®ã€‚</span></p></li><li><p><code>returnAddress</code><span>ç±»å‹ï¼šæŒ‡å‘äº†ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ã€‚</span></p></li><li><p><span>åƒåœ¾å›æ”¶ä¸æ¶‰åŠæ ˆå†…å­˜ï¼Œæ ˆå†…å­˜åœ¨æ¯æ¬¡æ–¹æ³•è°ƒç”¨å®Œæ¯•å‡ºæ ˆä¹‹åå°±è‡ªåŠ¨è¢«å›æ”¶äº†ã€‚</span></p></li><li><p><span>çº¿ç¨‹å®‰å…¨é—®é¢˜</span></p><ul><li><p><span>å¦‚æœæ–¹æ³•å†…å±€éƒ¨å˜é‡æ²¡æœ‰é€ƒç¦»æ–¹æ³•çš„ä½œç”¨èŒƒå›´ï¼Œå®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</span></p></li><li><p><span>å¦‚æœå±€éƒ¨å˜é‡å¼•ç”¨äº†å¯¹è±¡ï¼Œå¹¶é€ƒç¦»æ–¹æ³•çš„ä½œç”¨èŒƒå›´ï¼Œéœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</span></p></li></ul></li><li><p><span>æ ˆå†…å­˜æº¢å‡º</span></p><ul><li><p><span>æ ˆå¸§è¿‡å¤šé€ æˆæ ˆå†…å­˜æº¢å‡º</span></p></li><li><p><span>å•ä¸ªæ ˆå¸§è¿‡å¤§é€ æˆæ ˆå†…å­˜æº¢å‡º(ä¸å¤ªå®¹æ˜“å‡ºç°)</span></p></li></ul></li></ul></blockquote></li></ul><h4 id='æœ¬åœ°æ–¹æ³•æ ˆ'><span>æœ¬åœ°æ–¹æ³•æ ˆ</span></h4><ul><li><p><strong><span>æœ¬åœ°æ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œåœ¨æœ¬åœ°æ–¹æ³•æ ˆä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œç”¨äºå­˜æ”¾è¯¥æœ¬åœ°æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€å‡ºå£ä¿¡æ¯ã€‚</span></strong></p></li><li><p><span>è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡Œ Java æ–¹æ³• ï¼ˆä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼‰æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„Nativeæ–¹æ³•æœåŠ¡ã€‚ </span></p></li><li><p><span>åœ¨ HotSpot è™šæ‹Ÿæœºä¸­å’Œ Java è™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€ã€‚</span></p></li></ul><h4 id='å †'><span>å †</span></h4><ul><li><p><strong><span>ç”¨äºå­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ä»¥åŠæ•°ç»„éƒ½åœ¨è¿™é‡Œåˆ†é…ã€‚</span></strong></p></li><li><p><span>Java ä¸–ç•Œä¸­â€œå‡ ä¹â€æ‰€æœ‰çš„å¯¹è±¡éƒ½åœ¨å †ä¸­åˆ†é…ï¼Œä½†æ˜¯ï¼Œéšç€ JIT ç¼–è¯‘æœŸçš„å‘å±•ä¸é€ƒé€¸åˆ†ææŠ€æœ¯é€æ¸æˆç†Ÿï¼Œæ ˆä¸Šåˆ†é…ã€æ ‡é‡æ›¿æ¢ä¼˜åŒ–æŠ€æœ¯å°†ä¼šå¯¼è‡´ä¸€äº›å¾®å¦™çš„å˜åŒ–ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½åˆ†é…åˆ°å †ä¸Šä¹Ÿæ¸æ¸å˜å¾—ä¸é‚£ä¹ˆâ€œç»å¯¹â€äº†ã€‚ä» JDK 1.7 å¼€å§‹å·²ç»é»˜è®¤å¼€å¯é€ƒé€¸åˆ†æï¼Œ</span><strong><span>å¦‚æœæŸäº›æ–¹æ³•ä¸­çš„å¯¹è±¡å¼•ç”¨æ²¡æœ‰è¢«è¿”å›æˆ–è€…æœªè¢«å¤–é¢ä½¿ç”¨ï¼ˆä¹Ÿå°±æ˜¯æœªé€ƒé€¸å‡ºå»ï¼‰ï¼Œé‚£ä¹ˆå¯¹è±¡å¯ä»¥ç›´æ¥åœ¨æ ˆä¸Šåˆ†é…å†…å­˜ã€‚</span></strong></p></li><li><p><span>åœ¨JDK7ç‰ˆæœ¬ä»¥åŠä»¥å‰çš„ç‰ˆæœ¬ï¼Œå †å†…å­˜åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š</span><strong><span>æ–°ç”Ÿä»£(Eden ç©ºé—´ã€From Survivorã€To Survivor )</span></strong><span>ï¼Œ</span><strong><span>è€ç”Ÿä»£</span></strong><span>ï¼Œ</span><strong><span>æ°¸ä¹…ä»£ã€‚</span></strong></p></li><li><p><span>åœ¨JDK8ä¹‹åæ–¹æ³•åŒº(HotSpotçš„</span><strong><span>æ°¸ä¹…ä»£</span></strong><span>è¢«å½»åº•ç§»é™¤äº†)ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å…ƒç©ºé—´ï¼Œå…ƒç©ºé—´ä½¿ç”¨çš„æ˜¯ç›´æ¥å†…å­˜ã€‚</span></p></li></ul><blockquote><p><span>å¤§éƒ¨åˆ†æƒ…å†µï¼Œå¯¹è±¡éƒ½ä¼šé¦–å…ˆåœ¨ Eden åŒºåŸŸåˆ†é…ï¼Œåœ¨ä¸€æ¬¡æ–°ç”Ÿä»£åƒåœ¾å›æ”¶åï¼Œå¦‚æœå¯¹è±¡è¿˜å­˜æ´»ï¼Œåˆ™ä¼šè¿›å…¥ s0 æˆ–è€… s1ï¼Œå¹¶ä¸”å¯¹è±¡çš„å¹´é¾„è¿˜ä¼šåŠ  1(Eden åŒº-&gt;Survivor åŒºåå¯¹è±¡çš„åˆå§‹å¹´é¾„å˜ä¸º 1)ï¼Œå½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦ï¼ˆé»˜è®¤ä¸º 15 å²ï¼‰ï¼Œå°±ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£ä¸­ã€‚</span></p><ul><li><p><span>å †å†…å­˜æº¢å‡ºé—®é¢˜</span></p></li><li><p><strong><span>java.lang.OutofMemoryError</span></strong><span> ï¼šjava heap space. å †å†…å­˜æº¢å‡º</span></p></li></ul></blockquote><h4 id='æ–¹æ³•åŒº'><span>æ–¹æ³•åŒº</span></h4><ul><li><p><span>æ–¹æ³•åŒºå±äºæ˜¯ JVM è¿è¡Œæ—¶æ•°æ®åŒºåŸŸçš„ä¸€å—é€»è¾‘åŒºåŸŸï¼Œæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸã€‚ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹åªæ˜¯è§„å®šäº†æœ‰æ–¹æ³•åŒºè¿™ä¹ˆä¸ªæ¦‚å¿µå’Œå®ƒçš„ä½œç”¨ï¼Œæ–¹æ³•åŒºåˆ°åº•è¦å¦‚ä½•å®ç°é‚£å°±æ˜¯è™šæ‹Ÿæœºè‡ªå·±è¦è€ƒè™‘çš„äº‹æƒ…äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸åŒçš„è™šæ‹Ÿæœºå®ç°ä¸Šï¼Œæ–¹æ³•åŒºçš„å®ç°æ˜¯ä¸åŒçš„ã€‚</span></p></li><li><p><span>å½“è™šæ‹Ÿæœºè¦ä½¿ç”¨ä¸€ä¸ªç±»æ—¶ï¼Œå®ƒéœ€è¦è¯»å–å¹¶è§£æ Class æ–‡ä»¶è·å–ç›¸å…³ä¿¡æ¯ï¼Œå†å°†ä¿¡æ¯å­˜å…¥åˆ°æ–¹æ³•åŒºã€‚æ–¹æ³•åŒºä¼šå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ </span><strong><span>ç±»ä¿¡æ¯ã€å­—æ®µä¿¡æ¯ã€æ–¹æ³•ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç¼“å­˜ç­‰æ•°æ®</span></strong><span>ã€‚</span></p></li><li><p><span>å¯ä»¥é€‰æ‹©ä¸å®ç°åƒåœ¾å›æ”¶ï¼Œå›æ”¶ç›®æ ‡ä¸»è¦æ—¶é’ˆå¯¹å¸¸é‡æ± çš„å›æ”¶å’Œå¯¹ç±»å‹çš„å¸è½½ã€‚</span></p></li><li><p><span>æ°¸ä¹…ä»£æ˜¯ JDK 1.8 ä¹‹å‰çš„æ–¹æ³•åŒºå®ç°ï¼ŒJDK 1.8 åŠä»¥åæ–¹æ³•åŒºçš„å®ç°å˜æˆäº†å…ƒç©ºé—´ã€‚å˜æ¢çš„åŸå› ï¼š</span></p><ul><li><p><span>æ•´ä¸ªæ°¸ä¹…ä»£æœ‰ä¸€ä¸ª JVM æœ¬èº«è®¾ç½®çš„å›ºå®šå¤§å°ä¸Šé™ï¼Œæ— æ³•è¿›è¡Œè°ƒæ•´ï¼ˆä¹Ÿå°±æ˜¯å—åˆ° JVM å†…å­˜çš„é™åˆ¶ï¼‰ï¼Œè€Œå…ƒç©ºé—´ä½¿ç”¨çš„æ˜¯æœ¬åœ°å†…å­˜ï¼Œå—æœ¬æœºå¯ç”¨å†…å­˜çš„é™åˆ¶ï¼Œè™½ç„¶å…ƒç©ºé—´ä»æ—§å¯èƒ½æº¢å‡ºï¼Œä½†æ˜¯æ¯”åŸæ¥å‡ºç°çš„å‡ ç‡ä¼šæ›´å°ã€‚å½“å…ƒç©ºé—´æº¢å‡ºæ—¶ä¼šå¾—åˆ°å¦‚ä¸‹é”™è¯¯ï¼š</span><code>java.lang.OutOfMemoryError: MetaSpace</code></p></li><li><p><span>å…ƒç©ºé—´é‡Œé¢å­˜æ”¾çš„æ˜¯ç±»çš„å…ƒæ•°æ®ï¼Œè¿™æ ·åŠ è½½å¤šå°‘ç±»çš„å…ƒæ•°æ®å°±ä¸ç”± </span><code>MaxPermSize</code><span> æ§åˆ¶äº†, è€Œç”±ç³»ç»Ÿçš„å®é™…å¯ç”¨ç©ºé—´æ¥æ§åˆ¶ï¼Œè¿™æ ·èƒ½åŠ è½½çš„ç±»å°±æ›´å¤šäº†ã€‚</span></p></li><li><p><span>æ°¸ä¹…ä»£ä¼šä¸º GC å¸¦æ¥ä¸å¿…è¦çš„å¤æ‚åº¦ï¼Œå¹¶ä¸”å›æ”¶æ•ˆç‡åä½ã€‚</span></p></li></ul></li></ul><p><img src="./images/æ–¹æ³•åŒº.png" referrerpolicy="no-referrer" alt="æ–¹æ³•åŒº.png"></p><h5 id='è¿è¡Œæ—¶å¸¸é‡æ± '><span>è¿è¡Œæ—¶å¸¸é‡æ± </span></h5><ul><li><p><strong><span>æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†</span></strong></p></li><li><p><strong><span>å¸¸é‡æ± </span></strong><span>ï¼šå°±æ˜¯ä¸€å¼ è¡¨ï¼ˆç¼–è¯‘å™¨ç”Ÿæˆçš„å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼‰ï¼Œè™šæ‹ŸæœºæŒ‡ä»¤æ ¹æ®è¿™å¼ å¸¸é‡è¡¨æ‰¾åˆ°è¦æ‰§è¡Œçš„ç±»åã€æ–¹æ³•åã€å‚æ•°ç±»å‹ã€å­—é¢é‡ä¿¡æ¯</span></p></li><li><p><span>å­—é¢é‡æ˜¯æºä»£ç ä¸­çš„å›ºå®šå€¼çš„è¡¨ç¤ºæ³•ï¼Œå³é€šè¿‡å­—é¢æˆ‘ä»¬å°±èƒ½çŸ¥é“å…¶å€¼çš„å«ä¹‰ã€‚å­—é¢é‡åŒ…æ‹¬æ•´æ•°ã€æµ®ç‚¹æ•°å’Œå­—ç¬¦ä¸²å­—é¢é‡ã€‚å¸¸è§çš„ç¬¦å·å¼•ç”¨åŒ…æ‹¬ç±»ç¬¦å·å¼•ç”¨ã€å­—æ®µç¬¦å·å¼•ç”¨ã€æ–¹æ³•ç¬¦å·å¼•ç”¨ã€æ¥å£æ–¹æ³•ç¬¦å·ã€‚</span></p></li><li><p><strong><span>è¿è¡Œæ—¶å¸¸é‡æ± </span></strong><span>ï¼šå¸¸é‡æ± æ˜¯ *.class æ–‡ä»¶ä¸­çš„ï¼Œå½“è¯¥ç±»è¢«åŠ è½½ä»¥åï¼Œå®ƒçš„å¸¸é‡æ± ä¿¡æ¯å°±ä¼šæ”¾å…¥è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œå¹¶æŠŠé‡Œé¢çš„ç¬¦å·åœ°å€å˜ä¸ºçœŸå®åœ°å€</span></p><blockquote><p><span>Classæ–‡ä»¶ä¸­é™¤äº†ç”±ç±»çš„ç‰ˆæœ¬ï¼Œå­—æ®µï¼Œæ–¹æ³•ï¼Œæ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰ä¸€é¡¹æ—¶å¸¸é‡æ± è¡¨ï¼Œè™šæ‹ŸæœºæŒ‡ä»¤æ ¹æ®è¿™å¼ å¸¸é‡è¡¨æ‰¾åˆ°è¦æ‰§è¡Œçš„ç±»åï¼Œæ–¹æ³•åï¼Œå‚æ•°ç±»å‹ï¼Œå­—é¢é‡(å­—ç¬¦ä¸²ï¼Œæ•´æ•°ï¼Œå¸ƒå°”ç±»å‹ç­‰)ç­‰ä¿¡æ¯ã€‚</span></p></blockquote></li></ul><p><span>äºŒè¿›åˆ¶å­—èŠ‚ç åŒ…å«ï¼ˆç±»çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¸¸é‡æ± ï¼Œç±»æ–¹æ³•å®šä¹‰ï¼ŒåŒ…å«äº†è™šæ‹Ÿæœºçš„æŒ‡ä»¤ï¼‰</span></p><p><span>é¦–å…ˆçœ‹çœ‹å¸¸é‡æ± æ˜¯ä»€ä¹ˆï¼Œç¼–è¯‘å¦‚ä¸‹ä»£ç ï¼š</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">Test</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-keyword">static</span> <span class="cm-variable-3">void</span> <span class="cm-variable">main</span>(<span class="cm-variable-3">String</span>[] <span class="cm-variable">args</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-string">"Hello World!"</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><p><span>ç„¶åä½¿ç”¨ javap -v Test.class å‘½ä»¤åç¼–è¯‘æŸ¥çœ‹ç»“æœã€‚</span></p><p><img src="assets/image-20240618154316038.png" referrerpolicy="no-referrer" alt="image-20240618154316038.png"></p><p><span>æ¯æ¡æŒ‡ä»¤éƒ½ä¼šå¯¹åº”å¸¸é‡æ± è¡¨ä¸­ä¸€ä¸ªåœ°å€ï¼Œå¸¸é‡æ± è¡¨ä¸­çš„åœ°å€å¯èƒ½å¯¹åº”ç€ä¸€ä¸ªç±»åã€æ–¹æ³•åã€å‚æ•°ç±»å‹ç­‰ä¿¡æ¯</span></p><p>&nbsp;</p><p><img src="assets/image-20240618154131514.png" referrerpolicy="no-referrer" alt="image-20240618154131514.png"></p><p>&nbsp;</p><h5 id='å­—ç¬¦ä¸²å¸¸é‡æ± '><span>å­—ç¬¦ä¸²å¸¸é‡æ± </span></h5><ul><li><p><strong><span>å­—ç¬¦ä¸²å¸¸é‡æ± </span></strong><span> æ˜¯ JVM ä¸ºäº†æå‡æ€§èƒ½å’Œå‡å°‘å†…å­˜æ¶ˆè€—é’ˆå¯¹å­—ç¬¦ä¸²ï¼ˆString ç±»ï¼‰ä¸“é—¨å¼€è¾Ÿçš„ä¸€å—åŒºåŸŸï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†é¿å…å­—ç¬¦ä¸²çš„é‡å¤åˆ›å»ºã€‚</span></p></li><li><p><span>JDK1.7 ä¹‹å‰ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± å­˜æ”¾åœ¨æ°¸ä¹…ä»£ã€‚JDK1.7 å­—ç¬¦ä¸²å¸¸é‡æ± å’Œé™æ€å˜é‡ä»æ°¸ä¹…ä»£ç§»åŠ¨äº† Java å †ä¸­ã€‚</span></p></li><li><p><strong><span>JDK 1.7 ä¸ºä»€ä¹ˆè¦å°†å­—ç¬¦ä¸²å¸¸é‡æ± ç§»åŠ¨åˆ°å †ä¸­ï¼Ÿ</span></strong><span>ï¼šä¸»è¦æ˜¯å› ä¸ºæ°¸ä¹…ä»£ï¼ˆæ–¹æ³•åŒºå®ç°ï¼‰çš„ GC å›æ”¶æ•ˆç‡å¤ªä½ï¼Œåªæœ‰åœ¨æ•´å †æ”¶é›† (Full GC)çš„æ—¶å€™æ‰ä¼šè¢«æ‰§è¡Œ GCã€‚Java ç¨‹åºä¸­é€šå¸¸ä¼šæœ‰å¤§é‡çš„è¢«åˆ›å»ºçš„å­—ç¬¦ä¸²ç­‰å¾…å›æ”¶ï¼Œå°†å­—ç¬¦ä¸²å¸¸é‡æ± æ”¾åˆ°å †ä¸­ï¼Œèƒ½å¤Ÿæ›´é«˜æ•ˆåŠæ—¶åœ°å›æ”¶å­—ç¬¦ä¸²å†…å­˜ã€‚</span></p></li><li><p><span>HotSpot è™šæ‹Ÿæœºä¸­å­—ç¬¦ä¸²å¸¸é‡æ± çš„å®ç°æ˜¯ </span><code>src/hotspot/share/classfile/stringTable.cpp</code><span> ,</span><code>StringTable</code><span> å¯ä»¥ç®€å•ç†è§£ä¸ºä¸€ä¸ªå›ºå®šå¤§å°çš„</span><code>HashTable</code><span> ï¼Œå®¹é‡ä¸º </span><code>StringTableSize</code><span>ï¼ˆå¯ä»¥é€šè¿‡ </span><code>-XX:StringTableSize</code><span> å‚æ•°æ¥è®¾ç½®ï¼‰ï¼Œä¿å­˜çš„æ˜¯å­—ç¬¦ä¸²ï¼ˆkeyï¼‰å’Œ å­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨ï¼ˆvalueï¼‰çš„æ˜ å°„å…³ç³»ï¼Œå­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨æŒ‡å‘å †ä¸­çš„å­—ç¬¦ä¸²å¯¹è±¡ã€‚</span></p></li><li><p><span>å¸¸é‡ä¸ä¼šå˜ï¼›å˜é‡ä¼šæ–°å»ºï¼›</span></p><ul><li><p><span>å¸¸é‡æ± ä¸­çš„å­—ç¬¦ä¸²ä»…æ˜¯ç¬¦å·ï¼Œåªæœ‰åœ¨è¢«ç”¨åˆ°æ—¶æ‰ä¼šè½¬åŒ–ä¸ºå¯¹è±¡</span></p></li><li><p><span>åˆ©ç”¨ä¸²æ± çš„æœºåˆ¶ï¼Œæ¥é¿å…é‡å¤åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡</span></p></li><li><p><span>å­—ç¬¦ä¸²å˜é‡æ‹¼æ¥çš„åŸç†æ˜¯StringBuilder</span></p></li><li><p><span>å­—ç¬¦ä¸²å¸¸é‡æ‹¼æ¥çš„åŸç†æ˜¯ç¼–è¯‘å™¨ä¼˜åŒ–</span></p></li><li><p><span>å¯ä»¥ä½¿ç”¨internæ–¹æ³•ï¼Œä¸»åŠ¨å°†ä¸²æ± ä¸­è¿˜æ²¡æœ‰çš„å­—ç¬¦ä¸²å¯¹è±¡æ”¾å…¥ä¸²æ± ä¸­</span></p></li></ul></li></ul><h5 id='æ— ç”¨çš„ç±»'><span>æ— ç”¨çš„ç±»ï¼Ÿ</span></h5><p><span>æ–¹æ³•åŒºä¸»è¦å›æ”¶çš„æ˜¯æ— ç”¨çš„ç±»ã€‚ç±»éœ€è¦åŒæ—¶æ»¡è¶³ä¸‹é¢ 3 ä¸ªæ¡ä»¶æ‰èƒ½ç®—æ˜¯ </span><strong><span>â€œæ— ç”¨çš„ç±»â€</span></strong><span> ï¼š</span></p><ul><li><p><span>è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯ Java å †ä¸­ä¸å­˜åœ¨è¯¥ç±»çš„ä»»ä½•å®ä¾‹ã€‚</span></p></li><li><p><span>åŠ è½½è¯¥ç±»çš„ </span><code>ClassLoader</code><span> å·²ç»è¢«å›æ”¶ã€‚</span></p></li><li><p><span>è¯¥ç±»å¯¹åº”çš„ </span><code>java.lang.Class</code><span> å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•ã€‚</span></p></li></ul><p><span>è™šæ‹Ÿæœºå¯ä»¥å¯¹æ»¡è¶³ä¸Šè¿° 3 ä¸ªæ¡ä»¶çš„æ— ç”¨ç±»è¿›è¡Œå›æ”¶ï¼Œè¿™é‡Œè¯´çš„ä»…ä»…æ˜¯â€œå¯ä»¥â€ï¼Œè€Œå¹¶ä¸æ˜¯å’Œå¯¹è±¡ä¸€æ ·ä¸ä½¿ç”¨äº†å°±ä¼šå¿…ç„¶è¢«å›æ”¶ã€‚</span></p><h5 id='åºŸå¼ƒçš„å¸¸é‡'><span>åºŸå¼ƒçš„å¸¸é‡</span></h5><p><span>å‡å¦‚åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­˜åœ¨å­—ç¬¦ä¸² &quot;abc&quot;ï¼Œå¦‚æœå½“å‰æ²¡æœ‰ä»»ä½• String å¯¹è±¡å¼•ç”¨è¯¥å­—ç¬¦ä¸²å¸¸é‡çš„è¯ï¼Œå°±è¯´æ˜å¸¸é‡ &quot;abc&quot; å°±æ˜¯åºŸå¼ƒå¸¸é‡ï¼Œå¦‚æœè¿™æ—¶å‘ç”Ÿå†…å­˜å›æ”¶çš„è¯è€Œä¸”æœ‰å¿…è¦çš„è¯ï¼Œ&quot;abc&quot; å°±ä¼šè¢«ç³»ç»Ÿæ¸…ç†å‡ºå¸¸é‡æ± äº†ã€‚</span></p><h4 id='ç›´æ¥å†…å­˜'><span>ç›´æ¥å†…å­˜</span></h4><ul><li><p><span>ç›´æ¥å†…å­˜å¹¶ä¸æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯å±äºæ“ä½œç³»ç»Ÿå†…å­˜ã€‚</span></p></li><li><p><span>åœ¨ JDK 1.4 ä¸­æ–°å¼•å…¥äº† NIO ç±»ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ Native å‡½æ•°åº“ç›´æ¥åˆ†é…å †å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡ Java å †é‡Œçš„ DirectByteBuffer å¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œã€‚è¿™æ ·èƒ½åœ¨ä¸€äº›åœºæ™¯ä¸­æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œå› ä¸ºé¿å…äº†åœ¨å †å†…å­˜å’Œå †å¤–å†…å­˜æ¥å›æ‹·è´æ•°æ®ã€‚</span></p></li><li><p><span>å±äºæ“ä½œç³»ç»Ÿï¼Œå¸¸è§äºNIOæ“ä½œæ—¶ï¼Œ</span><strong><span>ç”¨äºæ•°æ®ç¼“å†²åŒº</span></strong></p></li><li><p><span>åˆ†é…å›æ”¶æˆæœ¬è¾ƒé«˜ï¼Œä½†è¯»å†™æ€§èƒ½é«˜</span></p></li><li><p><span>ä¸å—JVMå†…å­˜å›æ”¶ç®¡ç†</span></p></li></ul><p><strong><span>ä¸ä½¿ç”¨ç›´æ¥å†…å­˜</span></strong></p><p><img src="./images/æ–‡ä»¶è¯»å†™æµç¨‹.png" referrerpolicy="no-referrer" alt="æ–‡ä»¶è¯»å†™æµç¨‹.png"></p><p><strong><span>ä½¿ç”¨ç›´æ¥å†…å­˜</span></strong></p><p><img src=".\images\ä½¿ç”¨ç›´æ¥å†…å­˜.png" referrerpolicy="no-referrer" alt=".\images\ä½¿ç”¨ç›´æ¥å†…å­˜.png"></p><p><span>ç›´æ¥å†…å­˜æ˜¯æ“ä½œç³»ç»Ÿå’ŒJavaä»£ç </span><strong><span>éƒ½å¯ä»¥è®¿é—®çš„ä¸€å—åŒºåŸŸ</span></strong><span>ï¼Œæ— éœ€å°†ä»£ç ä»ç³»ç»Ÿå†…å­˜å¤åˆ¶åˆ°Javaå †å†…å­˜ï¼Œä»è€Œæé«˜äº†æ•ˆç‡.</span></p><h3 id='13-æ‰§è¡Œå¼•æ“'><span>1.3 æ‰§è¡Œå¼•æ“</span></h3><p><span>ç”¨æ¥æ‰§è¡Œæ–¹æ³•åŒºä¸­çš„å­—èŠ‚ç æŒ‡ä»¤</span></p><h3 id='14-ä»£ç æ¼”ç¤º'><span>1.4 ä»£ç æ¼”ç¤º</span></h3><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">TestFrame</span>{<span class="cm-comment">//1</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">public</span> <span class="cm-keyword">static</span> <span class="cm-variable-3">void</span> <span class="cm-variable">main</span>(<span class="cm-variable-3">String</span> []<span class="cm-variable">args</span>){ &nbsp; <span class="cm-comment">//2 &nbsp; &nbsp; </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">method1</span>(<span class="cm-number">10</span>);<span class="cm-comment">//3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">static</span> <span class="cm-variable-3">void</span> <span class="cm-variable">method1</span>(<span class="cm-variable-3">int</span> <span class="cm-variable">x</span>){<span class="cm-comment">//4</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-3">int</span> <span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>;<span class="cm-comment">//5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-3">Object</span> <span class="cm-variable">m</span> <span class="cm-operator">=</span> <span class="cm-variable">method2</span>();<span class="cm-comment">//6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-variable">m</span>);<span class="cm-comment">//7</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">private</span> <span class="cm-keyword">static</span> <span class="cm-variable-3">Object</span> <span class="cm-variable">method2</span>(){<span class="cm-comment">//8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-3">Object</span> <span class="cm-variable">n</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable-3">Object</span>();<span class="cm-comment">//9</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">n</span>;<span class="cm-comment">//10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 391px;"></div><div class="CodeMirror-gutters" style="display: none; height: 391px;"></div></div></div></pre><ul><li><p><span>ç¬¬ä¸€è¡Œï¼Œjavaè™šæ‹Ÿæœºä¼šå…ˆè¿›è¡Œç±»åŠ è½½ï¼Œå°†ç±»ä¸­çš„å­—èŠ‚ç åŠ åˆ°javaçš„è™šæ‹Ÿæœºä¸­ï¼Œä¹Ÿå°±æ˜¯æ–¹æ³•åŒºã€‚</span></p></li><li><p><span>ç±»åŠ è½½å®Œï¼Œjavaè™šæ‹Ÿæœºå°±ä¼šå¯åŠ¨ä¸€ä¸ªä¸ºmainçš„ä¸»çº¿ç¨‹ï¼Œå¹¶ä¸”ä¸ºè¿™ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªæ ˆå†…å­˜ï¼Œç„¶åçº¿ç¨‹å°±äº¤ç»™ä»»åŠ¡è°ƒåº¦å™¨å»æ‰§è¡Œã€‚å½“cpuä¸ºä¸»çº¿ç¨‹åˆ†é…äº†æ—¶é—´ç‰‡ï¼Œcpuå°±å¼€å§‹è¿è¡Œä¸»çº¿ç¨‹ï¼Œè¿è¡Œåˆ°å“ªè¡Œä»£ç ç”±ç¨‹åºè®¡æ•°å™¨æ¥è®°å½•ã€‚</span></p></li></ul><p><img src="./images/ä»£ç 1.png" referrerpolicy="no-referrer" alt="ä»£ç 1.png"></p><ul><li><p><span>ç¬¬äºŒè¡Œï¼šå…¥å£æ˜¯mainæ–¹æ³•ï¼Œåˆ™è™šæ‹Ÿæœºä¼šä¸ºmainæ–¹æ³•åˆ›å»ºä¸€ä¸ªæ ˆå¸§ã€‚</span></p></li></ul><p><img src="./images/ä»£ç 2.png" referrerpolicy="no-referrer" alt="ä»£ç 2.png"></p><ul><li><p><span>ç¬¬ä¸‰è¡Œï¼šè¿›å…¥method1æ–¹æ³•ï¼Œä¹Ÿä¼šä¸ºmethod1æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ ˆå¸§ã€‚x=10å†™è¿›æ ˆå¸§ã€‚</span></p></li></ul><p><img src="./images/ä»£ç 3.png" referrerpolicy="no-referrer" alt="ä»£ç 3.png"></p><ul><li><p><span>ç¬¬äº”è¡Œï¼šæ‰§è¡Œå®Œåy = 11;</span></p></li><li><p><span>ç¬¬å…­è¡Œï¼šè¿›å…¥method2æ–¹æ³•ï¼ŒåŒæ—¶ä¸ºmethod2æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ ˆå¸§ã€‚</span></p></li></ul><p><img src="./images/ä»£ç 4.png" referrerpolicy="no-referrer" alt="ä»£ç 4.png"></p><ul><li><p><span>ç¬¬ä¹è¡Œï¼šåœ¨å †ä¸­æ–°å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°†å¯¹è±¡çš„å¼•ç”¨næŒ‡å‘å¯¹è±¡ã€‚</span></p><p><img src="./images/ä»£ç 5.png" referrerpolicy="no-referrer" alt="ä»£ç 5.png"></p></li><li><p><span>ç¬¬10è¡Œï¼šè¿”å›n,å¹¶å°†mæŒ‡å‘objectå¯¹è±¡ã€‚</span></p></li></ul><p><img src="./images/ä»£ç 6.png" referrerpolicy="no-referrer" alt="ä»£ç 6.png"></p><ul><li><p><span>ä¹‹åé‡Šæ”¾method2çš„æ ˆå¸§å†…å­˜ã€‚è¿”å›åˆ°method1,ä¹‹åmethod1æ‰§è¡Œå®Œï¼Œå…¶æ ˆå¸§ä¹Ÿè¦é‡Šæ”¾æ‰ã€‚</span></p></li></ul><h1 id='äºŒhotspotè™šæ‹Ÿæœº'><span>äºŒã€HotSpotè™šæ‹Ÿæœº</span></h1><h4 id='21-å¯¹è±¡åˆ›å»ºçš„è¿‡ç¨‹'><span>2.1 å¯¹è±¡åˆ›å»ºçš„è¿‡ç¨‹</span></h4><ol start='' ><li><p><strong><span>ç±»åŠ è½½æ£€æŸ¥</span></strong><span>ï¼ˆå…ˆåˆ¤æ–­æœ‰æ²¡æœ‰åŠ è½½è¿‡ï¼‰</span></p><p><span>è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªnewæŒ‡ä»¤ï¼Œé¦–å…ˆå°†å»æ£€æŸ¥è¿™ä¸ªæŒ‡ä»¤çš„å‚æ•°æ˜¯å¦èƒ½åœ¨å¸¸é‡æ± ä¸­å®šä½åˆ°è¿™ä¸ªç±»çš„ç¬¦å·å¼•ç”¨ï¼Œå¹¶ä¸”æ£€æŸ¥è¿™ä¸ªç¬¦å·å¼•ç”¨ä»£è¡¨çš„ç±»æ˜¯å¦å·²ç»è¢«åŠ è½½è¿‡ï¼Œè§£æå’Œåˆå§‹åŒ–è¿‡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£å¿…é¡»å…ˆæ‰§è¡Œå“åº”çš„ç±»åŠ è½½è¿‡ç¨‹ã€‚</span></p></li><li><p><strong><span>åˆ†é…å†…å­˜</span></strong><span>ï¼ˆæ²¡æœ‰åŠ è½½è¿‡å°±ä¸ºå¯¹è±¡åœ¨å †ä¸­åˆ†é…å†…å­˜ï¼‰</span></p><p><strong><span>åœ¨ç±»åŠ è½½æ£€æŸ¥é€šè¿‡åï¼Œæ¥ä¸‹æ¥è™šæ‹Ÿæœºå°†ä¼šä¸ºæ–°ç”Ÿå¯¹è±¡åˆ†é…å†…å­˜ã€‚å¯¹è±¡æ‰€éœ€çš„å†…å­˜å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåä¾¿å¯ç¡®è®¤</span></strong><span>ï¼Œä¸ºå¯¹è±¡åˆ†é…ç©ºé—´çš„ä»»åŠ¡ç­‰åŒäºæŠŠä¸€å—ç¡®å®šå¤§å°çš„å†…å­˜ä»javaå †ä¸­åˆ’åˆ†å‡ºæ¥ã€‚åˆ†ç±»æ–¹å¼æœ‰æŒ‡é’ˆç¢°æ’å’Œç©ºé—²åˆ—è¡¨æ–¹å¼ï¼Œé€‰æ‹©å“ªç§åˆ†é…æ–¹å¼æ˜¯ç”±javaå †æ˜¯å¦è§„æ•´å†³å®šçš„ï¼Œè€Œjavaå †æ˜¯å¦è§„æ•´åˆæœ‰é‡‡ç”¨çš„åƒåœ¾æ”¶é›†å™¨æ˜¯å¦å¸¦æœ‰å‹ç¼©æ•´ç†åŠŸèƒ½å†³å®šã€‚</span></p><blockquote><p><strong><span>HotSpotè™šæ‹Ÿæœºå†…å­˜åˆ†é…çš„ä¸¤ç§æ–¹å¼</span></strong></p><ol start='' ><li><p><span>æŒ‡é’ˆç¢°æ’</span></p></li></ol><ul><li><p><span>é€‚ç”¨åœºåˆ:å †å†…å­˜è§„æ•´(å³æ²¡æœ‰å†…å­˜ç¢ç‰‡);</span></p></li><li><p><span>ç”¨è¿‡çš„å†…å­˜å…¨éƒ¨æ•´åˆåˆ°ä¸€è¾¹ï¼Œæ²¡æœ‰ç”¨è¿‡çš„å†…å­˜æ”¾åœ¨å¦ä¸€è¾¹ï¼Œä¸­é—´æœ‰ä¸€ä¸ªåˆ†ç•Œå€¼æŒ‡é’ˆï¼Œåªéœ€è¦å‘ç€æ²¡æœ‰ç”¨è¿‡çš„å†…å­˜æ–¹å‘å°†è¯¥æŒ‡é’ˆç§»åŠ¨å¯¹è±¡å†…å­˜å¤§å°ä½ç½®å³å¯ã€‚</span></p></li><li><p><span>GCæ”¶é›†å™¨ï¼šSerial,ParNew</span></p></li></ul><ol start='2' ><li><p><span>ç©ºé—²åˆ—è¡¨</span></p></li></ol><ul><li><p><span>é€‚åˆç”¨äºå †å†…å­˜ä¸è§„æ•´çš„æƒ…å†µ;</span></p></li><li><p><span>è™šæ‹Ÿæœºä¼šç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨ï¼Œè¯¥åˆ—è¡¨ä¼šè®°å½•å“ªäº›å†…å­˜å—æ˜¯å¯ç”¨çš„ï¼Œåœ¨åˆ†é…çš„æ—¶å€™ï¼Œæ‰¾ä¸€å—è¶³å¤Ÿå¤§çš„å†…å­˜å—æ¥åˆ†é…ç»™å¯¹è±¡å®ä¾‹ï¼Œæœ€åæ›´æ–°åˆ—è¡¨è®°å½•.</span></p></li><li><p><span>GCæ”¶é›†å™¨ï¼šCMS</span></p><p><strong><span>HotSpotè™šæ‹Ÿæœºå†…å­˜åˆ†é…çš„å¹¶å‘é—®é¢˜</span></strong></p><p><span>åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ï¼Œå°±æ˜¯çº¿ç¨‹å®‰å…¨ï¼Œå› ä¸ºåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåˆ›å»ºå¯¹è±¡æ˜¯å¾ˆé¢‘ç¹çš„äº‹æƒ…ï¼Œä½œä¸ºè™šæ‹Ÿæœºæ¥è¯´ï¼Œå¿…é¡»è¦ä¿è¯çº¿ç¨‹æ˜¯å®‰å…¨çš„ï¼Œé€šå¸¸æ¥è®²ï¼Œè™šæ‹Ÿæœºé‡‡ç”¨ä¸¤ç§æ–¹å¼æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼š</span></p><ul><li><p><strong><span>CAS+å¤±è´¥é‡è¯•ï¼š</span></strong><span> CAS æ˜¯ä¹è§‚é”çš„ä¸€ç§å®ç°æ–¹å¼ã€‚æ‰€è°“ä¹è§‚é”å°±æ˜¯ï¼Œæ¯æ¬¡ä¸åŠ é”è€Œæ˜¯å‡è®¾æ²¡æœ‰å†²çªè€Œå»å®ŒæˆæŸé¡¹æ“ä½œï¼Œå¦‚æœå› ä¸ºå†²çªå¤±è´¥å°±é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚è™šæ‹Ÿæœºé‡‡ç”¨ CAS é…ä¸Šå¤±è´¥é‡è¯•çš„æ–¹å¼ä¿è¯æ›´æ–°æ“ä½œçš„åŸå­æ€§ã€‚</span></p></li><li><p><strong><span>çº¿ç¨‹æœ¬åœ°åˆ†é…ç¼“å­˜åŒº(TLAB)</span></strong><span>: ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹é¢„å…ˆåœ¨ Eden åŒºåˆ†é…ä¸€å—å„¿å†…å­˜ï¼ŒJVM åœ¨ç»™çº¿ç¨‹ä¸­çš„å¯¹è±¡åˆ†é…å†…å­˜æ—¶ï¼Œé¦–å…ˆåœ¨ TLAB åˆ†é…ï¼Œå½“å¯¹è±¡å¤§äº TLAB ä¸­çš„å‰©ä½™å†…å­˜æˆ– TLAB çš„å†…å­˜å·²ç”¨å°½æ—¶ï¼Œå†é‡‡ç”¨ä¸Šè¿°çš„ CAS è¿›è¡Œå†…å­˜åˆ†é…</span></p></li></ul><hr /></li></ul></blockquote></li><li><p><strong><span>åˆå§‹åŒ–é›¶å€¼</span></strong></p><p><span>å†…å­˜åˆ†é…å®Œåï¼Œè™šæ‹Ÿæœºéœ€è¦å°†åˆ†é…åˆ°çš„å†…å­˜ç©ºé—´éƒ½åˆå§‹åŒ–ä¸ºé›¶å€¼(ä¸åŒ…æ‹¬å¯¹è±¡å¤´)ï¼Œè¿™ä¸€æ­¥æ“ä½œ</span><strong><span>ä¿è¯äº†å¯¹è±¡å®ä¾‹å­—æ®µåœ¨javaä»£ç ä¸­å¯ä»¥ä¸èµ‹åˆå§‹å€¼å°±å¯ä»¥ä½¿ç”¨</span></strong><span>ï¼Œç¨‹åºèƒ½è®¿é—®åˆ°è¿™äº›å­—æ®µçš„æ•°æ®ç±»å‹æ‰€å¯¹åº”çš„é›¶å€¼ã€‚</span></p></li><li><p><strong><span>è®¾ç½®å¯¹è±¡å¤´</span></strong></p><p><span>åˆå§‹åŒ–é›¶å€¼åï¼Œè™šæ‹Ÿæœºè¦å¯¹å¯¹è±¡è¿›è¡Œå¿…è¦çš„è®¾ç½®ï¼Œä¾‹å¦‚è¿™ä¸ªå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ï¼Œå¦‚æœæ‰èƒ½æ‰¾åˆ°ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¯¹è±¡çš„å“ˆå¸Œç ï¼Œå¯¹è±¡çš„GCåˆ†ä»£å¹´é¾„ç­‰ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å­˜æ”¾åœ¨å¯¹è±¡å¤´ä¸­ã€‚å¦å¤–æ ¹æ®è™šæ‹Ÿæœºå½“å‰è¿è¡ŒçŠ¶æ€çš„ä¸åŒï¼Œå¦‚æ˜¯å¦ç”¨åå‘é”ç­‰ï¼Œå¯¹è±¡å¤´ä¼šæœ‰ä¸åŒçš„è®¾ç½®æ–¹å¼ã€‚</span></p></li><li><p><strong><span>æ‰§è¡Œ</span><init><span>æ–¹æ³•</span></strong></p><p><span>newæŒ‡ä»¤ä¹‹åä¼šæ¥ç€æ‰§è¡Œ</span><init><span>æ–¹æ³•ï¼ŒæŒ‰ç…§ç¨‹åºå‘˜çš„æ„æ„¿å¯¹å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™æ ·ä¸€ä¸ªçœŸæ­£å¯ç”¨çš„å¯¹è±¡æ‰å®Œå…¨è¢«æ„é€ å‡ºæ¥ã€‚</span></p><blockquote><p><span>åœ¨ä¸Šé¢å·¥ä½œéƒ½å®Œæˆä¹‹åï¼Œä»è™šæ‹Ÿæœºçš„è§†è§’ï¼Œä¸€ä¸ªå¯¹è±¡å·²ç»äº§ç”Ÿäº†ï¼Œä½†æ˜¯ä»javaç¨‹åºè§†è§’æ¥çœ‹ï¼Œæ„é€ å‡½æ•°ï¼Œå³classæ–‡ä»¶ä¸­çš„</span><init><span>æ–¹æ³•è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œæ‰€æœ‰çš„å­—æ®µéƒ½ä¸ºé»˜è®¤çš„é›¶å€¼ï¼Œå¯¹è±¡éœ€è¦çš„å…¶ä»–èµ„æºå’ŒçŠ¶æ€ä¿¡æ¯ä¹Ÿè¿˜æ²¡æœ‰æŒ‰ç…§é¢„å®šçš„æ„å›¾æ„é€ å¥½ã€‚</span></p></blockquote></li></ol><h4 id='22-å¯¹è±¡çš„å†…å­˜å¸ƒå±€'><span>2.2 å¯¹è±¡çš„å†…å­˜å¸ƒå±€</span></h4><p><span>åœ¨hotSpotè™šæ‹Ÿæœºä¸­ï¼Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„å¸ƒå±€å¯ä»¥åˆ†ä¸º3å—åŒºåŸŸï¼šå¯¹è±¡å¤´ï¼Œå®ä¾‹æ•°æ®å’Œå¯¹é½å¡«å……ã€‚</span></p><ul><li><p><strong><span>å¯¹è±¡å¤´</span></strong><span>ï¼šåŒ…å«ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼Œç¬¬ä¸€éƒ¨åˆ†ç”¨äº</span><strong><span>å­˜å‚¨å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®</span></strong><span>ï¼ˆå“ˆå¸Œç ï¼ŒGCåˆ†ä»£å¹´é¾„ï¼Œé”çŠ¶æ€æ ‡å¿—ç­‰ï¼‰ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯</span><strong><span>ç±»å‹æŒ‡é’ˆ</span></strong><span>ï¼Œå³å¯¹è±¡æŒ‡å‘å®ƒçš„ç±»å‹å…ƒæ•°æ®çš„æŒ‡é’ˆï¼Œjavaè™šæ‹Ÿæœºé€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ¥ç¡®å®šè¯¥å¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€‚</span></p></li><li><p><strong><span>å®ä¾‹æ•°æ®</span></strong><span>ï¼šæ˜¯å¯¹è±¡çœŸæ­£å­˜å‚¨çš„æœ‰æ•ˆä¿¡æ¯ï¼Œä¹Ÿæ˜¯åœ¨</span><strong><span>ç¨‹åºä¸­æ‰€å®šä¹‰çš„å„ç§ç±»å‹çš„å­—æ®µå†…å®¹</span></strong><span>ã€‚</span></p></li><li><p><strong><span>å¯¹é½å¡«å……</span></strong><span>ï¼š</span><strong><span>æ²¡æœ‰ç‰¹åˆ«çš„å«ä¹‰ï¼Œåªèµ·å ä½ä½œç”¨ã€‚</span></strong><span>å› ä¸º Hotspot è™šæ‹Ÿæœºçš„è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿè¦æ±‚å¯¹è±¡èµ·å§‹åœ°å€å¿…é¡»æ˜¯ 8 å­—èŠ‚çš„æ•´æ•°å€ï¼Œæ¢å¥è¯è¯´å°±æ˜¯å¯¹è±¡çš„å¤§å°å¿…é¡»æ˜¯ 8 å­—èŠ‚çš„æ•´æ•°å€ã€‚è€Œå¯¹è±¡å¤´éƒ¨åˆ†æ­£å¥½æ˜¯ 8 å­—èŠ‚çš„å€æ•°ï¼ˆ1 å€æˆ– 2 å€ï¼‰ï¼Œå› æ­¤ï¼Œå½“å¯¹è±¡å®ä¾‹æ•°æ®éƒ¨åˆ†æ²¡æœ‰å¯¹é½æ—¶ï¼Œå°±éœ€è¦é€šè¿‡å¯¹é½å¡«å……æ¥è¡¥å…¨ã€‚</span></p></li></ul><h4 id='23-å¯¹è±¡çš„è®¿é—®å®šä½'><span>2.3 å¯¹è±¡çš„è®¿é—®å®šä½</span></h4><ul><li><p><code>java</code><span>ç¨‹åºé€šè¿‡æ ˆä¸Šçš„referenceæ•°æ®æ¥æ“ä½œå †ä¸Šçš„å…·ä½“å¯¹è±¡ï¼Œå¯¹è±¡çš„è®¿é—®æ–¹å¼ç”±è™šæ‹Ÿæœºå®ç°è€Œå®šï¼Œç›®å‰ä¸»æµçš„è®¿é—®æ–¹å¼ç”±</span><strong><span>ä½¿ç”¨å¥æŸ„</span></strong><span>å’Œ</span><strong><span>ç›´æ¥æŒ‡é’ˆ</span></strong><span>ä¸¤ç§ã€‚</span></p></li><li><p><span>è¿™ä¸¤ç§å¯¹è±¡è®¿é—®æ–¹å¼å„æœ‰ä¼˜åŠ¿ï¼Œä½¿ç”¨å¥æŸ„æ¥è®¿é—®çš„æœ€å¤§å¥½å¤„æ˜¯</span><strong><span>referenceä¸­å­˜å‚¨çš„æ˜¯ç¨³å®šçš„å¥æŸ„åœ°å€ï¼Œåœ¨å¯¹è±¡è¢«ç§»åŠ¨æ—¶åªä¼šæ”¹å˜å¥æŸ„ä¸­çš„å®ä¾‹æ•°æ®æŒ‡é’ˆï¼Œè€Œreferenceæœ¬èº«ä¸éœ€è¦ä¿®æ”¹</span></strong><span>ã€‚ä½¿ç”¨</span><strong><span>ç›´æ¥æŒ‡é’ˆè®¿é—®çš„æœ€å¤§å¥½å¤„å°±æ˜¯é€Ÿåº¦å¿«ï¼Œå®ƒèŠ‚çœäº†ä¸€æ¬¡æŒ‡é’ˆå®šä½çš„æ—¶é—´å¼€é”€ã€‚</span></strong></p></li></ul><ol start='' ><li><p><strong><span>å¥æŸ„</span></strong><span>ï¼š å¦‚æœä½¿ç”¨å¥æŸ„çš„åŒ–ï¼Œjavaå †ä¸­ä¼šåˆ’åˆ†å‡ºä¸€å—å†…å­˜æ¥ä½œä¸ºå¥æŸ„æ± ï¼Œreferenceä¸­å­˜å‚¨çš„å°±æ˜¯å¯¹è±¡çš„å¥æŸ„åœ°å€ï¼Œè€Œå¥æŸ„ä¸­åŒ…å«äº†å¯¹è±¡å®ä¾‹æ•°æ®åŸŸç±»å‹æ•°æ®å„è‡ªçš„å…·ä½“åœ°å€ä¿¡æ¯ã€‚</span></p><p><img src=".\images\å¯¹è±¡çš„è®¿é—®å®šä½-ä½¿ç”¨å¥æŸ„.png" referrerpolicy="no-referrer" alt=".\images\å¯¹è±¡çš„è®¿é—®å®šä½-ä½¿ç”¨å¥æŸ„.png"></p></li><li><p><strong><span>ç›´æ¥æŒ‡é’ˆ</span></strong><span>ï¼šå¦‚æœä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®ï¼Œé‚£ä¹ˆjavaå †å¯¹è±¡çš„å¸ƒå±€å°±å¿…é¡»è€ƒè™‘å¦‚ä½•æ”¾ç½®è®¿é—®ç±»å‹æ•°æ®çš„ç›¸å…³ä¿¡æ¯ï¼Œè€Œreferenceä¸­å­˜å‚¨çš„ç›´æ¥å°±æ˜¯å¯¹è±¡çš„åœ°å€ã€‚</span></p></li></ol><p><img src=".\images\å¯¹è±¡çš„è®¿é—®å®šä½-ç›´æ¥æŒ‡é’ˆ.png" referrerpolicy="no-referrer" alt=".\images\å¯¹è±¡çš„è®¿é—®å®šä½-ç›´æ¥æŒ‡é’ˆ.png"></p><h1 id='ä¸‰åƒåœ¾å›æ”¶å™¨gc'><span>ä¸‰ã€åƒåœ¾å›æ”¶å™¨(GC)</span></h1><h4 id='31-å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡'><span>3.1 å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²ç»æ­»äº¡ï¼Ÿ</span></h4><ol start='' ><li><p><strong><span>å¼•ç”¨è®¡æ•°æ³•</span></strong></p></li></ol><ul><li><p><span>ç»™å¯¹è±¡æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰ä¸€ä¸ªåœ°æ–¹å¼•ç”¨ä»–ï¼Œè®¡æ•°å™¨å°±åŠ 1ï¼Œå½“å¼•ç”¨å¤±æ•ˆï¼Œè®¡æ•°å™¨å°±é—´1ï¼Œå½“è®¡æ•°å™¨ä¸º0æ—¶å¯¹è±¡å°±æ˜¯ä¸å¯ç”¨çš„äº†ã€‚</span></p></li><li><p><span>è¿™ä¸ªæ–¹æ³•å®ç°ç®€å•ï¼Œæ•ˆç‡é«˜ï¼Œä½†æ˜¯å¾ˆéš¾è§£å†³å¯¹è±¡ä¹‹é—´ç›¸äº’å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚</span></p></li></ul><ol start='2' ><li><p><strong><span>å¯è¾¾æ€§åˆ†æç®—æ³•</span></strong></p></li></ol><ul><li><p><span>åŸºæœ¬æ€æƒ³å°±æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„&quot;GC Roots&quot;çš„å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™ä¸ªèŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢ï¼ŒèŠ‚ç‚¹æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ï¼Œå½“ä¸€ä¸ªå¯¹è±¡GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿çš„è¯ï¼Œåˆ™è¯æ˜å¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ã€‚</span></p></li><li><p><span>GCRoot</span></p><ul><li><p><span>è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ã€‚</span></p></li><li><p><span>æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡</span></p></li><li><p><span>æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡</span></p></li><li><p><span>æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆå³ä¸€èˆ¬è¯´çš„Nativeæ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡</span></p></li></ul></li></ul><ol start='3' ><li><p><strong><span>æ–¹æ³•åŒºçš„å›æ”¶</span></strong></p><p><span>å› ä¸ºæ–¹æ³•åŒºä¸»è¦å­˜æ”¾æ°¸ä¹…ä»£å¯¹è±¡ï¼Œè€Œæ°¸ä¹…ä»£å¯¹è±¡çš„å›æ”¶ç‡æ¯”æ–°ç”Ÿä»£ä½å¾ˆå¤šï¼Œæ‰€ä»¥åœ¨æ–¹æ³•åŒºä¸Šè¿›è¡Œå›æ”¶æ€§ä»·æ¯”ä¸é«˜ã€‚</span></p><p><strong><span>ä¸»è¦æ˜¯å¯¹å¸¸é‡æ± çš„å›æ”¶å’Œå¯¹ç±»çš„å¸è½½ã€‚</span></strong></p><p><span>ä¸ºäº†é¿å…å†…å­˜æº¢å‡ºï¼Œåœ¨å¤§é‡ä½¿ç”¨åå°„å’ŒåŠ¨æ€ä»£ç†çš„åœºæ™¯éƒ½éœ€è¦è™šæ‹Ÿæœºå…·å¤‡ç±»å¸è½½åŠŸèƒ½ã€‚</span></p><p><span>ç±»çš„å¸è½½æ¡ä»¶å¾ˆå¤šï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼Œå¹¶ä¸”æ»¡è¶³äº†æ¡ä»¶ä¹Ÿä¸ä¸€å®šä¼šè¢«å¸è½½ï¼š</span></p><ul><li><p><strong><span>è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œæ­¤æ—¶å †ä¸­ä¸å­˜åœ¨è¯¥ç±»çš„ä»»ä½•å®ä¾‹ã€‚</span></strong></p></li><li><p><strong><span>åŠ è½½è¯¥ç±»çš„ ClassLoader å·²ç»è¢«å›æ”¶ã€‚</span></strong></p></li><li><p><strong><span>è¯¥ç±»å¯¹åº”çš„ Class å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œä¹Ÿå°±æ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»æ–¹æ³•</span></strong></p></li></ul></li></ol><h4 id='32-å¼•ç”¨çš„ç±»å‹'><span>3.2 å¼•ç”¨çš„ç±»å‹</span></h4><blockquote><p><span>å¼•ç”¨æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§å¯¹è±¡</span></p><p><span>è½¯å¼•ç”¨ï¼šList&lt;SoftReference&lt;byte[]&gt;&gt; list=new ArrayLIst&lt;&gt;();</span></p><p><span>               SoftReference&lt;byte[]&gt;  ref = new SoftReference&lt;&gt;(new byte[1024])</span></p><p><span>                list.add(ref);</span></p><p><span>åœ¨è¿™é‡Œlist å¼ºå¼•ç”¨SoftReferenceå¯¹è±¡ï¼Œç„¶åé€šè¿‡SoftReferenceé—´æ¥å¼•ç”¨byteæ•°ç»„ã€‚</span></p></blockquote><p><img src="./images/äº”ç§å¼•ç”¨.png" referrerpolicy="no-referrer" alt="äº”ç§å¼•ç”¨.png"></p><ol start='' ><li><p><strong><span>å¼ºå¼•ç”¨</span></strong><span>ï¼š</span><strong><span>å¯¹äºå¼ºå¼•ç”¨ï¼Œåƒåœ¾å›æ”¶å™¨ç»å¯¹ä¸ä¼šå›æ”¶å®ƒ(å³ä½¿å†…å­˜ä¸è¶³)ã€‚åªæœ‰GC Rootéƒ½ä¸å¼•ç”¨è¯¥å¯¹è±¡æ—¶ï¼Œæ‰ä¼šå›æ”¶å¼ºå¼•ç”¨å¯¹è±¡ã€‚</span></strong></p></li><li><p><strong><span>è½¯å¼•ç”¨</span></strong><span>ï¼š</span><strong><span>å½“GC RootæŒ‡å‘è½¯å¼•ç”¨å¯¹è±¡æ—¶ï¼Œåœ¨å†…å­˜ä¸è¶³æ—¶ï¼Œä¼šå›æ”¶è½¯å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡ã€‚</span></strong><span>ä½†æ˜¯è½¯å¼•ç”¨æœ¬èº«ä¸ä¼šè¢«æ¸…ç†ã€‚å¦‚æœæƒ³è¦æ¸…ç†è½¯å¼•ç”¨ï¼Œéœ€è¦ä½¿ç”¨å¼•ç”¨é˜Ÿåˆ—ã€‚å¤§æ¦‚æ€è·¯ä¸ºï¼šæŸ¥çœ‹å¼•ç”¨é˜Ÿåˆ—ä¸­æœ‰æ— è½¯å¼•ç”¨ï¼Œå¦‚æœæœ‰ï¼Œåˆ™å°†è¯¥è½¯å¼•ç”¨ä»å­˜æ”¾å®ƒçš„é›†åˆä¸­ç§»é™¤ï¼ˆè¿™é‡Œä¸ºä¸€ä¸ªlisté›†åˆã€‚å›¾ç‰‡ç¼“å­˜æ¡†æ¶ä¸­ï¼Œâ€œå†…å­˜ç¼“å­˜â€ä¸­çš„å›¾ç‰‡æ˜¯ä»¥è¿™ç§å¼•ç”¨ä¿å­˜ï¼Œä½¿å¾— JVM åœ¨å‘ç”Ÿ OOM ä¹‹å‰ï¼Œå¯ä»¥å›æ”¶è¿™éƒ¨åˆ†ç¼“å­˜ã€‚</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//è½¯å¼•ç”¨</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">Demo1</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">public</span> <span class="cm-keyword">static</span> <span class="cm-variable-3">void</span> <span class="cm-variable">main</span>(<span class="cm-variable-3">String</span>[] <span class="cm-variable">args</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">final</span> <span class="cm-variable-3">int</span> <span class="cm-variable">_4M</span> <span class="cm-operator">=</span> <span class="cm-number">4</span><span class="cm-operator">*</span><span class="cm-number">1024</span><span class="cm-operator">*</span><span class="cm-number">1024</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">//ä½¿ç”¨è½¯å¼•ç”¨å¯¹è±¡ listå¼ºå¼•ç”¨SoftReferenceï¼Œè€ŒSoftReferenceå’Œbyteæ•°ç»„åˆ™æ˜¯è½¯å¼•ç”¨</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">SoftReference</span><span class="cm-operator">&lt;</span><span class="cm-variable-3">byte</span>[]<span class="cm-operator">&gt;&gt;</span> <span class="cm-variable">list</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;&gt;</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">SoftReference</span><span class="cm-operator">&lt;</span><span class="cm-variable-3">byte</span>[]<span class="cm-operator">&gt;</span> <span class="cm-variable">ref</span><span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">SoftReference</span><span class="cm-operator">&lt;&gt;</span>(<span class="cm-keyword">new</span> <span class="cm-variable-3">byte</span>[<span class="cm-variable">_4M</span>]);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span>}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//æ¸…ç†è½¯å¼•ç”¨éœ€è¦ä½¿ç”¨å¼•ç”¨é˜Ÿåˆ—</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">Demo1</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">public</span> <span class="cm-keyword">static</span> <span class="cm-variable-3">void</span> <span class="cm-variable">main</span>(<span class="cm-variable-3">String</span>[] <span class="cm-variable">args</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">final</span> <span class="cm-variable-3">int</span> <span class="cm-variable">_4M</span> <span class="cm-operator">=</span> <span class="cm-number">4</span><span class="cm-operator">*</span><span class="cm-number">1024</span><span class="cm-operator">*</span><span class="cm-number">1024</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">//ä½¿ç”¨å¼•ç”¨é˜Ÿåˆ—ï¼Œç”¨äºç§»é™¤å¼•ç”¨ä¸ºç©ºçš„è½¯å¼•ç”¨å¯¹è±¡</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">ReferenceQueue</span><span class="cm-operator">&lt;</span><span class="cm-variable-3">byte</span>[]<span class="cm-operator">&gt;</span> <span class="cm-variable">queue</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ReferenceQueue</span><span class="cm-operator">&lt;&gt;</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">//ä½¿ç”¨è½¯å¼•ç”¨å¯¹è±¡ listå’ŒSoftReferenceæ˜¯å¼ºå¼•ç”¨ï¼Œè€ŒSoftReferenceå’Œbyteæ•°ç»„åˆ™æ˜¯è½¯å¼•ç”¨</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">SoftReference</span><span class="cm-operator">&lt;</span><span class="cm-variable-3">byte</span>[]<span class="cm-operator">&gt;&gt;</span> <span class="cm-variable">list</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;&gt;</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">SoftReference</span><span class="cm-operator">&lt;</span><span class="cm-variable-3">byte</span>[]<span class="cm-operator">&gt;</span> <span class="cm-variable">ref</span><span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">SoftReference</span><span class="cm-operator">&lt;&gt;</span>(<span class="cm-keyword">new</span> <span class="cm-variable-3">byte</span>[<span class="cm-variable">_4M</span>]);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">//éå†å¼•ç”¨é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰å…ƒç´ ï¼Œåˆ™ç§»é™¤</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">Reference</span><span class="cm-operator">&lt;?</span> <span class="cm-keyword">extends</span> <span class="cm-variable-3">byte</span>[]<span class="cm-operator">&gt;</span> <span class="cm-variable">poll</span> <span class="cm-operator">=</span> <span class="cm-variable">queue</span>.<span class="cm-variable">poll</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">while</span>(<span class="cm-variable">poll</span> <span class="cm-operator">!=</span> <span class="cm-atom">null</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">//å¼•ç”¨é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œåˆ™ä»é›†åˆä¸­ç§»é™¤è¯¥å…ƒç´ </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">list</span>.<span class="cm-variable">remove</span>(<span class="cm-variable">poll</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">//ç§»åŠ¨åˆ°å¼•ç”¨é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">poll</span> <span class="cm-operator">=</span> <span class="cm-variable">queue</span>.<span class="cm-variable">poll</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span>}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 667px;"></div><div class="CodeMirror-gutters" style="display: none; height: 667px;"></div></div></div></pre></li><li><p><strong><span>å¼±å¼•ç”¨</span></strong><span>ï¼šåªæœ‰å¼±å¼•ç”¨å¼•ç”¨è¯¥å¯¹è±¡æ—¶ï¼Œ</span><strong><span>åœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œæ— è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶å¼±å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡ã€‚</span></strong><span>å¦‚ä¸Šå›¾å¦‚æœBå¯¹è±¡ä¸å†å¼•ç”¨A3å¯¹è±¡ï¼Œåˆ™A3å¯¹è±¡ä¼šè¢«å›æ”¶ã€‚å¼±å¼•ç”¨çš„ä½¿ç”¨å’Œè½¯å¼•ç”¨ç±»ä¼¼ï¼Œåªæ˜¯å°† SoftReference æ¢ä¸ºäº† WeakReferenceã€‚</span></p></li><li><p><strong><span>è™šå¼•ç”¨</span></strong><span>ï¼š</span><strong><span>å¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶ã€‚</span></strong><span>å½“è™šå¼•ç”¨å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«å›æ”¶ä»¥åï¼Œè™šå¼•ç”¨å¯¹è±¡å°±ä¼šè¢«æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚</span></p><ul><li><p><span>è™šå¼•ç”¨çš„ä¸€ä¸ªä½“ç°æ˜¯</span><strong><span>é‡Šæ”¾ç›´æ¥å†…å­˜æ‰€åˆ†é…çš„å†…å­˜</span></strong><span>ï¼Œå½“å¼•ç”¨çš„å¯¹è±¡ByteBufferè¢«åƒåœ¾å›æ”¶ä»¥åï¼Œè™šå¼•ç”¨å¯¹è±¡Cleanerå°±ä¼šè¢«æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œç„¶åè°ƒç”¨Cleanerçš„cleanæ–¹æ³•æ¥é‡Šæ”¾ç›´æ¥å†…å­˜ã€‚</span></p></li><li><p><span>å¦‚ä¸Šå›¾ï¼ŒBå¯¹è±¡ä¸å†å¼•ç”¨ByteBufferå¯¹è±¡ï¼ŒByteBufferå°±ä¼šè¢«å›æ”¶ã€‚ä½†æ˜¯ç›´æ¥å†…å­˜ä¸­çš„å†…å­˜è¿˜æœªè¢«å›æ”¶ã€‚è¿™æ—¶éœ€è¦å°†è™šå¼•ç”¨å¯¹è±¡Cleaneræ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œç„¶åè°ƒç”¨å®ƒçš„cleanæ–¹æ³•æ¥é‡Šæ”¾ç›´æ¥å†…å­˜</span></p></li></ul></li><li><h5 id='ç»ˆç»“å™¨å¼•ç”¨æ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿è‡ªobjectç±»objectç±»æœ‰ä¸€ä¸ªfinalizeæ–¹æ³•å½“æŸä¸ªå¯¹è±¡ä¸å†è¢«å…¶ä»–çš„å¯¹è±¡æ‰€å¼•ç”¨æ—¶ä¼šå…ˆå°†ç»ˆç»“å™¨å¼•ç”¨å¯¹è±¡æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ç„¶åæ ¹æ®ç»ˆç»“å™¨å¼•ç”¨å¯¹è±¡æ‰¾åˆ°å®ƒæ‰€å¼•ç”¨çš„å¯¹è±¡ç„¶åè°ƒç”¨è¯¥å¯¹è±¡çš„finalizeæ–¹æ³•è°ƒç”¨ä»¥åè¯¥å¯¹è±¡å°±å¯ä»¥è¢«åƒåœ¾å›æ”¶äº†'><span>ç»ˆç»“å™¨å¼•ç”¨ï¼šæ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿è‡ªObjectç±»ï¼ŒObjectç±»æœ‰ä¸€ä¸ªfinalizeæ–¹æ³•ã€‚å½“æŸä¸ªå¯¹è±¡ä¸å†è¢«å…¶ä»–çš„å¯¹è±¡æ‰€å¼•ç”¨æ—¶ï¼Œä¼šå…ˆå°†ç»ˆç»“å™¨å¼•ç”¨å¯¹è±¡æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œç„¶åæ ¹æ®ç»ˆç»“å™¨å¼•ç”¨å¯¹è±¡æ‰¾åˆ°å®ƒæ‰€å¼•ç”¨çš„å¯¹è±¡ï¼Œç„¶åè°ƒç”¨è¯¥å¯¹è±¡çš„finalizeæ–¹æ³•ã€‚è°ƒç”¨ä»¥åï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥è¢«åƒåœ¾å›æ”¶äº†ã€‚</span></h5><ul><li><p><span>å¦‚ä¸Šå›¾ï¼ŒBå¯¹è±¡ä¸å†å¼•ç”¨A4å¯¹è±¡ã€‚è¿™æ˜¯ç»ˆç»“å™¨å¯¹è±¡å°±ä¼šè¢«æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œå¼•ç”¨é˜Ÿåˆ—ä¼šæ ¹æ®å®ƒï¼Œæ‰¾åˆ°å®ƒæ‰€å¼•ç”¨çš„å¯¹è±¡ã€‚ç„¶åè°ƒç”¨è¢«å¼•ç”¨å¯¹è±¡çš„finalizeæ–¹æ³•ã€‚è°ƒç”¨ä»¥åï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥è¢«åƒåœ¾å›æ”¶äº†ã€‚</span></p></li></ul></li></ol><p><strong><span>å¼•ç”¨é˜Ÿåˆ—</span></strong></p><ul><li><p><span>è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨</span><strong><span>å¯ä»¥é…åˆ</span></strong><span>å¼•ç”¨é˜Ÿåˆ—ï¼šåœ¨</span><strong><span>å¼±å¼•ç”¨</span></strong><span>å’Œ</span><strong><span>è™šå¼•ç”¨</span></strong><span>æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«å›æ”¶ä»¥åï¼Œä¼šå°†è¿™äº›å¼•ç”¨æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œæ–¹ä¾¿ä¸€èµ·å›æ”¶è¿™äº›è½¯/å¼±å¼•ç”¨å¯¹è±¡ã€‚</span></p></li><li><p><span>è™šå¼•ç”¨å’Œç»ˆç»“å™¨å¼•ç”¨</span><strong><span>å¿…é¡»é…åˆ</span></strong><span>å¼•ç”¨é˜Ÿåˆ—ï¼šè™šå¼•ç”¨å’Œç»ˆç»“å™¨å¼•ç”¨åœ¨ä½¿ç”¨æ—¶ä¼šå…³è”ä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ã€‚</span></p></li></ul><h4 id='33-åƒåœ¾å›æ”¶ç®—æ³•'><span>3.3 åƒåœ¾å›æ”¶ç®—æ³•</span></h4><ol start='' ><li><p><strong><span>æ ‡è®°æ¸…é™¤ç®—æ³•ï¼š</span></strong><span> åœ¨</span><strong><span>æ ‡è®°é˜¶æ®µ</span></strong><span>ï¼Œç¨‹åºä¼šæ£€æŸ¥æ¯ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºæ´»åŠ¨å¯¹è±¡ï¼Œå¦‚æœæ˜¯æ´»åŠ¨å¯¹è±¡ï¼Œåˆ™ç¨‹åºä¼šåœ¨å¯¹è±¡å¤´éƒ¨æ‰“ä¸Šæ ‡è®°ã€‚åœ¨</span><strong><span>æ¸…é™¤é˜¶æ®µ</span></strong><span>ï¼Œä¼šè¿›è¡Œå¯¹è±¡å›æ”¶å¹¶å–æ¶ˆæ ‡å¿—ä½ï¼Œå¦å¤–ï¼Œè¿˜ä¼šåˆ¤æ–­å›æ”¶åçš„åˆ†å—ä¸å‰ä¸€ä¸ªç©ºé—²åˆ†å—æ˜¯å¦è¿ç»­ï¼Œè‹¥è¿ç»­ï¼Œä¼šåˆå¹¶è¿™ä¸¤ä¸ªåˆ†å—ã€‚å›æ”¶å¯¹è±¡å°±æ˜¯æŠŠå¯¹è±¡ä½œä¸ºåˆ†å—ï¼Œè¿æ¥åˆ°è¢«ç§°ä¸º â€œç©ºé—²é“¾è¡¨â€ çš„å•å‘é“¾è¡¨ï¼Œä¹‹åè¿›è¡Œåˆ†é…æ—¶åªéœ€è¦éå†è¿™ä¸ªç©ºé—²é“¾è¡¨ï¼Œå°±å¯ä»¥æ‰¾åˆ°åˆ†å—ã€‚</span></p><ul><li><p><strong><span>ä¼˜ç‚¹:</span></strong><span> å¯¹è±¡ä¸éœ€è¦ç§»åŠ¨ï¼Œåªæ“ä½œä¸å­˜æ´»å¯¹è±¡ï¼Œå­˜æ´»å¯¹è±¡å¤šçš„æ—¶å€™ä¸å½±å“æ•ˆç‡ã€‚</span></p></li><li><p><strong><span>ç¼ºç‚¹ï¼š</span></strong><span> </span><strong><span>æ‰§è¡Œæ•ˆç‡ä¸ç¨³å®š</span></strong><span>ï¼Œæ‰§è¡Œæ•ˆç‡éšç€å¯¹è±¡æ•°é‡çš„å¢é•¿è€Œé™ä½ã€‚</span><strong><span>ç©ºé—´é—®é¢˜</span></strong><span>ï¼Œæ ‡è®°æ¸…é™¤åä¼šäº§ç”Ÿå¤§é‡çš„ä¸è¿ç»­çš„ç¢ç‰‡ã€‚</span></p></li><li><p><strong><span>é€‚åˆ:</span></strong><span> å­˜æ´»æ¯”ä¾‹é«˜çš„ï¼Œå¸Œæœ›æš‚åœæ—¶é—´å°½å¯èƒ½çŸ­çš„ã€‚</span></p></li></ul></li><li><p><strong><span>æ ‡è®°å¤åˆ¶ç®—æ³•</span></strong><span>ï¼šå°†å†…å­˜åˆ†ä¸ºå¤§å°ç›¸åŒçš„ä¸¤å—ï¼Œæ¯æ¬¡ä½¿ç”¨å…¶ä¸­çš„ä¸€å—ï¼Œå½“è¿™ä¸€å—çš„å†…å­˜ä½¿ç”¨å®Œåï¼Œå°±å°†è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—å»ï¼Œç„¶åæŠŠä½¿ç”¨çš„ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚</span></p><ul><li><p><strong><span>ä¼˜ç‚¹ï¼š</span></strong><span> æ— ç¢ç‰‡ï¼Œæ ‡è®°å’Œå¤åˆ¶å¯ä»¥åŒæ—¶è¿›è¡Œï¼Œæ¯æ¬¡åªå¯¹ä¸€å—å†…å­˜è¿›è¡Œå›æ”¶ï¼Œé«˜æ•ˆï¼Œå®ç°ç®€å•ã€‚</span></p></li><li><p><strong><span>ç¼ºç‚¹ï¼š</span></strong><span> é¢å¤–ç©ºé—´ï¼Œç©ºé—´åˆ©ç”¨ç‡ä½ï¼›éœ€è¦æš‚åœã€‚</span></p></li><li><p><strong><span>é€‚åˆï¼š</span></strong><span> å­˜æ´»æ¯”ä¾‹å°‘ï¼Œå›æ”¶ä¸é¢‘ç¹ï¼Œå†…å­˜ç”³è¯·æ¬¡æ•°å¤š</span></p></li></ul></li><li><p><strong><span>æ ‡è®°æ•´ç†ç®—æ³•</span></strong><span>: è®©å­˜æ´»çš„å¯¹è±¡å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç›´æ¥æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚</span></p><ul><li><p><strong><span>ä¼˜ç‚¹ï¼š</span></strong><span> æ— ç¢ç‰‡ï¼Œå†…å­˜åˆ†é…æ›´åŠ å¿«é€Ÿï¼Œç©ºé—²å¤§å°å’Œä½ç½®ä¾¿äºç»Ÿè®¡ã€‚</span></p></li><li><p><strong><span>ç¼ºç‚¹ï¼š</span></strong><span> å› ä¸ºè¦ç§»åŠ¨å­˜æ´»çš„å˜é‡ï¼Œå’Œé‡æ–°å¼•ç”¨èµ‹å€¼ï¼Œ å°±éœ€è¦æ‰§è¡Œæš‚åœï¼Œä½¿å¾—GCæ—¶é—´å»¶é•¿ã€‚</span></p></li><li><p><strong><span>é€‚åˆï¼š</span></strong><span> å­˜æ´»æ¯”ä¾‹é«˜ï¼Œå›æ”¶ä¸é¢‘ç¹</span></p></li></ul></li><li><p><strong><span>åˆ†ä»£æ”¶é›†ç®—æ³•</span></strong></p></li></ol><ul><li><p><span>å¯¹äºæ–°ç”Ÿä»£ï¼Œå¯ä»¥é€‰æ‹©æ ‡è®°å¤åˆ¶.</span></p></li><li><p><span>å¯¹äºè€å¹´ä»£ï¼Œå¯ä»¥é€‰æ‹©æ ‡è®°æ¸…é™¤æˆ–è€…æ ‡è®°æ•´ç†ã€‚</span></p></li><li><p><span>æµç¨‹ï¼š</span></p><ul><li><p><span>æ–°åˆ›å»ºçš„å¯¹è±¡éƒ½è¢«æ”¾åœ¨äº†</span><strong><span>æ–°ç”Ÿä»£çš„ä¼Šç”¸å›­</span></strong><span>ä¸­ã€‚</span></p></li><li><p><span>å½“ä¼Šç”¸å›­ä¸­çš„å†…å­˜ä¸è¶³æ—¶ï¼Œå°±ä¼šè¿›è¡Œä¸€æ¬¡åƒåœ¾å›æ”¶ï¼Œè¿™æ—¶çš„å›æ”¶å«åš </span><strong><span>Minor GC</span></strong><span>ï¼ˆä¼šè§¦å‘ </span><strong><span>stop the world</span></strong><span>ï¼Œ æš‚åœå…¶ä»–ç”¨æˆ·çº¿ç¨‹ï¼Œåªè®©åƒåœ¾å›æ”¶çº¿ç¨‹å·¥ä½œï¼‰ã€‚</span></p></li><li><p><span>Minor GC ä¼šå°†</span><strong><span>ä¼Šç”¸å›­å’Œå¹¸å­˜åŒºFROM</span></strong><span>å­˜æ´»çš„å¯¹è±¡</span><strong><span>å…ˆ</span></strong><span>å¤åˆ¶åˆ° </span><strong><span>å¹¸å­˜åŒº TO</span></strong><span>ä¸­ï¼Œ å¹¶è®©å…¶</span><strong><span>å¯¿å‘½åŠ 1</span></strong><span>ï¼Œå†</span><strong><span>äº¤æ¢ä¸¤ä¸ªå¹¸å­˜åŒº</span></strong><span>ã€‚</span></p></li><li><p><span>å†æ¬¡åˆ›å»ºå¯¹è±¡ï¼Œè‹¥æ–°ç”Ÿä»£çš„ä¼Šç”¸å›­åˆæ»¡äº†ï¼Œåˆ™ä¼š</span><strong><span>å†æ¬¡è§¦å‘ Minor GC</span></strong><span>ï¼Œè¿™æ—¶ä¸ä»…ä¼šå›æ”¶ä¼Šç”¸å›­ä¸­çš„åƒåœ¾ï¼Œ</span><strong><span>è¿˜ä¼šå›æ”¶å¹¸å­˜åŒºä¸­çš„åƒåœ¾</span></strong><span>ï¼Œå†å°†æ´»è·ƒå¯¹è±¡å¤åˆ¶åˆ°å¹¸å­˜åŒºTOä¸­ã€‚å›æ”¶ä»¥åä¼šäº¤æ¢ä¸¤ä¸ªå¹¸å­˜åŒºï¼Œå¹¶è®©å¹¸å­˜åŒºä¸­çš„å¯¹è±¡</span><strong><span>å¯¿å‘½åŠ 1</span></strong><span>ã€‚(ä¹Ÿå°±æ˜¯ä¿è¯ToåŒºæ˜¯ç©ºçš„ã€‚)</span></p></li><li><p><span>å¦‚æœå¹¸å­˜åŒºä¸­çš„å¯¹è±¡çš„</span><strong><span>å¯¿å‘½è¶…è¿‡æŸä¸ªé˜ˆå€¼</span></strong><span>ï¼ˆæœ€å¤§ä¸º15ï¼Œ4bitï¼‰ï¼Œå°±ä¼šè¢«</span><strong><span>æ”¾å…¥è€å¹´ä»£</span></strong><span>ä¸­ã€‚</span></p></li><li><p><span>å¦‚æœæ–°ç”Ÿä»£è€å¹´ä»£ä¸­çš„å†…å­˜éƒ½æ»¡äº†ï¼Œå°±ä¼šå…ˆè§¦å‘Minor GCï¼Œå¦‚æœä¹‹åå†…å­˜è¿˜æ˜¯ä¸è¶³ã€‚å†è§¦å‘</span><strong><span>Full GC</span></strong><span>ï¼Œæ‰«æ</span><strong><span>æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸­</span></strong><span>æ‰€æœ‰ä¸å†ä½¿ç”¨çš„å¯¹è±¡å¹¶å›æ”¶ã€‚</span></p></li></ul></li></ul><h4 id='34-å¸¸è§çš„åƒåœ¾å›æ”¶å™¨'><span>3.4 </span><a href='https://snailclimb.gitee.io/javaguide/#/docs/java/jvm/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6?id=_41-serial-%e6%94%b6%e9%9b%86%e5%99%a8'><span>å¸¸è§çš„åƒåœ¾å›æ”¶å™¨</span></a></h4><ul><li><p><strong><span>å¹¶è¡Œæ”¶é›†</span></strong><span>ï¼šæŒ‡å¤šæ¡åƒåœ¾æ”¶é›†çº¿ç¨‹å¹¶è¡Œå·¥ä½œï¼Œä½†æ­¤æ—¶</span><strong><span>ç”¨æˆ·çº¿ç¨‹ä»å¤„äºç­‰å¾…çŠ¶æ€</span></strong><span>ã€‚</span></p></li><li><p><strong><span>å¹¶å‘æ”¶é›†</span></strong><span>ï¼šæŒ‡ç”¨æˆ·çº¿ç¨‹ä¸åƒåœ¾æ”¶é›†çº¿ç¨‹</span><strong><span>åŒæ—¶å·¥ä½œ</span></strong><span>ï¼ˆä¸ä¸€å®šæ˜¯å¹¶è¡Œçš„å¯èƒ½ä¼šäº¤æ›¿æ‰§è¡Œï¼‰ã€‚</span><strong><span>ç”¨æˆ·ç¨‹åºåœ¨ç»§ç»­è¿è¡Œ</span></strong><span>ï¼Œè€Œåƒåœ¾æ”¶é›†ç¨‹åºè¿è¡Œåœ¨å¦ä¸€ä¸ªCPUä¸Šã€‚</span></p></li><li><p><strong><span>ååé‡</span></strong><span>ï¼šå³CPUç”¨äº</span><strong><span>è¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´</span></strong><span>ä¸CPU</span><strong><span>æ€»æ¶ˆè€—æ—¶é—´</span></strong><span>çš„æ¯”å€¼ï¼ˆååé‡ = è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ / ( è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ + åƒåœ¾æ”¶é›†æ—¶é—´ )ï¼‰ï¼Œä¹Ÿå°±æ˜¯ã€‚ä¾‹å¦‚ï¼šè™šæ‹Ÿæœºå…±è¿è¡Œ100åˆ†é’Ÿï¼Œåƒåœ¾æ”¶é›†å™¨èŠ±æ‰1åˆ†é’Ÿï¼Œé‚£ä¹ˆååé‡å°±æ˜¯99%</span></p></li><li><p><strong><span>ä¸²è¡Œ</span></strong></p><ul><li><p><span>å•çº¿ç¨‹</span></p></li><li><p><span>å†…å­˜è¾ƒå°ï¼Œä¸ªäººç”µè„‘ï¼ˆCPUæ ¸æ•°è¾ƒå°‘ï¼‰</span></p></li></ul></li><li><p><span>ååé‡ä¼˜å…ˆï¼š</span></p><ul><li><p><span>å¤šçº¿ç¨‹</span></p></li><li><p><span>å †å†…å­˜è¾ƒå¤§ï¼Œå¤šæ ¸cpu</span></p></li><li><p><span>è®©å•ä½æ—¶é—´å†…STWæ—¶é—´çŸ­   å•æ¬¡0.2ç§’ï¼Œæ¯”0.1så¤šï¼Œä½†æ˜¯æ€»å…±èŠ±çš„æ—¶é—´å°‘ä¸€å…±0.2s</span></p></li></ul></li><li><p><span>å“åº”æ—¶é—´ä¼˜å…ˆï¼š</span></p><ul><li><p><span>å¤šçº¿ç¨‹</span></p></li><li><p><span>å †å†…å­˜è¾ƒå¤§, å¤šæ ¸cpu</span></p></li><li><p><span>å°½å¯èƒ½è®©å•æ¬¡STWçš„æ—¶é—´æœ€çŸ­   å•æ¬¡0.1s ï¼Œæœ‰ä¸‰æ¬¡  ä¹Ÿå°±æ˜¯ä¸€å…±0.3s</span></p></li></ul></li></ul><p><img src="./images/åƒåœ¾æ”¶é›†å™¨.jpg" referrerpolicy="no-referrer"></p><h5 id='341-serialæ”¶é›†å™¨'><span>3.4.1 Serialæ”¶é›†å™¨</span></h5><p><img src="./images/serial.jpg" referrerpolicy="no-referrer"></p><p><strong><span>Serialï¼ˆä¸²è¡Œï¼‰æ”¶é›†å™¨æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨äº†ã€‚å®ƒåªä¼šä½¿ç”¨ä¸€æ¡åƒåœ¾æ”¶é›†çº¿ç¨‹å»å®Œæˆåƒåœ¾æ”¶é›†å·¥ä½œï¼Œåœ¨è¿›è¡Œåƒåœ¾æ”¶é›†å·¥ä½œçš„æ—¶å€™å¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ï¼ˆ &quot;Stop The World&quot; ï¼‰ï¼Œç›´åˆ°å®ƒæ”¶é›†ç»“æŸã€‚</span></strong></p><ul><li><p><span>æ”¶é›†ç®—æ³•ï¼š</span><strong><span>æ–°ç”Ÿä»£é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚</span></strong></p></li><li><p><span>ç¼ºç‚¹ï¼šè¿›è¡Œåƒåœ¾æ”¶é›†å·¥ä½œçš„æ—¶å€™å¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ã€‚</span></p></li><li><p><span>ä¼˜ç‚¹ï¼šç®€å•è€Œé«˜æ•ˆï¼ˆä¸å…¶ä»–æ”¶é›†å™¨çš„å•çº¿ç¨‹ç›¸æ¯”ï¼‰ã€‚Serial æ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œè‡ªç„¶å¯ä»¥è·å¾—å¾ˆé«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡ã€‚Serial æ”¶é›†å™¨å¯¹äºè¿è¡Œåœ¨ Client æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºæ¥è¯´æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</span></p></li></ul><h5 id='342-serialoldæ”¶é›†å™¨'><span>3.4.2 SerialOldæ”¶é›†å™¨</span></h5><p><strong><span>æ˜¯ Serial æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬</span></strong><span>ï¼Œä¹Ÿæ˜¯ç»™ Client åœºæ™¯ä¸‹çš„è™šæ‹Ÿæœºä½¿ç”¨ã€‚å¦‚æœç”¨åœ¨ Server åœºæ™¯ä¸‹ï¼Œå®ƒæœ‰ä¸¤å¤§ç”¨é€”ï¼š</span></p><ul><li><p><span>åœ¨ JDK 1.5 ä»¥åŠä¹‹å‰ç‰ˆæœ¬ï¼ˆParallel Old è¯ç”Ÿä»¥å‰ï¼‰ä¸­ä¸ Parallel Scavenge æ”¶é›†å™¨æ­é…ä½¿ç”¨ã€‚</span></p></li><li><p><span>ä½œä¸º CMS æ”¶é›†å™¨çš„åå¤‡é¢„æ¡ˆï¼Œåœ¨å¹¶å‘æ”¶é›†å‘ç”Ÿ Concurrent Mode Failure æ—¶ä½¿ç”¨ã€‚</span></p></li></ul><h5 id='343-parallel-scavenge-æ”¶é›†å™¨'><span>3.4.3 Parallel Scavenge æ”¶é›†å™¨ </span></h5><p><strong><span>Parallel Scavenge æ”¶é›†å™¨ä¹Ÿæ˜¯ä½¿ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•çš„å¤šçº¿ç¨‹æ”¶é›†å™¨ã€‚</span></strong></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseParallelGC</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">ä½¿ç”¨</span> <span class="cm-variable">Parallel</span> <span class="cm-variable">æ”¶é›†å™¨</span><span class="cm-operator">+</span> <span class="cm-variable">è€å¹´ä»£ä¸²è¡Œ</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseParallelOldGC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">ä½¿ç”¨</span> <span class="cm-variable">Parallel</span> <span class="cm-variable">æ”¶é›†å™¨</span><span class="cm-operator">+</span> <span class="cm-variable">è€å¹´ä»£å¹¶è¡Œ</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre><ul><li><p><strong><span>Parallel Scavenge æ”¶é›†å™¨å…³æ³¨ç‚¹æ˜¯ååé‡ï¼ˆé«˜æ•ˆç‡çš„åˆ©ç”¨ CPUï¼‰ã€‚CMS ç­‰åƒåœ¾æ”¶é›†å™¨çš„å…³æ³¨ç‚¹æ›´å¤šçš„æ˜¯ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ï¼ˆæé«˜ç”¨æˆ·ä½“éªŒï¼‰ã€‚æ‰€è°“ååé‡å°±æ˜¯ CPU ä¸­ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´ä¸ CPU æ€»æ¶ˆè€—æ—¶é—´çš„æ¯”å€¼ã€‚</span></strong><span> Parallel Scavenge æ”¶é›†å™¨æä¾›äº†å¾ˆå¤šå‚æ•°ä¾›ç”¨æˆ·æ‰¾åˆ°æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–æœ€å¤§ååé‡ï¼Œå¦‚æœå¯¹äºæ”¶é›†å™¨è¿ä½œä¸å¤ªäº†è§£ï¼Œæ‰‹å·¥ä¼˜åŒ–å­˜åœ¨å›°éš¾çš„æ—¶å€™ï¼Œä½¿ç”¨ Parallel Scavenge æ”¶é›†å™¨é…åˆè‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ï¼ŒæŠŠå†…å­˜ç®¡ç†ä¼˜åŒ–äº¤ç»™è™šæ‹Ÿæœºå»å®Œæˆä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</span></p></li><li><p><strong><span>æ–°ç”Ÿä»£é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚</span></strong></p></li><li><p><span>JDK1.8 é»˜è®¤ä½¿ç”¨çš„æ˜¯ Parallel Scavenge + Parallel Oldï¼Œå¦‚æœæŒ‡å®šäº†-XX:+UseParallelGC å‚æ•°ï¼Œåˆ™é»˜è®¤æŒ‡å®šäº†-XX:+UseParallelOldGCï¼Œå¯ä»¥ä½¿ç”¨-XX:-UseParallelOldGC æ¥ç¦ç”¨è¯¥åŠŸèƒ½</span></p></li></ul><h5 id='344-parallel-old-æ”¶é›†å™¨'><span>3.4.4 Parallel Old æ”¶é›†å™¨</span></h5><p><strong><span>Parallel Scavenge æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬</span></strong><span>ã€‚ä½¿ç”¨</span><strong><span>å¤šçº¿ç¨‹å’Œâ€œæ ‡è®°-æ•´ç†â€ç®—æ³•</span></strong><span>ã€‚åœ¨æ³¨é‡ååé‡ä»¥åŠ CPU èµ„æºçš„åœºåˆï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘ Parallel Scavenge æ”¶é›†å™¨å’Œ Parallel Old æ”¶é›†å™¨ã€‚</span></p><h5 id='345-parnewæ”¶é›†å™¨'><span>3.4.5 ParNewæ”¶é›†å™¨</span></h5><p><strong><span>ParNew æ”¶é›†å™¨å…¶å®å°±æ˜¯ Serial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯GCçº¿ç¨‹å¹¶å‘ï¼Œåº”ç”¨ç¨‹åºæš‚åœã€‚</span></strong><span> é™¤äº†ä½¿ç”¨å¤šçº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†å¤–ï¼Œå…¶ä½™è¡Œä¸ºï¼ˆæ§åˆ¶å‚æ•°ã€æ”¶é›†ç®—æ³•ã€å›æ”¶ç­–ç•¥ç­‰ç­‰ï¼‰å’Œ Serial æ”¶é›†å™¨å®Œå…¨ä¸€æ ·ã€‚</span></p><ul><li><p><span>æ”¶é›†ç®—æ³•ï¼š</span><strong><span>æ–°ç”Ÿä»£é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚</span></strong></p></li><li><p><span>å®ƒæ˜¯è®¸å¤šè¿è¡Œåœ¨ Server æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºçš„é¦–è¦é€‰æ‹©ï¼Œ</span><strong><span>é™¤äº† Serial æ”¶é›†å™¨å¤–ï¼Œåªæœ‰å®ƒèƒ½ä¸ CMS æ”¶é›†å™¨ï¼ˆçœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘æ”¶é›†å™¨ï¼Œåé¢ä¼šä»‹ç»åˆ°ï¼‰é…åˆå·¥ä½œã€‚</span></strong></p></li></ul><h5 id='346-cms-æ”¶é›†å™¨'><span>3.4.6 CMS æ”¶é›†å™¨</span></h5><p><img src="./images/CMSæ”¶é›†å™¨.png" referrerpolicy="no-referrer" alt="CMSæ”¶é›†å™¨.png"></p><ul><li><p><strong><span>CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚å®ƒéå¸¸ç¬¦åˆåœ¨æ³¨é‡ç”¨æˆ·ä½“éªŒçš„åº”ç”¨ä¸Šä½¿ç”¨ã€‚</span></strong></p></li><li><p><strong><span>CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨æ˜¯ HotSpot è™šæ‹Ÿæœºç¬¬ä¸€æ¬¾çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘æ”¶é›†å™¨ï¼Œå®ƒç¬¬ä¸€æ¬¡å®ç°äº†è®©åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹ï¼ˆåŸºæœ¬ä¸Šï¼‰åŒæ—¶å·¥ä½œã€‚</span></strong></p></li><li><p><span>CMS æ”¶é›†å™¨æ˜¯ä¸€ç§ </span><strong><span>â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•</span></strong><span>å®ç°çš„ï¼Œå®ƒçš„è¿ä½œè¿‡ç¨‹ç›¸æ¯”äºå‰é¢å‡ ç§åƒåœ¾æ”¶é›†å™¨æ¥è¯´æ›´åŠ å¤æ‚ä¸€äº›ã€‚æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼š</span></p><ul><li><p><strong><span>åˆå§‹æ ‡è®°ï¼š</span></strong><span> æš‚åœæ‰€æœ‰çš„å…¶ä»–çº¿ç¨‹ï¼Œå¹¶è®°å½•ä¸‹ç›´æ¥ä¸ root ç›¸è¿çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿« ï¼›</span></p></li><li><p><strong><span>å¹¶å‘æ ‡è®°ï¼š</span></strong><span> åŒæ—¶å¼€å¯ GC å’Œç”¨æˆ·çº¿ç¨‹ï¼Œç”¨ä¸€ä¸ªé—­åŒ…ç»“æ„å»è®°å½•å¯è¾¾å¯¹è±¡ã€‚ä½†åœ¨è¿™ä¸ªé˜¶æ®µç»“æŸï¼Œè¿™ä¸ªé—­åŒ…ç»“æ„å¹¶ä¸èƒ½ä¿è¯åŒ…å«å½“å‰æ‰€æœ‰çš„å¯è¾¾å¯¹è±¡ã€‚å› ä¸ºç”¨æˆ·çº¿ç¨‹å¯èƒ½ä¼šä¸æ–­çš„æ›´æ–°å¼•ç”¨åŸŸï¼Œæ‰€ä»¥ GC çº¿ç¨‹æ— æ³•ä¿è¯å¯è¾¾æ€§åˆ†æçš„å®æ—¶æ€§ã€‚æ‰€ä»¥è¿™ä¸ªç®—æ³•é‡Œä¼šè·Ÿè¸ªè®°å½•è¿™äº›å‘ç”Ÿå¼•ç”¨æ›´æ–°çš„åœ°æ–¹ã€‚</span></p></li><li><p><strong><span>é‡æ–°æ ‡è®°ï¼š</span></strong><span> é‡æ–°æ ‡è®°é˜¶æ®µå°±æ˜¯ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ä¸ºç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œè¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´ä¸€èˆ¬ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µçš„æ—¶é—´ç¨é•¿ï¼Œè¿œè¿œæ¯”å¹¶å‘æ ‡è®°é˜¶æ®µæ—¶é—´çŸ­</span></p></li><li><p><strong><span>å¹¶å‘æ¸…é™¤ï¼š</span></strong><span> å¼€å¯ç”¨æˆ·çº¿ç¨‹ï¼ŒåŒæ—¶ GC çº¿ç¨‹å¼€å§‹å¯¹æœªæ ‡è®°çš„åŒºåŸŸåšæ¸…æ‰«ã€‚</span></p></li></ul></li><li><p><span>ä»å®ƒçš„åå­—å°±å¯ä»¥çœ‹å‡ºå®ƒæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„åƒåœ¾æ”¶é›†å™¨ï¼Œä¸»è¦ä¼˜ç‚¹ï¼š</span><strong><span>å¹¶å‘æ”¶é›†ã€ä½åœé¡¿</span></strong><span>ã€‚ä½†æ˜¯å®ƒæœ‰ä¸‹é¢ä¸‰ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼š</span></p><ul><li><p><strong><span>å¯¹ CPU èµ„æºæ•æ„Ÿï¼›</span></strong></p></li><li><p><strong><span>æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾</span></strong><span>ï¼šå¹¶å‘æ¸…é™¤è¿‡ç¨‹ä¸­ç”¨æˆ·çº¿ç¨‹äº§ç”Ÿçš„åƒåœ¾ã€‚</span></p></li><li><p><strong><span>å®ƒä½¿ç”¨çš„å›æ”¶ç®—æ³•-â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ä¼šå¯¼è‡´æ”¶é›†ç»“æŸæ—¶ä¼šæœ‰å¤§é‡ç©ºé—´ç¢ç‰‡äº§ç”Ÿã€‚</span></strong></p></li></ul></li><li><p><span>ä¸ParNewæ”¶é›†å™¨é…åˆä½¿ç”¨ï¼Œå› ä¸ºä½¿ç”¨æ ‡è®°æ¸…é™¤ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¼šé€ æˆç©ºé—´ç¢ç‰‡ï¼Œç¢ç‰‡è¿‡å¤šé€ æˆå¹¶å‘å¤±è´¥ï¼Œä¼šé€€åŒ–åˆ° Serialæ”¶é›†å™¨ã€‚</span></p></li></ul><h5 id='347-g1æ”¶é›†å™¨'><span>3.4.7 G1æ”¶é›†å™¨</span></h5><p><span>Garbage First</span></p><ul><li><p><span>JDK 9ä»¥åé»˜è®¤ä½¿ç”¨ï¼Œè€Œä¸”æ›¿ä»£äº†CMS æ”¶é›†å™¨</span></p></li><li><h5 id='é€‚ç”¨åœºæ™¯'><span>é€‚ç”¨åœºæ™¯</span></h5><ul><li><p><span>åŒæ—¶æ³¨é‡ååé‡å’Œä½å»¶è¿Ÿï¼ˆå“åº”æ—¶é—´ï¼‰</span></p></li><li><p><span>è¶…å¤§å †å†…å­˜ï¼ˆå†…å­˜å¤§çš„ï¼‰ï¼Œä¼šå°†å †å†…å­˜åˆ’åˆ†ä¸ºå¤šä¸ª</span><strong><span>å¤§å°ç›¸ç­‰</span></strong><span>çš„åŒºåŸŸ</span></p></li><li><p><span>æ•´ä½“ä¸Šæ˜¯</span><strong><span>æ ‡è®°-æ•´ç†</span></strong><span>ç®—æ³•ï¼Œä¸¤ä¸ªåŒºåŸŸä¹‹é—´æ˜¯</span><strong><span>å¤åˆ¶</span></strong><span>ç®—æ³•</span></p></li></ul></li><li><p><span>G1åƒåœ¾å›æ”¶å™¨ä¸»è¦å°†å †å†…å­˜åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„åŒºåŸŸï¼ˆç§°ä¸ºRegionï¼‰ï¼Œå„ä¸ªåŒºåŸŸæ ¹æ®éœ€è¦æ‰®æ¼”ä¸åŒçš„è§’è‰²ï¼Œå¯ä»¥è¢«å®šä¹‰ä¸ºEdenåŒºã€SurvivoråŒºã€OldåŒºå’ŒHumongousåŒºï¼ˆå­˜æ”¾å¤§å¯¹è±¡ï¼Œè€å¹´ä»£çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œé‡‡ç”¨å¤åˆ¶ç®—æ³•é’ˆå¯¹æ¯ä¸ªåŒºåŸŸè¿›è¡Œåƒåœ¾å›æ”¶ï¼ŒåŒæ ·ä¹Ÿæ”¯æŒåŠ¨æ€çš„è°ƒæ•´å†…å­˜å¤§å°ã€‚åŒæ—¶å„ä¸ªRegionä¸éœ€è¦è¿ç»­çš„å­˜å‚¨ï¼Œé¢ è¦†äº†ä»¥å¾€å †å†…å­˜ç»“æ„çš„è¿ç»­æ€§ï¼Œå…·å¤‡å¼ºå¤§çš„çµæ´»æ€§ï¼Œä¹Ÿè¿›ä¸€æ­¥æé«˜äº†å†…å­˜åˆ©ç”¨ç‡ã€‚</span></p></li><li><p><span>å…¶ä¸­åŒºåŸŸ</span><code>Region</code><span>çš„å†…å­˜å¤§å°é»˜è®¤æ˜¯é€šè¿‡æ•´ä¸ªå †å†…å­˜å¤§å°é™¤ä»¥</span><code>2048</code><span>å¾—åˆ°çš„ï¼Œä¾‹å¦‚æ•´ä¸ªå †å†…å­˜ä¸º</span><code>4G</code><span>ï¼Œåˆ™</span><code>Region = 4G / 2048 = 2M</code><span>ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒé€šè¿‡JVMå‚æ•°æŒ‡å®š</span><code>Region</code><span>çš„å†…å­˜å¤§å°ã€‚</span></p></li></ul><p><img src="assets/image-20240624153729428.png" referrerpolicy="no-referrer" alt="image-20240624153729428"></p><ul><li><p><span>G1åƒåœ¾å›æ”¶å™¨åœ¨è®¾è®¡æ—¶ï¼Œå……åˆ†ç»“åˆäº†Parallel Scavengeå’ŒCMSåƒåœ¾å›æ”¶å™¨çš„ä¼˜ç‚¹ï¼Œè§£å†³Parallel Scavengeå’ŒCMSå­˜åœ¨çš„é—®é¢˜ï¼ŒG1ä¹Ÿç§°åƒåœ¾ä¼˜å…ˆå›æ”¶å™¨ï¼Œä¸ä¼šåƒå…¶å®ƒåƒåœ¾å›æ”¶å™¨ä¸€æ ·ç­‰åˆ°ç©ºé—´å¿«æ»¡æ—¶æ‰ä¼šè¿›è¡Œå›æ”¶ï¼Œè€Œæ˜¯æå‰è§¦å‘å›æ”¶ï¼ˆå°‘é‡å¤šæ¬¡ï¼‰ï¼Œæ¯æ¬¡åƒåœ¾å›æ”¶æ—¶é—´çŸ­ï¼Œååé‡é«˜ï¼Œå…¶ä¼˜åŠ¿ä¸»è¦åŒ…æ‹¬ï¼š</span></p><ul><li><p><span>å……åˆ†åˆ©ç”¨CPUèµ„æºï¼šG1é€šè¿‡å¹¶è¡Œå¤„ç†æé«˜äº†åƒåœ¾å›æ”¶çš„æ‰§è¡Œæ•ˆç‡ï¼Œåœ¨å¤„ç†å¤§æ•°æ®æ—¶å…·å¤‡è‰¯å¥½çš„æ€§èƒ½</span></p></li><li><p><span>é¿å…å†…å­˜ç¢ç‰‡ï¼šG1é‡‡ç”¨å¤åˆ¶ç®—æ³•å®ç°åƒåœ¾å›æ”¶ï¼Œè§£å†³CMSåƒåœ¾å›æ”¶å™¨é‡‡ç”¨æ ‡è®°æ¸…é™¤ç®—æ³•å¯¼è‡´çš„å†…å­˜ç¢ç‰‡ï¼Œæé«˜äº†å†…å­˜åˆ©ç”¨ç‡</span></p></li><li><p><span>æ»¡è¶³æœ€å¤§æš‚åœæ—¶é—´ï¼šæ”¯æŒç”¨æˆ·è®¾å®šæœ€å¤§æš‚åœæ—¶é—´ï¼ŒG1åœ¨è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ä¼šæ ¹æ®è®¾å®šçš„æ—¶é—´ï¼Œè§„åˆ’å‡ºæœ¬æ¬¡æœ€å¤šèƒ½å¤Ÿå›æ”¶å‡ ä¸ªRegionï¼Œå°½å¯èƒ½ä¿è¯ç¨‹åºçš„å“åº”æ—¶é—´éœ€æ±‚</span></p></li></ul><p><img src="assets/image-20240624154235736.png" referrerpolicy="no-referrer" alt="image-20240624154235736"></p></li><li><p><span>åƒåœ¾å›æ”¶è¿‡ç¨‹</span></p><ul><li><p><strong><span>Young Collectionï¼š</span></strong><span>ä¸€å¼€å§‹ç±»åŠ è½½æ—¶ï¼Œä¼šæ”¾å…¥æ–°ç”Ÿä»£ä¼Šç”¸å›­åŒºï¼Œç¬¬ä¸€æ¬¡å†…å­˜ä¸å¤Ÿï¼ŒæŠŠæ¯ä¸ªä¼Šç”¸å›­å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¹¸å­˜åŒºã€‚å†…å­˜å†æ¬¡ä¸å¤Ÿï¼Œå¯¿å‘½åˆ°è¾¾é˜ˆå€¼çš„å¯¹è±¡å°†æ™‹å‡åˆ°è€å¹´ä»£ä¸­ï¼Œä¼Šç”¸å›­å’Œå¹¸å­˜åŒºä¼šç»§ç»­å¤åˆ¶åˆ°æ–°çš„å¹¸å­˜åŒºã€‚ï¼ˆä¼šSTWï¼‰</span></p></li></ul><p><img src="assets/image-20240624154818939.png" referrerpolicy="no-referrer" alt="image-20240624154818939"></p><ul><li><p><strong><span>Young Collection + CM</span></strong><span>ï¼š</span></p><ul><li><p><span>åœ¨ Young GC æ—¶ä¼šè¿›è¡Œ GC Root çš„</span><strong><span>åˆå§‹æ ‡è®°</span></strong></p></li><li><p><strong><span>å¹¶å‘æ ‡è®°</span></strong><span>ï¼ˆCMï¼‰æ˜¯ä»GC Rootå‡ºå‘é¡ºç€å…¶å¼•ç”¨é“¾æ ‡è®°å…¶ä»–å¯¹è±¡</span></p></li><li><p><span>è€å¹´ä»£å ç”¨å †ç©ºé—´æ¯”ä¾‹è¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œè¿›è¡Œå¹¶å‘æ ‡è®°ï¼ˆä¸ä¼š STWï¼‰ï¼Œç”±ä¸‹é¢çš„ JVM å‚æ•°å†³å®š</span></p></li><li><p><span>-XX:InitiatingHeapOccupancyPercent=percent ï¼ˆé»˜è®¤45%ï¼‰</span><strong><span>å¦‚ä¸‹å›¾ O å æ€»çš„45%æ—¶è¿›è¡Œå¹¶å‘æ ‡è®°</span></strong></p></li></ul></li><li><p><strong><span>Mixed Collection</span></strong><span>ï¼š</span></p><ul><li><p><span>ä¼šå¯¹ Eã€Sã€O </span><strong><span>è¿›è¡Œå…¨é¢åƒåœ¾å›æ”¶</span></strong><span>ï¼Œè€å¹´ä»£ä¼šæ ¹æ®æœ€å¤§æš‚åœæ—¶é—´è¿›è¡Œæœ‰é€‰æ‹©çš„å›æ”¶ã€‚</span></p></li><li><p><span>æœ€ç»ˆæ ‡è®°ï¼ˆ</span><strong><span>Remarkè§2.4.4.6</span></strong><span>ï¼‰ä¼š STW</span></p></li><li><p><span>æ‹·è´å­˜æ´»ï¼ˆEvacuationï¼‰ä¼š STW</span></p></li><li><p><span>-XX:MaxGCPauseMillis=ms</span></p></li></ul></li></ul></li></ul><p><img src="assets/image-20240624155405462.png" referrerpolicy="no-referrer" alt="image-20240624155405462"></p><ul><li><p><strong><span>å¹´è½»ä»£å›æ”¶ï¼ˆYoung GCï¼‰åŸç†</span></strong></p><ul><li><p><span>G1åƒåœ¾å›æ”¶å™¨å¹´è½»ä»£å›æ”¶æ—¶ï¼Œé‡‡ç”¨äº†ä¸‰ç§å…³é”®æŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯</span><strong><span>è®°å¿†é›†</span></strong><span>ã€</span><strong><span>å¡è¡¨</span></strong><span>å’Œ</span><strong><span>å†™å±éšœ</span></strong><span>ã€‚</span></p></li><li><p><span>å½“G1è§¦å‘</span><strong><span>Young GC</span></strong><span>æ—¶ï¼Œåªä¼šæ‰«æå¹´è½»ä»£åŒºåŸŸï¼ˆ</span><code>Eden</code><span>åŒº + </span><code>Survivor</code><span>åŒºï¼‰çš„å¯¹è±¡ï¼Œä»</span><code>GC Root</code><span>æ ¹å¯¹è±¡å‡ºå‘æ—¶ï¼Œå¾ˆå®¹æ˜“æ‰«æå‡ºå¹´è½»ä»£çš„å¯¹è±¡ä»¥åŠå¹´è½»ä»£å¯¹è±¡å¼•ç”¨çš„å…¶å®ƒå¹´è½»ä»£çš„å¯¹è±¡ã€‚ä½†è¿™æ ·ä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœå¹´è½»ä»£çš„å¯¹è±¡è¢«è€å¹´ä»£çš„å¯¹è±¡å¼•ç”¨äº†ï¼Œåº”è¯¥å¦‚ä½•è¯†åˆ«å‡ºæ¥å‘¢ï¼Ÿ</span></p><ul><li><p><strong><span>è®°å¿†é›†ï¼ˆRememberedSetï¼‰:</span></strong><span>å…¶å®G1åƒåœ¾å›æ”¶å™¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ç§å¼•ç”¨è¯¦æƒ…è¡¨ï¼Œç§°ä¸º</span><strong><span>è®°å¿†é›†</span></strong><span>çš„æ•°æ®ç»“æ„ï¼Œè®°å½•è·¨ä»£å¼•ç”¨ï¼Œå³éå›æ”¶åŒºåŸŸï¼ˆè€å¹´ä»£ï¼‰å¯¹è±¡å¼•ç”¨å›æ”¶åŒºåŸŸï¼ˆå¹´è½»ä»£ï¼‰å¯¹è±¡çš„å…³ç³»ã€‚è®°å¿†é›†ä»…è®°å½•è·¨ä»£çš„å¯¹è±¡å¼•ç”¨å…³ç³»ï¼Œä¸ä¼šè®°å½•å¹´è½»ä»£åŒºåŸŸä¹‹é—´çš„å¯¹è±¡å¼•ç”¨ã€‚åœ¨Young GCå›æ”¶å¹´è½»ä»£å¯¹è±¡æ—¶ï¼Œä¼šå°†è®°å¿†é›†ä¸­çš„å¯¹è±¡ä¹ŸåŠ å…¥åˆ°</span><code>GC Root</code><span>ä¸­ï¼Œæœ‰æ•ˆé¿å…å¹´è½»ä»£çš„å¯¹è±¡è¢«é”™è¯¯çš„å›æ”¶</span></p></li><li><p><strong><span>å¡è¡¨ï¼ˆCard Tableï¼‰ä¸å¡é¡µï¼ˆCard Pageï¼‰</span></strong><span>ï¼šåœ¨G1åƒåœ¾å›æ”¶å™¨ä¸­ï¼Œä¸ºäº†è¿›ä¸€æ­¥å‹ç¼©è®°å¿†é›†å ç”¨çš„å†…å­˜ï¼Œå…¶å°†æ‰€æœ‰çš„</span><code>Region</code><span>åŒºåŸŸæŒ‰å¤§å°åˆ’åˆ†ä¸ºå¤šä¸ªåˆ†å—ï¼Œç§°ä¸º</span><strong><span>å¡é¡µï¼ˆCard Pageï¼‰</span></strong><span>ï¼Œå¯¹æ¯ä¸ªå¡é¡µè¿›è¡Œç¼–å·ã€‚åŒæ—¶æ¯ä¸ªRegionåŒºåŸŸéƒ½ä¼šæœ‰é¢å¤–é…å¤‡ä¸€å°å—å†…å­˜ï¼Œè¿™å—å†…å­˜ç§°ä¸º</span><strong><span>å¡è¡¨ï¼ˆCard Tableï¼‰</span></strong><span>ï¼Œç”¨äºè®°å½•æ•´ä¸ªå †ç©ºé—´ä¸­æœ‰å“ªäº›å¡é¡µå¼•ç”¨äº†è‡ªå·±RegionåŒºåŸŸçš„å¯¹è±¡ï¼Œå¡è¡¨çš„åº•å±‚æ•°æ®ç»“æ„æ˜¯å­—èŠ‚æ•°ç»„ï¼Œæ¯ä¸€ä¸ªå­—èŠ‚å¯¹åº”ä¸€ä¸ªå¡é¡µï¼Œå½“æŸä¸ªå¡é¡µä¸­çš„å¯¹è±¡å¼•ç”¨è‡ªå·±RegionåŒºåŸŸçš„å¯¹è±¡æ—¶ï¼Œä¼šå°†å¡è¡¨å¯¹åº”ç¼–å·ä½ç½®çš„å­—èŠ‚ä¿®æ”¹ä¸º1ï¼Œä¸º1çš„å­—èŠ‚è¢«ç§°ä¹‹ä¸ºè„å¡ã€‚æ­¤æ—¶ç”Ÿæˆè®°å¿†é›†å°±ä¼šæ¯”è¾ƒå®¹æ˜“ï¼Œåªç”¨éå†å„ä¸ª</span><code>Region</code><span>çš„å¡è¡¨ï¼Œæ‰¾åˆ°æ‰€æœ‰å­—èŠ‚ä¸º</span><code>1</code><span>çš„è„å¡ï¼Œå½¢æˆè®°å¿†é›†ã€‚å½“å¹´è½»ä»£åƒåœ¾å›æ”¶æ ‡è®°å­˜æ´»å¯¹è±¡æ—¶ï¼ŒG1å°†æ­¤è®°å¿†é›†ä¸­çš„æ‰€æœ‰å¯¹è±¡ä¹ŸåŠ å…¥åˆ°</span><code>GC Root</code><span>æ ¹å¯¹è±¡é›†åˆä¸­ï¼Œç¡®ä¿è¢«è€å¹´ä»£å¼•ç”¨çš„å¹´è½»ä»£å¯¹è±¡æ ‡è®°ä¸ºå­˜æ´»ã€‚</span></p><p><img src="assets/image-20240624160953830.png" referrerpolicy="no-referrer" alt="image-20240624160953830"></p></li><li><p><strong><span>å†™åå±éšœ</span></strong><span>ï¼ˆå¼•ç”¨å¯¹è±¡èµ‹å€¼åçš„ç‰¹æ®Šå¤„ç†ï¼‰ï¼šå†™åå±éšœæŒ‡ä»¤åˆ¤æ–­åˆ°è€å¹´ä»£å¯¹è±¡å¼•ç”¨å¹´è½»ä»£å¯¹è±¡æ—¶ï¼Œä¼šæ›´æ”¹å¡è¡¨ä¸­å¯¹åº”çš„å­—èŠ‚ä¸ºè„å¡ï¼ŒåŒæ—¶ä¼šå°†è„å¡æ”¾å…¥åˆ°ä¸€ä¸ª</span><strong><span>è„å¡é˜Ÿåˆ—</span></strong><span>ä¸­ï¼Œ</span><strong><span>JVMä¼šé€šè¿‡å•ç‹¬çš„çº¿ç¨‹ï¼Œå®šæœŸè¯»å–è„å¡é˜Ÿåˆ—ä¸­çš„æ•°æ®ï¼Œæ›´æ–°è®°å¿†é›†</span></strong><span>ã€‚ï¼ˆè¿™æ˜¯ç”±äºå†™å±éšœæŒ‡ä»¤æ˜¯ç”±ç”¨æˆ·çº¿ç¨‹å®Œæˆçš„ï¼Œå¦‚æœæœ‰å¤§é‡çš„ç”¨æˆ·çº¿ç¨‹ä¿®æ”¹å¯¹è±¡å¼•ç”¨å…³ç³»ï¼Œä¼šäº§ç”Ÿçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œåˆ™éœ€è¦å¯¹è®°å¿†é›†è¿›è¡ŒåŠ é”ï¼ŒåŠ é”ä¹‹ååŠ¿å¿…ä¼šå½±å“æ‰§è¡Œæ•ˆç‡ã€‚å› æ­¤è¿™é‡Œå°†è„å¡å…ˆæ”¾å…¥è„å¡é˜Ÿåˆ—ï¼Œé‡‡ç”¨å•ç‹¬çš„çº¿ç¨‹å¼‚æ­¥æ¶ˆè´¹ï¼Œé¿å…å½±å“ç”¨æˆ·çº¿ç¨‹ã€‚ï¼‰</span></p></li></ul><p><img src="assets/image-20240624161628059.png" referrerpolicy="no-referrer" alt="image-20240624161628059"></p></li></ul></li><li><p><strong><span>æ··åˆå›æ”¶åŸç†</span></strong></p><ul><li><p><span>æ··åˆå›æ”¶æ˜¯é’ˆå¯¹å¹´è½»ä»£å’Œéƒ¨åˆ†è€å¹´ä»£åŒºåŸŸçš„åƒåœ¾å›æ”¶ï¼Œå½“è€å¹´ä»£å†…å­˜å ç”¨ç‡è¾¾åˆ°è®¾å®šé˜ˆå€¼ï¼Œæˆ–åˆ†é…å¤§å¯¹è±¡æ—¶ï¼Œå°†ä¼šè§¦å‘æ··åˆå›æ”¶</span><strong><span>Mixed GC</span></strong><span>ã€‚</span></p></li><li><p><span>ä¸‰è‰²æ ‡è®°ç®—æ³•ï¼šG1åƒåœ¾å›æ”¶å™¨åœ¨</span><strong><span>åˆå§‹æ ‡è®°</span></strong><span>é˜¶æ®µé‡‡ç”¨ä¸‰è‰²æ ‡è®°ç®—æ³•æ ‡è¯†å¯¹è±¡ï¼Œä¸‰è‰²æŒ‡çš„çš„é»‘ç™½ç°ï¼Œç®€å•çš„è¯´ï¼Œå°†æ‰€æœ‰å¯¹è±¡æ¸²æŸ“æˆä¸åŒçš„é¢œè‰²ï¼Œä¾¿äºåŒºåˆ†ã€‚å®é™…ä¸Šï¼Œæ ‡è®°å¯¹è±¡çš„é¢œè‰²å…¶å®æ˜¯é€šè¿‡</span><strong><span>ä½å›¾</span></strong><span>ï¼ˆ</span><strong><span>bitmap</span></strong><span>ï¼‰å®ç°çš„ï¼Œé»˜è®¤çš„ç™½è‰²å¯¹è±¡çš„</span><code>bit</code><span>ä¸º</span><code>0</code><span>ï¼Œé»‘è‰²å¯¹è±¡çš„</span><code>bit</code><span>ä½ä¼šè¢«è®¾ç½®ä¸º</span><code>1</code><span>ï¼Œè€Œç°è‰²å¯¹è±¡ä¸ä¼šä½“ç°åœ¨ä½å›¾ï¼Œä¼šè¢«æ”¾ç½®äºä¸€ä¸ªå•ç‹¬çš„é˜Ÿåˆ—ï¼Œç­‰å¾…åç»­å¤„ç†ã€‚</span></p><ul><li><p><span>ç™½è‰²ï¼ˆåƒåœ¾å¯¹è±¡ï¼‰ï¼šç™½è‰²ä»£è¡¨è¯¥å¯¹è±¡ä¸åœ¨GC Rootçš„å¼•ç”¨é“¾ä¸Šï¼Œåœ¨æ ‡è®°å¼€å§‹æ—¶ï¼Œå †å†…å­˜ä¸­çš„æ‰€æœ‰å¯¹è±¡é»˜è®¤éƒ½æ˜¯ç™½è‰²ï¼Œå½“æ ‡è®°ç»“æŸï¼Œå¦‚æœå¯¹è±¡ä»ç„¶ä¸ºç™½è‰²ï¼Œåˆ™è¢«è®¤ä¸ºæ˜¯åƒåœ¾å¯¹è±¡</span></p></li><li><p><span>ç°è‰²ï¼ˆå¾…å¤„ç†å¯¹è±¡ï¼‰ï¼šç°è‰²ä»£è¡¨è¯¥å¯¹è±¡åœ¨GC Rootçš„å¼•ç”¨é“¾ä¸Šï¼Œä½†è¯¥å¯¹è±¡æ‰€æœ‰å¼•ç”¨çš„å¯¹è±¡è¿˜æœªè¢«æ ‡è®°è¿‡ï¼Œæ˜¯ä¸€ä¸ªè¿‡æ¸¡é¢œè‰²ï¼Œæœ€ç»ˆä¼šè¢«æ ‡è®°ä¸ºé»‘è‰²</span></p></li><li><p><span>é»‘è‰²ï¼ˆå­˜æ´»å¯¹è±¡ï¼‰ï¼šé»‘è‰²ä»£è¡¨è¯¥å¯¹è±¡åœ¨GC Rootçš„å¼•ç”¨é“¾ä¸Šï¼Œä¸”è¯¥å¯¹è±¡æ‰€æœ‰å¼•ç”¨çš„å¯¹è±¡å‡å·²è¢«æ ‡è®°è¿‡ï¼Œä»£è¡¨å­˜æ´»å¯¹è±¡</span></p></li></ul><p><img src="assets/image-20240624162021043.png" referrerpolicy="no-referrer" alt="image-20240624162021043"></p></li><li><p><strong><span>å¹¶å‘æ ‡è®°é˜¶æ®µï¼š</span></strong><span>å¹¶å‘æ ‡è®°é˜¶æ®µä»</span><code>GC Root</code><span>ç›´æ¥å…³è”çš„å¯¹è±¡è¿›è¡Œå®Œæ•´éå†ï¼Œæ ‡è®°å‡ºæ‰€æœ‰å­˜æ´»çš„å¯¹è±¡ï¼Œè€—æ—¶è¾ƒé•¿ï¼Œä½†æœ¬é˜¶æ®µä¸ç”¨æˆ·çº¿ç¨‹å¯åŒæ—¶å¹¶å‘æ‰§è¡Œï¼Œä¸ä¼šæš‚åœç”¨æˆ·çº¿ç¨‹ã€‚</span></p><ul><li><p><span>ä½†æ˜¯ï¼Œå¹¶å‘æ ‡è®°é˜¶æ®µç”±äºç”¨æˆ·çº¿ç¨‹å¹¶æ²¡æœ‰æš‚åœï¼Œä¼šäº§ç”Ÿæ–°é—®é¢˜ï¼Œå³ç”¨æˆ·çº¿ç¨‹è‹¥åœ¨æ­¤æœŸé—´ä¿®æ”¹äº†å¯¹è±¡çš„å¼•ç”¨å…³ç³»ï¼Œå°±ä¼šå¯¼è‡´æ ‡è®°ç»“æœä¸å‡†ç¡®ï¼Œè¿™é‡Œå…¶å®ä¼šè¯¯åˆ¤ä¸¤ç§æƒ…å†µï¼š</span><strong><span>å¤šæ ‡</span></strong><span>å’Œ</span><strong><span>æ¼æ ‡</span></strong><span>ã€‚å¤šæ ‡çš„é—®é¢˜å…¶å®å¹¶ä¸ä¸¥é‡ï¼Œé¡¶å¤šäº§ç”Ÿæµ®åŠ¨åƒåœ¾ï¼Œç­‰åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶ä¹Ÿä¼šè¢«å›æ”¶ï¼Œä½†æ¼æ ‡å´æ˜¯å¾ˆè‡´å‘½çš„ï¼Œå·²ç»å½±å“åˆ°äº†ç¨‹åºçš„æ­£å¸¸è¿è¡Œï¼Œè€ŒG1åƒåœ¾å›æ”¶å™¨é‡‡ç”¨äº†</span><strong><span>SATBåŸå§‹å¿«ç…§</span></strong><span>æŠ€æœ¯è§£å†³äº†è¿™ä¸€æ¼æ ‡é—®é¢˜ã€‚</span><strong><span>SATBä¸»è¦ä¸ºè§£å†³å¹¶å‘æ ‡è®°é˜¶æ®µå¯èƒ½äº§ç”Ÿçš„å¯¹è±¡å¼•ç”¨å˜åŒ–é—®é¢˜</span></strong><span>ï¼ŒSATBå³ä¸€ä¸ªåŸå§‹å¿«ç…§ï¼Œç±»ä¼¼äºæ‹ç…§ä¸€æ ·ï¼Œè®°å½•æŸä¸€æ—¶åˆ»æ‰€æœ‰çš„å¯¹è±¡ï¼ŒSATBçš„ä¸»è¦æ‰§è¡Œé€»è¾‘å¦‚ä¸‹ï¼š</span></p><ul><li><p><span>åœ¨æ ‡è®°å¼€å§‹æ—¶ï¼Œåˆ›å»ºä¸€ä¸ªåŸå§‹å¿«ç…§ï¼Œè®°å½•å½“å‰æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡</span></p></li><li><p><span>åœ¨æ ‡è®°æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œç›´æ¥æ ‡è®°ä¸ºé»‘è‰²</span></p></li><li><p><span>åœ¨æ ‡è®°æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå‡ºç°å¯¹è±¡å¼•ç”¨èµ‹å€¼æ“ä½œï¼ŒG1åƒåœ¾å›æ”¶å™¨é‡‡ç”¨å†™å‰å±éšœæŠ€æœ¯ï¼Œå°†å¼•ç”¨çš„å¯¹è±¡æ”¾å…¥ä¸€ä¸ªå¾…å¤„ç†çš„SATBé˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—æ˜¯æ¯ä¸ªçº¿ç¨‹ç‹¬æœ‰çš„ï¼Œæœ€ç»ˆä¼šæ±‡æ€»åˆ°å…¨å±€çš„SATBé˜Ÿåˆ—ã€‚</span></p></li></ul></li></ul></li><li><p><strong><span>æœ€ç»ˆæ ‡è®°é˜¶æ®µï¼š</span></strong><span>æœ€ç»ˆæ ‡è®°é˜¶æ®µä¼šæš‚åœç”¨æˆ·çº¿ç¨‹ï¼Œä¸»è¦ç”¨äº</span><strong><span>ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´äº§ç”Ÿå˜åŠ¨çš„å¯¹è±¡</span></strong><span>ï¼Œæ€»ä½“è€—æ—¶çŸ­äºå¹¶å‘æ ‡è®°é˜¶æ®µã€‚</span></p><ul><li><p><span>æœ€ç»ˆæ ‡è®°é˜¶æ®µé¦–å…ˆä¼šæš‚åœç”¨æˆ·çº¿ç¨‹ï¼Œå°†æ‰€æœ‰çº¿ç¨‹çš„SATBé˜Ÿåˆ—åˆå¹¶åˆ°å…¨å±€SATBé˜Ÿåˆ—ï¼Œé€ä¸€æ¶ˆè´¹ã€‚</span></p></li><li><p><span>åœ¨å…¨å±€SATBé˜Ÿåˆ—ä¸­çš„å¯¹è±¡ï¼Œé»˜è®¤æŒ‰ç…§é»‘è‰²å­˜æ´»å¯¹è±¡å¤„ç†ï¼ŒåŒæ—¶å¤„ç†å®ƒä»¬å¼•ç”¨çš„å…¶å®ƒå¯¹è±¡ã€‚</span></p></li><li><p><span>æ˜¾è€Œæ˜“è§ï¼ŒSATBä¹Ÿä¼šé€ æˆå¤šæ ‡çš„æƒ…å†µï¼Œå°†å¯ä»¥è¢«å›æ”¶çš„åƒåœ¾å¯¹è±¡æ ‡è®°ä¸ºå­˜æ´»å¯¹è±¡ï¼Œäº§ç”Ÿäº†æµ®åŠ¨åƒåœ¾ï¼Œè¿™äº›æµ®åŠ¨åƒåœ¾éœ€è¦ç­‰åˆ°ä¸‹ä¸€è½®åƒåœ¾å›æ”¶æ—¶è¢«å›æ”¶ã€‚</span></p></li></ul></li><li><p><strong><span>æ¸…ç†é˜¶æ®µï¼š</span></strong><span>æ¸…ç†é˜¶æ®µä¹Ÿä¼šæš‚åœç”¨æˆ·çº¿ç¨‹ï¼Œåœ¨æœ€ç»ˆæ ‡è®°é˜¶æ®µå®Œæˆä¹‹åï¼ŒG1åƒåœ¾å›æ”¶å™¨ä¼šæ•´ç†</span><code>Region</code><span>åŒºåŸŸï¼Œè°ƒæ•´å¯¹åº”çš„è®°å¿†é›†ï¼Œè‹¥è¯†åˆ«åˆ°æŸä¸ª</span><code>Region</code><span>ä¸å­˜åœ¨ä»»ä½•å­˜æ´»å¯¹è±¡æ—¶ï¼Œä¼šç›´æ¥æ¸…ç†æ‰è¯¥</span><code>Region</code><span>ï¼Œé‡Šæ”¾å†…å­˜</span></p></li><li><p><strong><span>è½¬ç§»é˜¶æ®µï¼š</span></strong></p></li><li><p><span>è½¬ç§»é˜¶æ®µåŒæ ·ä¹Ÿä¼šæš‚åœç”¨æˆ·çº¿ç¨‹ï¼Œéœ€è¦å°†æŸä¸€ä¸ªRegionåŒºåŸŸå­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ªRegionï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š</span></p><ul><li><p><span>åŒºåŸŸé€‰æ‹©ï¼šG1åƒåœ¾å›æ”¶å™¨ä¼šé’ˆå¯¹å„ä¸ªRegionçš„å›æ”¶ä»·å€¼è¿›è¡Œæ’åºï¼Œè¯„ä¼°æœ€å¤§æš‚åœæ—¶é—´ï¼Œé€‰æ‹©ç‰¹å®šçš„Regionè¿›è¡Œå›æ”¶ï¼ˆä¸€èˆ¬æ˜¯åƒåœ¾å¯¹è±¡æœ€å¤šçš„åŒºåŸŸï¼‰</span></p></li><li><p><span>å¯¹è±¡å¤åˆ¶è½¬ç§»ï¼šé€‰å®šå¥½Regionåï¼Œé¦–å…ˆä¼šå°†GC Rootæ ¹å¯¹è±¡ç›´æ¥å…³è”çš„å¯¹è±¡è½¬ç§»åˆ°æ–°çš„RegionåŒºåŸŸï¼Œç„¶åä¾æ¬¡è½¬ç§»å…¶å¼•ç”¨çš„å¯¹è±¡</span></p></li><li><p><span>æ›´æ–°å¼•ç”¨å…³ç³»ï¼šå¯¹è±¡è½¬ç§»åˆ°æ–°çš„RegionåŒºåŸŸåï¼Œä¼šæ¸…ç†åˆ°ä¹‹å‰çš„Regionã€‚è‹¥å…¶å®ƒRegionåŒºåŸŸä¸­çš„å¯¹è±¡å¼•ç”¨äº†è½¬ç§»åçš„å¯¹è±¡ï¼Œåˆ™ä¼šé‡æ–°è®¾ç½®å®ƒä»¬çš„å¼•ç”¨å…³ç³»ï¼Œé¿å…å¯¹è±¡ç§»åŠ¨ä½ç½®åå¼•ç”¨å‡ºé”™ã€‚</span></p></li></ul></li></ul></li></ul><h4 id='35-fullgc-ä¸minorgc'><span>3.5 FullGC ä¸minorGC</span></h4><ul><li><p><span>SerialGC</span></p><ul><li><p><span>æ–°ç”Ÿä»£å†…å­˜ä¸è¶³åƒåœ¾å›æ”¶ minorGC</span></p></li><li><p><span>è€å¹´ä»£å†…å­˜ä¸è¶³åƒåœ¾å›æ”¶  FullGC </span></p></li></ul></li><li><p><span>ParallelGC</span></p><ul><li><p><span>æ–°ç”Ÿä»£å†…å­˜ä¸è¶³åƒåœ¾å›æ”¶ minorGC</span></p></li><li><p><span>è€å¹´ä»£å†…å­˜ä¸è¶³åƒåœ¾å›æ”¶  FullGC </span></p></li></ul></li><li><p><span>CMS</span></p><ul><li><p><span>æ–°ç”Ÿä»£å†…å­˜ä¸è¶³åƒåœ¾å›æ”¶ minorGC</span></p></li><li><p><span>è€å¹´ä»£å†…å­˜ä¸è¶³</span></p><ul><li><p><span>å¹¶å‘å¤±è´¥åï¼Œä¼šè¿›è¡ŒFull GC</span></p></li></ul></li></ul></li><li><p><span>G1</span></p><ul><li><p><span>æ–°ç”Ÿä»£å†…å­˜ä¸è¶³åƒåœ¾å›æ”¶ minorGC</span></p></li><li><p><span>è€å¹´ä»£å†…å­˜ä¸è¶³ï¼ˆè€å¹´ä»£æ‰€å å†…å­˜è¶…è¿‡é˜ˆå€¼ï¼‰</span></p><ul><li><p><span>å¦‚æœåƒåœ¾äº§ç”Ÿé€Ÿåº¦æ…¢äºåƒåœ¾å›æ”¶é€Ÿåº¦ï¼Œä¸ä¼šè§¦å‘Full GCï¼Œè¿˜æ˜¯å¹¶å‘åœ°è¿›è¡Œæ¸…ç†</span></p></li><li><p><span>å¦‚æœåƒåœ¾äº§ç”Ÿé€Ÿåº¦å¿«äºåƒåœ¾å›æ”¶é€Ÿåº¦ï¼Œä¾¿ä¼šè§¦å‘Full GC</span></p></li></ul></li></ul></li></ul><h1 id='å››å†…å­˜åˆ†é…ç­–ç•¥ä¸å›æ”¶ç­–ç•¥'><span>å››ã€å†…å­˜åˆ†é…ç­–ç•¥ä¸å›æ”¶ç­–ç•¥</span></h1><h3 id='41--minor-gc-å’Œ-full-gc'><span>4.1  Minor GC å’Œ Full GC</span></h3><ul><li><p><span>Minor GCï¼šå›æ”¶æ–°ç”Ÿä»£ï¼Œå› ä¸ºæ–°ç”Ÿä»£å¯¹è±¡å­˜æ´»æ—¶é—´å¾ˆçŸ­ï¼Œå› æ­¤ Minor GC ä¼šé¢‘ç¹æ‰§è¡Œï¼Œæ‰§è¡Œçš„é€Ÿåº¦ä¸€èˆ¬ä¹Ÿä¼šæ¯”è¾ƒå¿«ã€‚</span></p></li><li><p><span>Full GCï¼šå›æ”¶è€å¹´ä»£å’Œæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£å¯¹è±¡å…¶å­˜æ´»æ—¶é—´é•¿ï¼Œå› æ­¤ Full GC å¾ˆå°‘æ‰§è¡Œï¼Œæ‰§è¡Œé€Ÿåº¦ä¼šæ¯” Minor GC æ…¢å¾ˆå¤šã€‚</span></p></li></ul><h3 id='42-å†…å­˜åˆ†é…ç­–ç•¥'><span>4.2 å†…å­˜åˆ†é…ç­–ç•¥</span></h3><p><strong><span>1. å¯¹è±¡ä¼˜å…ˆåœ¨ Eden åˆ†é…</span></strong></p><p><span>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£ Eden ä¸Šåˆ†é…ï¼Œå½“ Eden ç©ºé—´ä¸å¤Ÿæ—¶ï¼Œå‘èµ· Minor GCã€‚</span></p><p><strong><span>2. å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£</span></strong></p><p><strong><span>å¤§å¯¹è±¡æ˜¯æŒ‡éœ€è¦è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼Œæœ€å…¸å‹çš„å¤§å¯¹è±¡æ˜¯é‚£ç§å¾ˆé•¿çš„å­—ç¬¦ä¸²ä»¥åŠæ•°ç»„ã€‚</span></strong></p><p><span>ç»å¸¸å‡ºç°å¤§å¯¹è±¡ä¼šæå‰è§¦å‘åƒåœ¾æ”¶é›†ä»¥è·å–è¶³å¤Ÿçš„è¿ç»­ç©ºé—´åˆ†é…ç»™å¤§å¯¹è±¡ã€‚</span></p><p><span>-XX:PretenureSizeThresholdï¼Œå¤§äºæ­¤å€¼çš„å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ï¼Œé¿å…åœ¨ Eden å’Œ Survivor ä¹‹é—´çš„å¤§é‡å†…å­˜å¤åˆ¶ã€</span></p><p><strong><span>3. é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£</span></strong></p><p><strong><span>ä¸ºå¯¹è±¡å®šä¹‰å¹´é¾„è®¡æ•°å™¨ï¼Œå¯¹è±¡åœ¨ Eden å‡ºç”Ÿå¹¶ç»è¿‡ Minor GC ä¾ç„¶å­˜æ´»ï¼Œå°†ç§»åŠ¨åˆ° Survivor ä¸­ï¼Œå¹´é¾„å°±å¢åŠ  1 å²ï¼Œå¢åŠ åˆ°ä¸€å®šå¹´é¾„åˆ™ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ã€‚</span></strong></p><p><span>-XX:MaxTenuringThreshold ç”¨æ¥å®šä¹‰å¹´é¾„çš„é˜ˆå€¼</span></p><p><span> </span><strong><span>4. åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š</span></strong></p><p><span>è™šæ‹Ÿæœºå¹¶ä¸æ˜¯æ°¸è¿œè¦æ±‚å¯¹è±¡çš„å¹´é¾„å¿…é¡»è¾¾åˆ° MaxTenuringThreshold æ‰èƒ½æ™‹å‡è€å¹´ä»£ï¼Œ</span><strong><span>å¦‚æœåœ¨ Survivor ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äº Survivor ç©ºé—´çš„ä¸€åŠï¼Œåˆ™å¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£</span></strong><span>ï¼Œæ— éœ€ç­‰åˆ° MaxTenuringThreshold ä¸­è¦æ±‚çš„å¹´é¾„ã€‚</span></p><p><strong><span>5. ç©ºé—´åˆ†é…æ‹…ä¿</span></strong></p><p><strong><span>åœ¨å‘ç”Ÿ Minor GC ä¹‹å‰ï¼Œè™šæ‹Ÿæœºå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ï¼Œå¦‚æœæ¡ä»¶æˆç«‹çš„è¯ï¼Œé‚£ä¹ˆ Minor GC å¯ä»¥ç¡®è®¤æ˜¯å®‰å…¨çš„ã€‚</span></strong></p><p><span>å¦‚æœä¸æˆç«‹çš„è¯è™šæ‹Ÿæœºä¼šæŸ¥çœ‹ HandlePromotionFailure çš„å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ï¼Œå¦‚æœå…è®¸é‚£ä¹ˆå°±ä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œå¦‚æœå¤§äºï¼Œå°†å°è¯•ç€è¿›è¡Œä¸€æ¬¡ Minor GCï¼›å¦‚æœå°äºï¼Œæˆ–è€… HandlePromotionFailure çš„å€¼ä¸å…è®¸å†’é™©ï¼Œé‚£ä¹ˆå°±è¦è¿›è¡Œä¸€æ¬¡ Full GCã€‚</span></p><h3 id='43-full-gc-çš„è§¦å‘æ¡ä»¶'><span>4.3 Full GC çš„è§¦å‘æ¡ä»¶</span></h3><p><span>å¯¹äº Minor GCï¼Œå…¶è§¦å‘æ¡ä»¶éå¸¸ç®€å•ï¼Œå½“ Eden ç©ºé—´æ»¡æ—¶ï¼Œå°±å°†è§¦å‘ä¸€æ¬¡ Minor GCã€‚è€Œ Full GC åˆ™ç›¸å¯¹å¤æ‚ï¼Œæœ‰ä»¥ä¸‹æ¡ä»¶ï¼š</span></p><p><span> </span><strong><span>1. è°ƒç”¨ System.gc()</span></strong></p><p><span>åªæ˜¯å»ºè®®è™šæ‹Ÿæœºæ‰§è¡Œ Full GCï¼Œä½†æ˜¯è™šæ‹Ÿæœºä¸ä¸€å®šçœŸæ­£å»æ‰§è¡Œã€‚ä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œè€Œæ˜¯è®©è™šæ‹Ÿæœºç®¡ç†å†…å­˜.</span></p><p><strong><span>2. è€å¹´ä»£ç©ºé—´ä¸è¶³</span></strong></p><p><strong><span>è€å¹´ä»£ç©ºé—´ä¸è¶³çš„å¸¸è§åœºæ™¯ä¸ºå‰æ–‡æ‰€è®²çš„å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ã€é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ç­‰ã€‚</span></strong></p><p><span>ä¸ºäº†é¿å…ä»¥ä¸ŠåŸå› å¼•èµ·çš„ Full GCï¼Œåº”å½“å°½é‡ä¸è¦åˆ›å»ºè¿‡å¤§çš„å¯¹è±¡ä»¥åŠæ•°ç»„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥é€šè¿‡ -Xmn è™šæ‹Ÿæœºå‚æ•°è°ƒå¤§æ–°ç”Ÿä»£çš„å¤§å°ï¼Œè®©å¯¹è±¡å°½é‡åœ¨æ–°ç”Ÿä»£è¢«å›æ”¶æ‰ï¼Œä¸è¿›å…¥è€å¹´ä»£ã€‚è¿˜å¯ä»¥é€šè¿‡ -XX:MaxTenuringThreshold è°ƒå¤§å¯¹è±¡è¿›å…¥è€å¹´ä»£çš„å¹´é¾„ï¼Œè®©å¯¹è±¡åœ¨æ–°ç”Ÿä»£å¤šå­˜æ´»ä¸€æ®µæ—¶é—´ã€‚</span></p><p><span> </span><strong><span>3. ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥</span></strong></p><p><strong><span>åœ¨å‘ç”Ÿ Minor GC ä¹‹å‰ï¼Œè™šæ‹Ÿæœºå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ï¼Œå¦‚æœæ¡ä»¶æˆç«‹çš„è¯ï¼Œé‚£ä¹ˆ Minor GC å¯ä»¥ç¡®è®¤æ˜¯å®‰å…¨çš„ã€‚</span></strong></p><p><span>å¦‚æœä¸æˆç«‹çš„è¯è™šæ‹Ÿæœºä¼šæŸ¥çœ‹ HandlePromotionFailure çš„å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ï¼Œå¦‚æœå…è®¸é‚£ä¹ˆå°±ä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œå¦‚æœå¤§äºï¼Œå°†å°è¯•ç€è¿›è¡Œä¸€æ¬¡ Minor GCï¼›å¦‚æœå°äºï¼Œæˆ–è€… HandlePromotionFailure çš„å€¼ä¸å…è®¸å†’é™©ï¼Œé‚£ä¹ˆå°±è¦è¿›è¡Œä¸€æ¬¡ Full GCã€‚</span></p><p><strong><span>4. JDK 1.7 åŠä»¥å‰çš„æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³</span></strong></p><p><span>åœ¨ JDK 1.7 åŠä»¥å‰ï¼ŒHotSpot è™šæ‹Ÿæœºä¸­çš„æ–¹æ³•åŒºæ˜¯ç”¨æ°¸ä¹…ä»£å®ç°çš„ï¼Œæ°¸ä¹…ä»£ä¸­å­˜æ”¾çš„ä¸ºä¸€äº› Class çš„ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰æ•°æ®ã€‚</span></p><p><span>å½“ç³»ç»Ÿä¸­è¦åŠ è½½çš„ç±»ã€åå°„çš„ç±»å’Œè°ƒç”¨çš„æ–¹æ³•è¾ƒå¤šæ—¶ï¼Œæ°¸ä¹…ä»£å¯èƒ½ä¼šè¢«å æ»¡ï¼Œåœ¨æœªé…ç½®ä¸ºé‡‡ç”¨ CMS GC çš„æƒ…å†µä¸‹ä¹Ÿä¼šæ‰§è¡Œ Full GCã€‚å¦‚æœç»è¿‡ Full GC ä»ç„¶å›æ”¶ä¸äº†ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºä¼šæŠ›å‡º java.lang.OutOfMemoryErrorã€‚</span></p><p><span>ä¸ºé¿å…ä»¥ä¸ŠåŸå› å¼•èµ·çš„ Full GCï¼Œå¯é‡‡ç”¨çš„æ–¹æ³•ä¸ºå¢å¤§æ°¸ä¹…ä»£ç©ºé—´æˆ–è½¬ä¸ºä½¿ç”¨ CMS GCã€‚</span></p><p><strong><span>5. Concurrent Mode Failure</span></strong></p><p><span>æ‰§è¡Œ CMS GC çš„è¿‡ç¨‹ä¸­åŒæ—¶æœ‰å¯¹è±¡è¦æ”¾å…¥è€å¹´ä»£ï¼Œè€Œæ­¤æ—¶è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼ˆå¯èƒ½æ˜¯ GC è¿‡ç¨‹ä¸­æµ®åŠ¨åƒåœ¾è¿‡å¤šå¯¼è‡´æš‚æ—¶æ€§çš„ç©ºé—´ä¸è¶³ï¼‰ï¼Œä¾¿ä¼šæŠ¥ Concurrent Mode Failure é”™è¯¯ï¼Œå¹¶è§¦å‘ Full GCã€‚</span></p><h1 id='äº”é‡ç‚¹çŸ¥è¯†è¡¥å……'><span>äº”ã€é‡ç‚¹çŸ¥è¯†è¡¥å……</span></h1><h3 id='51-å¸¸é‡æ± '><span>5.1 å¸¸é‡æ± </span></h3><p><span>javaçš„å¸¸é‡æ± æœ‰ä¸‰ç§ï¼Œå³å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œclasså¸¸é‡æ± ï¼Œè¿è¡Œæ—¶å¸¸é‡æ± ã€‚</span></p><ol start='' ><li><p><span>classå¸¸é‡æ± ï¼šæˆ‘ä»¬å†™çš„æ¯ä¸€ä¸ªjavaç±»è¢«ç¼–è¯‘ä¹‹åéƒ½ä¼šç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„classæ–‡ä»¶ã€‚classæ–‡ä»¶ä¸­é™¤äº†æœ‰ç±»çš„ç‰ˆæœ¬ï¼Œå­—æ®µæ–¹æ³•ï¼Œæ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰ä¸€é¡¹ä¿¡æ¯æ—¶å¸¸é‡æ± ï¼Œç”¨äºå­˜æ”¾ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚æ¯ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªclasså¸¸é‡æ± ã€‚</span></p><blockquote><p><span>ä»€ä¹ˆæ—¶å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼Ÿ</span></p><p><span>å­—é¢é‡æ¯”è¾ƒæ¥è¿‘äºjavaè¯­è¨€å±‚é¢çš„å¸¸é‡æ¦‚å¿µï¼Œå¦‚æ–‡æœ¬å­—ç¬¦ä¸²ï¼Œå£°æ˜ä¸ºfinalçš„å¸¸é‡å€¼å’Œ8ç§åŸºæœ¬ç±»å‹çš„å˜é‡ï¼Œè€Œç¬¦å·å¼•ç”¨åˆ™å±äºç¼–è¯‘åŸç†æ–¹é¢çš„æ¦‚å¿µï¼ŒåŒ…æ‹¬ä¸‰ç±»å˜é‡:ç±»å’Œæ¥å£çš„å…¨é™å®šåã€‚å­—æ®µçš„åç§°å’Œæè¿°ç¬¦ã€‚æ–¹æ³•çš„åç§°å’Œæè¿°ç¬¦</span></p></blockquote></li><li><p><span>å­—ç¬¦ä¸²å¸¸é‡æ± </span></p><ul><li><p><span>ä¸ºå­—ç¬¦ä¸²å¼€è¾Ÿä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œç±»ä¼¼äºç¼“å­˜åŒºã€‚</span></p></li><li><p><span>åˆ›å»ºå­—ç¬¦ä¸²å¸¸é‡æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥å­—ç¬¦ä¸²å¸¸é‡æ± æ˜¯å¦å­˜åœ¨è¯¥å­—ç¬¦ä¸²</span></p></li><li><p><span>è‹¥å­˜åœ¨è¯¥å­—ç¬¦ä¸²ï¼Œè¿”å›å¼•ç”¨å®ä¾‹ï¼›è‹¥ä¸å­˜åœ¨ï¼Œå®ä¾‹åŒ–è¯¥å­—ç¬¦ä¸²å¹¶æ”¾å…¥æ± ä¸­</span></p></li><li><p><span>åœ¨JDK1.6ä¹‹å‰ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± åœ¨æ–¹æ³•åŒºï¼Œåœ¨JDK1.7ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± è¢«ç§»å…¥äº†å †ä¸­ã€‚ç§»å…¥å †ä¸­çš„åŸå› å¤§æ¦‚æ˜¯æ–¹æ³•åŒºçš„å†…å­˜ç©ºé—´å¤ªå°äº†ã€‚</span></p></li></ul></li><li><p><span>è¿è¡Œæ—¶å¸¸é‡æ± </span></p><ul><li><p><span>è¿è¡Œæ—¶å¸¸é‡æ± å­˜åœ¨äºå†…å­˜ä¸­çš„æ–¹æ³•åŒºï¼Œclasså¸¸é‡æ± è¢«åŠ è½½åˆ°å†…å­˜ä¹‹åä¼šå­˜æ”¾åœ¨è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ã€‚é™¤äº†ä¿å­˜Classæ–‡ä»¶ä¸­æè¿°çš„ç¬¦å·å¼•ç”¨å¤–ï¼Œè¿˜ä¼šæŠŠç¬¦å·å¼•ç”¨ç¿»è¯‘ä¸ºç›´æ¥å¼•ç”¨ï¼Œå¹¶å­˜å‚¨åœ¨è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ã€‚</span></p></li></ul><p>&nbsp;</p><p><img src="./images/å¸¸é‡æ± å¯¹æ¯”.png" referrerpolicy="no-referrer"></p><p>&nbsp;</p></li></ol><h3 id='52-stringç±»ä¸å¸¸é‡æ± '><span>5.2 Stringç±»ä¸å¸¸é‡æ± </span></h3><p><span>stringç±»å¯¹è±¡åˆ›å»ºçš„ä¸¤ç§æ–¹å¼:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-3">String</span> <span class="cm-variable">str1</span><span class="cm-operator">=</span><span class="cm-string">'abcd'</span>;<span class="cm-comment">//å…ˆæ£€æŸ¥å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æœ‰æ²¡æœ‰â€˜abcdâ€™ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªï¼Œç„¶åstr1æŒ‡å‘å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„å¯¹è±¡ï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥å°†str1æŒ‡å‘â€˜abcdâ€™</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-3">String</span> <span class="cm-variable">str2</span><span class="cm-operator">=</span><span class="cm-keyword">new</span> <span class="cm-variable-3">String</span>(<span class="cm-string">"abcd"</span>);<span class="cm-comment">//å †ä¸­åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-3">String</span> <span class="cm-variable">str3</span><span class="cm-operator">=</span><span class="cm-keyword">new</span> <span class="cm-variable-3">String</span>(<span class="cm-string">"abcd"</span>);<span class="cm-comment">//å †ä¸­åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-variable">str1</span><span class="cm-operator">==</span><span class="cm-variable">str2</span>);<span class="cm-comment">//false</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-variable">str1</span><span class="cm-operator">==</span><span class="cm-variable">str2</span>);<span class="cm-comment">//false</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="display: none; height: 138px;"></div></div></div></pre><p><span>è¿™ä¸¤ç§ä¸åŒçš„åˆ›å»ºæ–¹æ³•æ˜¯æœ‰å·®åˆ«çš„ã€‚</span></p><ul><li><p><span>ç¬¬ä¸€ç§æ–¹å¼æ˜¯åœ¨å¸¸é‡æ± ä¸­æ‹¿å¯¹è±¡ï¼›</span></p></li><li><p><span>ç¬¬äºŒç§æ–¹å¼æ˜¯ç›´æ¥åœ¨å †å†…å­˜ç©ºé—´åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</span></p></li></ul><p><img src="./images/StringPool.png" referrerpolicy="no-referrer"></p><p><span>Stringç±»çš„å¸¸é‡æ± æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒçš„ä¸»è¦ä½¿ç”¨æ–¹æ³•æœ‰ä¸¤ç§ï¼š</span></p><ul><li><p><span>ç›´æ¥ä½¿ç”¨åŒå¼•å·å£°æ˜å‡ºæ¥çš„Stringå¯¹è±¡ä¼šç›´æ¥å­˜å‚¨åœ¨å¸¸é‡æ± ä¸­ã€‚</span></p></li><li><p><span>å¦‚æœä¸æ˜¯åŒå¼•å·å£°æ˜çš„Stringå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨Stringä½¿ç”¨çš„internæ–¹æ³•ã€‚</span><code>String.intern()</code><span>æ˜¯ä¸€ä¸ªNativeæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼šå¦‚æœè¿è¡Œæ—¶å¸¸é‡æ± ä¸­å·²ç»åŒ…å«äº†ä¸€ä¸ªç­‰äºStringå¯¹è±¡å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›å¸¸é‡æ± ä¸­è¯¥å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼›å¦‚æœæ²¡æœ‰ï¼ŒJDK1.7ä¹‹å‰ï¼ˆä¸åŒ…å«1.7ï¼‰çš„å¤„ç†æ–¹å¼æ˜¯åœ¨å¸¸é‡æ± ä¸­åˆ›å»ºä¸æ­¤ String å†…å®¹ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›å¸¸é‡æ± ä¸­åˆ›å»ºçš„å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼ŒJDK1.7ä»¥åŠä¹‹åçš„å¤„ç†æ–¹å¼æ˜¯åœ¨å¸¸é‡æ± ä¸­è®°å½•æ­¤å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼Œå¹¶è¿”å›è¯¥å¼•ç”¨ã€‚</span></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-3">String</span> <span class="cm-variable">s1</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable-3">String</span>(<span class="cm-string">"è®¡ç®—æœº"</span>);</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-3">String</span> <span class="cm-variable">s2</span> <span class="cm-operator">=</span> <span class="cm-variable">s1</span>.<span class="cm-variable">intern</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable-3">String</span> <span class="cm-variable">s3</span> <span class="cm-operator">=</span> <span class="cm-string">"è®¡ç®—æœº"</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-variable">s2</span>);<span class="cm-comment">//è®¡ç®—æœº</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-variable">s1</span> <span class="cm-operator">==</span> <span class="cm-variable">s2</span>);<span class="cm-comment">//falseï¼Œå› ä¸ºä¸€ä¸ªæ˜¯å †å†…å­˜ä¸­çš„ String å¯¹è±¡ä¸€ä¸ªæ˜¯å¸¸é‡æ± ä¸­çš„ String å¯¹è±¡ï¼Œ</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-variable">s3</span> <span class="cm-operator">==</span> <span class="cm-variable">s2</span>);<span class="cm-comment">//trueï¼Œå› ä¸ºä¸¤ä¸ªéƒ½æ˜¯å¸¸é‡æ± ä¸­çš„ String å¯¹è±¡</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><p><span>å­—ç¬¦ä¸²æ‹¼æ¥</span></p><ul><li><p><span>å°½é‡é¿å…å¤šä¸ªå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå› ä¸ºè¿™æ ·ä¼šé‡æ–°åˆ›å»ºå¯¹è±¡ã€‚å¦‚æœéœ€è¦æ”¹å˜å­—ç¬¦ä¸²çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨StrnigBuilderæˆ–è€…StringBuffer.</span></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-3">String</span> <span class="cm-variable">str1</span><span class="cm-operator">=</span><span class="cm-string">"str"</span>;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-3">String</span> <span class="cm-variable">str2</span><span class="cm-operator">=</span><span class="cm-string">"ing"</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-3">String</span> <span class="cm-variable">str3</span><span class="cm-operator">=</span><span class="cm-string">"str"</span><span class="cm-operator">+</span><span class="cm-string">"ing"</span>;<span class="cm-comment">//å¸¸é‡æ± ä¸­çš„å¯¹è±¡</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-3">String</span> <span class="cm-variable">str4</span><span class="cm-operator">=</span><span class="cm-variable">str1</span><span class="cm-operator">+</span><span class="cm-variable">str2</span>;<span class="cm-comment">//åœ¨å †ä¸Šåˆ›å»ºçš„æ–°çš„å¯¹è±¡</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable-3">String</span> <span class="cm-variable">str5</span><span class="cm-operator">=</span><span class="cm-string">"string"</span>;<span class="cm-comment">//å¸¸é‡æ± ä¸­çš„å¯¹è±¡</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-variable">str3</span> <span class="cm-operator">==</span> <span class="cm-variable">str4</span>);<span class="cm-comment">//false</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-variable">str3</span> <span class="cm-operator">==</span> <span class="cm-variable">str5</span>);<span class="cm-comment">//true</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">System</span>.<span class="cm-variable">out</span>.<span class="cm-variable">println</span>(<span class="cm-variable">str4</span> <span class="cm-operator">==</span> <span class="cm-variable">str5</span>);<span class="cm-comment">//false</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre><p><img src=".\images\å­—ç¬¦ä¸²æ‹¼æ¥å¸¸é‡æ± .png" referrerpolicy="no-referrer"></p><h3 id='53-string-s1--new-stringabcè¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡'><span>5.3 String s1 = new String(&quot;abc&quot;);è¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Ÿ</span></h3><p><span>å°†åˆ›å»ºä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚</span></p><ul><li><p><span>åˆ›å»ºä¸€ä¸ªåä¸ºs1çš„å˜é‡(å¼•ç”¨)ï¼›</span></p></li><li><p><span>å¦‚æœString æ± ä¸­æ²¡æœ‰&quot;abc&quot;å­˜åœ¨ï¼Œåˆ™åœ¨Stringæ± ä¸­åˆ›å»ºä¸€ä¸ªStringç±»å‹çš„&quot;abc&quot;ï¼Œæœ‰å°±ä¸åˆ›å»ºï¼›</span></p></li><li><p><span>ä½¿ç”¨newå…³é”®å­—åœ¨å †ä¸­åˆ›å»ºä¸€ä¸ªStringå¯¹è±¡</span></p></li><li><p><span>å°†newåˆ›å»ºçš„stringå¯¹è±¡çš„åœ°å€èµ‹ç»™s1</span></p></li></ul><h1 id='å…­jvmå‚æ•°'><span>å…­ã€JVMå‚æ•°</span></h1><h2 id='å †å†…å­˜ç›¸å…³'><span>å †å†…å­˜ç›¸å…³</span></h2><p><span>Java è™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼ŒJava å †æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºã€‚</span><strong><span>æ­¤å†…å­˜åŒºåŸŸçš„å”¯ä¸€ç›®çš„å°±æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ä»¥åŠæ•°ç»„éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ã€‚</span></strong></p><p><img src="assets/image-20240618164542237.png" referrerpolicy="no-referrer" alt="image-20240618164542237.png"></p><ul><li><p><strong><span>æ˜¾å¼æŒ‡å®šå †å†…å­˜</span><code>â€“Xms</code><span>å’Œ</span><code>-Xmx</code></strong></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">Xms</span><span class="cm-operator">&lt;</span><span class="cm-variable">heap</span> <span class="cm-variable">size</span><span class="cm-operator">&gt;</span>[<span class="cm-variable">unit</span>]</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">Xmx</span><span class="cm-operator">&lt;</span><span class="cm-variable">heap</span> <span class="cm-variable">size</span><span class="cm-operator">&gt;</span>[<span class="cm-variable">unit</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ä¸¾ä¸ªæ —å­</span> <span class="cm-variable">ğŸŒ°ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¸º</span> <span class="cm-variable">JVM</span> <span class="cm-variable">åˆ†é…æœ€å°</span> <span class="cm-number">2</span> <span class="cm-variable">GB</span> <span class="cm-variable">å’Œæœ€å¤§</span> <span class="cm-number">5</span> <span class="cm-variable">GB</span> <span class="cm-variable">çš„å †å†…å­˜å¤§å°ï¼Œæˆ‘ä»¬çš„å‚æ•°åº”è¯¥è¿™æ ·æ¥å†™ï¼š</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">Xms2G</span> <span class="cm-operator">-</span><span class="cm-variable">Xmx5G</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre><ul><li><p><strong><span>æ˜¾å¼æ–°ç”Ÿä»£å†…å­˜(Young Generation)</span></strong></p><ul><li><p><span>é€šè¿‡</span><code>-XX:NewSize</code><span>å’Œ</span><code>-XX:MaxNewSize</code><span>æŒ‡å®š</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">NewSize</span><span class="cm-operator">=&lt;</span><span class="cm-variable">young</span> <span class="cm-variable">size</span><span class="cm-operator">&gt;</span>[<span class="cm-variable">unit</span>]</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">MaxNewSize</span><span class="cm-operator">=&lt;</span><span class="cm-variable">young</span> <span class="cm-variable">size</span><span class="cm-operator">&gt;</span>[<span class="cm-variable">unit</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ä¸¾ä¸ªæ —å­</span> <span class="cm-variable">ğŸŒ°ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¸º</span> <span class="cm-variable">æ–°ç”Ÿä»£åˆ†é…</span> <span class="cm-variable">æœ€å°</span> <span class="cm-number">256</span><span class="cm-variable">m</span> <span class="cm-variable">çš„å†…å­˜ï¼Œæœ€å¤§</span> <span class="cm-number">1024</span><span class="cm-variable">m</span> <span class="cm-variable">çš„å†…å­˜æˆ‘ä»¬çš„å‚æ•°åº”è¯¥è¿™æ ·æ¥å†™ï¼š</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">NewSize</span><span class="cm-operator">=</span><span class="cm-number">256</span><span class="cm-variable">m</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">MaxNewSize</span><span class="cm-operator">=</span><span class="cm-number">1024</span><span class="cm-variable">m</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="display: none; height: 138px;"></div></div></div></pre></li><li><p><span>é€šè¿‡</span><code>-Xmn&lt;young size&gt;[unit]</code><span>æŒ‡å®š</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="jav"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="jav"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ä¸¾ä¸ªæ —å­ ğŸŒ°ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¸º æ–°ç”Ÿä»£åˆ†é… 256m çš„å†…å­˜ï¼ˆNewSize ä¸ MaxNewSize è®¾ä¸ºä¸€è‡´ï¼‰ï¼Œæˆ‘ä»¬çš„å‚æ•°åº”è¯¥è¿™æ ·æ¥å†™ï¼š</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-Xmn256m</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre></li></ul></li><li><p><span>é€šè¿‡ </span><strong><code>-XX:NewRatio=&lt;int&gt;</code></strong><span> æ¥è®¾ç½®è€å¹´ä»£ä¸æ–°ç”Ÿä»£å†…å­˜çš„æ¯”å€¼ã€‚</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">æ¯”å¦‚ä¸‹é¢çš„å‚æ•°å°±æ˜¯è®¾ç½®è€å¹´ä»£ä¸æ–°ç”Ÿä»£å†…å­˜çš„æ¯”å€¼ä¸º</span> <span class="cm-number">1</span><span class="cm-variable">ã€‚ä¹Ÿå°±æ˜¯è¯´è€å¹´ä»£å’Œæ–°ç”Ÿä»£æ‰€å æ¯”å€¼ä¸º</span> <span class="cm-number">1</span><span class="cm-variable">ï¼š1ï¼Œæ–°ç”Ÿä»£å æ•´ä¸ªå †æ ˆçš„</span> <span class="cm-number">1</span><span class="cm-operator">/</span><span class="cm-number">2</span><span class="cm-variable">ã€‚</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">NewRatio</span><span class="cm-operator">=</span><span class="cm-number">1</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre></li><li><p><strong><span>æ˜¾å¼æŒ‡å®šæ°¸ä¹…ä»£/å…ƒç©ºé—´çš„å¤§å° ï¼š</span></strong><span>Metaspace çš„åˆå§‹å®¹é‡å¹¶ä¸æ˜¯ </span><code>-XX:MetaspaceSize</code><span> è®¾ç½®ï¼Œæ— è®º </span><code>-XX:MetaspaceSize</code><span> é…ç½®ä»€ä¹ˆå€¼ï¼Œå¯¹äº 64 ä½ JVM æ¥è¯´ï¼ŒMetaspace çš„åˆå§‹å®¹é‡éƒ½æ˜¯ 21807104ï¼ˆçº¦ 20.8mï¼‰ã€‚</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">JDK</span> <span class="cm-number">1.8</span> <span class="cm-variable">ä¹‹å‰</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">PermSize</span><span class="cm-operator">=</span><span class="cm-variable">N</span> <span class="cm-def">#æ–¹æ³•åŒº</span> (<span class="cm-variable">æ°¸ä¹…ä»£</span>) <span class="cm-variable">åˆå§‹å¤§å°</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">MaxPermSize</span><span class="cm-operator">=</span><span class="cm-variable">N</span> <span class="cm-def">#æ–¹æ³•åŒº</span> (<span class="cm-variable">æ°¸ä¹…ä»£</span>) <span class="cm-variable">æœ€å¤§å¤§å°</span>,<span class="cm-variable">è¶…è¿‡è¿™ä¸ªå€¼å°†ä¼šæŠ›å‡º</span> <span class="cm-variable">OutOfMemoryError</span> <span class="cm-variable">å¼‚å¸¸</span>:<span class="cm-variable">java</span>.<span class="cm-variable">lang</span>.<span class="cm-variable">OutOfMemoryError</span>: <span class="cm-variable">PermGen</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">JDK</span> <span class="cm-number">1.8</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">MetaspaceSize</span><span class="cm-operator">=</span><span class="cm-variable">N</span> <span class="cm-variable">#è®¾ç½®</span> <span class="cm-variable">Metaspace</span> <span class="cm-variable">çš„åˆå§‹å¤§å°ï¼ˆæ˜¯ä¸€ä¸ªå¸¸è§çš„è¯¯åŒºï¼Œåé¢ä¼šè§£é‡Šï¼‰</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">MaxMetaspaceSize</span><span class="cm-operator">=</span><span class="cm-variable">N</span> <span class="cm-variable">#è®¾ç½®</span> <span class="cm-variable">Metaspace</span> <span class="cm-variable">çš„æœ€å¤§å¤§å°</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre></li></ul><h2 id='åƒåœ¾æ”¶é›†ç›¸å…³'><span>åƒåœ¾æ”¶é›†ç›¸å…³</span></h2><ul><li><p><span>åƒåœ¾å›æ”¶å™¨JVM å…·æœ‰å››ç§ç±»å‹çš„ GC å®ç°ï¼š</span></p><ul><li><p><span>ä¸²è¡Œåƒåœ¾æ”¶é›†å™¨</span></p></li><li><p><span>å¹¶è¡Œåƒåœ¾æ”¶é›†å™¨</span></p></li><li><p><span>CMS åƒåœ¾æ”¶é›†å™¨</span></p></li><li><p><span>G1 åƒåœ¾æ”¶é›†å™¨</span></p></li></ul></li></ul><p><span>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‚æ•°å£°æ˜è¿™äº›å®ç°ï¼š</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseSerialGC</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseParallelGC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseConcMarkSweepGC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseG1GC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre><ul><li><p><span>GCæ—¥å¿—è®°å½•</span></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">å¿…é€‰</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">æ‰“å°åŸºæœ¬</span> <span class="cm-variable">GC</span> <span class="cm-variable">ä¿¡æ¯</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintGCDetails</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintGCDateStamps</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">æ‰“å°å¯¹è±¡åˆ†å¸ƒ</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintTenuringDistribution</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">æ‰“å°å †æ•°æ®</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintHeapAtGC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">æ‰“å°Referenceå¤„ç†ä¿¡æ¯</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">å¼ºå¼•ç”¨</span><span class="cm-operator">/</span><span class="cm-variable">å¼±å¼•ç”¨</span><span class="cm-operator">/</span><span class="cm-variable">è½¯å¼•ç”¨</span><span class="cm-operator">/</span><span class="cm-variable">è™šå¼•ç”¨</span><span class="cm-operator">/</span><span class="cm-variable">finalize</span> <span class="cm-variable">ç›¸å…³çš„æ–¹æ³•</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintReferenceGC</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">æ‰“å°STWæ—¶é—´</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintGCApplicationStoppedTime</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">å¯é€‰</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">æ‰“å°safepointä¿¡æ¯ï¼Œè¿›å…¥</span> <span class="cm-variable">STW</span> <span class="cm-variable">é˜¶æ®µä¹‹å‰ï¼Œéœ€è¦è¦æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„</span> <span class="cm-variable">safepoint</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">PrintSafepointStatistics</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">PrintSafepointStatisticsCount</span><span class="cm-operator">=</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">GCæ—¥å¿—è¾“å‡ºçš„æ–‡ä»¶è·¯å¾„</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">Xloggc</span>:<span class="cm-operator">/</span><span class="cm-variable">path</span><span class="cm-operator">/</span><span class="cm-variable">to</span><span class="cm-operator">/</span><span class="cm-variable">gc</span><span class="cm-operator">-%</span><span class="cm-variable">t</span>.<span class="cm-variable">log</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">å¼€å¯æ—¥å¿—æ–‡ä»¶åˆ†å‰²</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseGCLogFileRotation</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">æœ€å¤šåˆ†å‰²å‡ ä¸ªæ–‡ä»¶ï¼Œè¶…è¿‡ä¹‹åä»å¤´æ–‡ä»¶å¼€å§‹å†™</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">NumberOfGCLogFiles</span><span class="cm-operator">=</span><span class="cm-number">14</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#</span> <span class="cm-variable">æ¯ä¸ªæ–‡ä»¶ä¸Šé™å¤§å°ï¼Œè¶…è¿‡å°±è§¦å‘åˆ†å‰²</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">GCLogFileSize</span><span class="cm-operator">=</span><span class="cm-number">50</span><span class="cm-variable">M</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 644px;"></div><div class="CodeMirror-gutters" style="display: none; height: 644px;"></div></div></div></pre><h2 id='å¤„ç†oom'><span>å¤„ç†OOM</span></h2><p><span>å¯¹äºå¤§å‹åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œé¢å¯¹å†…å­˜ä¸è¶³é”™è¯¯æ˜¯éå¸¸å¸¸è§çš„ï¼Œè¿™åè¿‡æ¥ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å…³é”®çš„åœºæ™¯ï¼Œå¾ˆéš¾é€šè¿‡å¤åˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</span></p><p><span>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ JVM æä¾›äº†ä¸€äº›å‚æ•°ï¼Œè¿™äº›å‚æ•°å°†å †å†…å­˜è½¬å‚¨åˆ°ä¸€ä¸ªç‰©ç†æ–‡ä»¶ä¸­ï¼Œä»¥åå¯ä»¥ç”¨æ¥æŸ¥æ‰¾æ³„æ¼:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">HeapDumpOnOutOfMemoryError</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">HeapDumpPath</span><span class="cm-operator">=</span>.<span class="cm-operator">/</span><span class="cm-variable">java_pid</span><span class="cm-operator">&lt;</span><span class="cm-variable">pid</span><span class="cm-operator">&gt;</span>.<span class="cm-variable">hprof</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-variable">OnOutOfMemoryError</span><span class="cm-operator">=</span><span class="cm-string">"&lt; cmd args &gt;;&lt; cmd args &gt;"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-</span><span class="cm-variable">XX</span>:<span class="cm-operator">+</span><span class="cm-variable">UseGCOverheadLimit</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre><p><span>è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„:</span></p><ul><li><p><strong><span>HeapDumpOnOutOfMemoryError</span></strong><span> æŒ‡ç¤º JVM åœ¨é‡åˆ° </span><strong><span>OutOfMemoryError</span></strong><span> é”™è¯¯æ—¶å°† heap è½¬å‚¨åˆ°ç‰©ç†æ–‡ä»¶ä¸­ã€‚</span></p></li><li><p><strong><span>HeapDumpPath</span></strong><span> è¡¨ç¤ºè¦å†™å…¥æ–‡ä»¶çš„è·¯å¾„; å¯ä»¥ç»™å‡ºä»»ä½•æ–‡ä»¶å; ä½†æ˜¯ï¼Œå¦‚æœ JVM åœ¨åç§°ä¸­æ‰¾åˆ°ä¸€ä¸ª </span><code>&lt;pid&gt;</code><span> æ ‡è®°ï¼Œåˆ™å½“å‰è¿›ç¨‹çš„è¿›ç¨‹ id å°†é™„åŠ åˆ°æ–‡ä»¶åä¸­ï¼Œå¹¶ä½¿ç”¨</span><code>.hprof</code><span>æ ¼å¼</span></p></li><li><p><strong><span>OnOutOfMemoryError</span></strong><span> ç”¨äºå‘å‡ºç´§æ€¥å‘½ä»¤ï¼Œä»¥ä¾¿åœ¨å†…å­˜ä¸è¶³çš„æƒ…å†µä¸‹æ‰§è¡Œ; åº”è¯¥åœ¨ </span><code>cmd args</code><span> ç©ºé—´ä¸­ä½¿ç”¨é€‚å½“çš„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨å†…å­˜ä¸è¶³æ—¶é‡å¯æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®å‚æ•°: </span><code>-XX:OnOutOfMemoryError=&quot;shutdown -r&quot;</code><span> ã€‚</span></p></li><li><p><strong><span>UseGCOverheadLimit</span></strong><span> æ˜¯ä¸€ç§ç­–ç•¥ï¼Œå®ƒé™åˆ¶åœ¨æŠ›å‡º OutOfMemory é”™è¯¯ä¹‹å‰åœ¨ GC ä¸­èŠ±è´¹çš„ VM æ—¶é—´çš„æ¯”ä¾‹</span></p></li></ul><h2 id='å…¶ä»–'><span>å…¶ä»–</span></h2><ul><li><p><code>-server</code><span> : å¯ç”¨â€œ Server Hotspot VMâ€; æ­¤å‚æ•°é»˜è®¤ç”¨äº 64 ä½ JVM</span></p></li><li><p><code>-XX:+UseStringDeduplication</code><span> : </span><em><span>Java 8u20</span></em><span> å¼•å…¥äº†è¿™ä¸ª JVM å‚æ•°ï¼Œé€šè¿‡åˆ›å»ºå¤ªå¤šç›¸åŒ String çš„å®ä¾‹æ¥å‡å°‘ä¸å¿…è¦çš„å†…å­˜ä½¿ç”¨; è¿™é€šè¿‡å°†é‡å¤ String å€¼å‡å°‘ä¸ºå•ä¸ªå…¨å±€ </span><code>char []</code><span> æ•°ç»„æ¥ä¼˜åŒ–å †å†…å­˜ã€‚</span></p></li><li><p><code>-XX:+UseLWPSynchronization</code><span>: è®¾ç½®åŸºäº LWP (è½»é‡çº§è¿›ç¨‹)çš„åŒæ­¥ç­–ç•¥ï¼Œè€Œä¸æ˜¯åŸºäºçº¿ç¨‹çš„åŒæ­¥ã€‚</span></p></li><li><p><code>-XX:LargePageSizeInBytes</code><span>: è®¾ç½®ç”¨äº Java å †çš„è¾ƒå¤§é¡µé¢å¤§å°; å®ƒé‡‡ç”¨ GB/MB/KB çš„å‚æ•°; é¡µé¢å¤§å°è¶Šå¤§ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°åˆ©ç”¨è™šæ‹Ÿå†…å­˜ç¡¬ä»¶èµ„æº; ç„¶è€Œï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ PermGen çš„ç©ºé—´å¤§å°æ›´å¤§ï¼Œè¿™åè¿‡æ¥åˆä¼šè¿«ä½¿ Java å †ç©ºé—´çš„å¤§å°å‡å°ã€‚</span></p></li><li><p><code>-XX:MaxHeapFreeRatio</code><span> : è®¾ç½® GC å, å †ç©ºé—²çš„æœ€å¤§ç™¾åˆ†æ¯”ï¼Œä»¥é¿å…æ”¶ç¼©ã€‚</span></p></li><li><p><code>-XX:SurvivorRatio</code><span> : eden/survivor ç©ºé—´çš„æ¯”ä¾‹, ä¾‹å¦‚</span><code>-XX:SurvivorRatio=6</code><span> è®¾ç½®æ¯ä¸ª survivor å’Œ eden ä¹‹é—´çš„æ¯”ä¾‹ä¸º 1:6ã€‚</span></p></li><li><p><code>-XX:+UseLargePages</code><span> : å¦‚æœç³»ç»Ÿæ”¯æŒï¼Œåˆ™ä½¿ç”¨å¤§é¡µé¢å†…å­˜; è¯·æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨è¿™ä¸ª JVM å‚æ•°ï¼ŒOpenJDK 7 å¯èƒ½ä¼šå´©æºƒã€‚</span></p></li><li><p><code>-XX:+UseStringCache</code><span> : å¯ç”¨ String æ± ä¸­å¯ç”¨çš„å¸¸ç”¨åˆ†é…å­—ç¬¦ä¸²çš„ç¼“å­˜ã€‚</span></p></li><li><p><code>-XX:+UseCompressedStrings</code><span> : å¯¹ String å¯¹è±¡ä½¿ç”¨ </span><code>byte []</code><span> ç±»å‹ï¼Œè¯¥ç±»å‹å¯ä»¥ç”¨çº¯ ASCII æ ¼å¼è¡¨ç¤ºã€‚</span></p></li><li><p><code>-XX:+OptimizeStringConcat</code><span> : å®ƒå°½å¯èƒ½ä¼˜åŒ–å­—ç¬¦ä¸²ä¸²è”æ“ä½œã€‚</span></p></li></ul><h1 id='ä¸ƒjdkç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·æ€»ç»“'><span>ä¸ƒã€JDKç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·æ€»ç»“</span></h1><h2 id='jdk-å‘½ä»¤è¡Œå·¥å…·'><span>JDK å‘½ä»¤è¡Œå·¥å…·</span></h2><p><span>è¿™äº›å‘½ä»¤åœ¨ JDK å®‰è£…ç›®å½•ä¸‹çš„ bin ç›®å½•ä¸‹ï¼š</span></p><ul><li><p><strong><code>jps</code></strong><span> (JVM Process Statusï¼‰: ç±»ä¼¼ UNIX çš„ </span><code>ps</code><span> å‘½ä»¤ã€‚ç”¨äºæŸ¥çœ‹æ‰€æœ‰ Java è¿›ç¨‹çš„å¯åŠ¨ç±»ã€ä¼ å…¥å‚æ•°å’Œ Java è™šæ‹Ÿæœºå‚æ•°ç­‰ä¿¡æ¯ï¼›</span></p></li><li><p><strong><code>jstat</code></strong><span>ï¼ˆJVM Statistics Monitoring Toolï¼‰: ç”¨äºæ”¶é›† HotSpot è™šæ‹Ÿæœºå„æ–¹é¢çš„è¿è¡Œæ•°æ®;</span></p></li><li><p><strong><code>jinfo</code></strong><span> (Configuration Info for Java) : Configuration Info for Java,æ˜¾ç¤ºè™šæ‹Ÿæœºé…ç½®ä¿¡æ¯;</span></p></li><li><p><strong><code>jmap</code></strong><span> (Memory Map for Java) : ç”Ÿæˆå †è½¬å‚¨å¿«ç…§;</span></p></li><li><p><strong><code>jhat</code></strong><span> (JVM Heap Dump Browser) : ç”¨äºåˆ†æ heapdump æ–‡ä»¶ï¼Œå®ƒä¼šå»ºç«‹ä¸€ä¸ª HTTP/HTML æœåŠ¡å™¨ï¼Œè®©ç”¨æˆ·å¯ä»¥åœ¨æµè§ˆå™¨ä¸ŠæŸ¥çœ‹åˆ†æç»“æœã€‚JDK9 ç§»é™¤äº† jhatï¼›</span></p></li><li><p><strong><code>jstack</code></strong><span> (Stack Trace for Java) : ç”Ÿæˆè™šæ‹Ÿæœºå½“å‰æ—¶åˆ»çš„çº¿ç¨‹å¿«ç…§ï¼Œçº¿ç¨‹å¿«ç…§å°±æ˜¯å½“å‰è™šæ‹Ÿæœºå†…æ¯ä¸€æ¡çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•å †æ ˆçš„é›†åˆã€‚</span></p></li></ul><h2 id='jdk-å¯è§†åŒ–åˆ†æå·¥å…·'><span>JDK å¯è§†åŒ–åˆ†æå·¥å…·</span></h2><p><a href='https://javaguide.cn/java/jvm/jdk-monitoring-and-troubleshooting-tools.html#jconsole-java-%E7%9B%91%E8%A7%86%E4%B8%8E%E7%AE%A1%E7%90%86%E6%8E%A7%E5%88%B6%E5%8F%B0' target='_blank' class='url'>https://javaguide.cn/java/jvm/jdk-monitoring-and-troubleshooting-tools.html#jconsole-java-%E7%9B%91%E8%A7%86%E4%B8%8E%E7%AE%A1%E7%90%86%E6%8E%A7%E5%88%B6%E5%8F%B0</a></p><ul><li><p><span>JConsole æ˜¯åŸºäº JMX çš„å¯è§†åŒ–ç›‘è§†ã€ç®¡ç†å·¥å…·ã€‚å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç›‘è§†æœ¬åœ°åŠè¿œç¨‹æœåŠ¡å™¨çš„ java è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨æƒ…å†µã€‚ä½ å¯ä»¥åœ¨æ§åˆ¶å°è¾“å…¥</span><code>jconsole</code><span>å‘½ä»¤å¯åŠ¨æˆ–è€…åœ¨ JDK ç›®å½•ä¸‹çš„ bin ç›®å½•æ‰¾åˆ°</span><code>jconsole.exe</code><span>ç„¶ååŒå‡»å¯åŠ¨ã€‚</span></p></li><li><p><span>VisualVM æä¾›åœ¨ Java è™šæ‹Ÿæœº (Java Virtual Machine, JVM) ä¸Šè¿è¡Œçš„ Java åº”ç”¨ç¨‹åºçš„è¯¦ç»†ä¿¡æ¯ã€‚</span></p></li><li><p><span>MATï¼ˆMemory Analyzer Toolï¼‰æ˜¯ä¸€æ¬¾å¿«é€Ÿä¾¿æ·ä¸”åŠŸèƒ½å¼ºå¤§ä¸°å¯Œçš„ JVM å †å†…å­˜ç¦»çº¿åˆ†æå·¥å…·ã€‚å…¶é€šè¿‡å±•ç° JVM å¼‚å¸¸æ—¶æ‰€è®°å½•çš„è¿è¡Œæ—¶å †è½¬å‚¨å¿«ç…§ï¼ˆHeap dumpï¼‰çŠ¶æ€ï¼ˆæ­£å¸¸è¿è¡Œæ—¶ä¹Ÿå¯ä»¥åšå †è½¬å‚¨åˆ†æï¼‰ï¼Œå¸®åŠ©å®šä½å†…å­˜æ³„æ¼é—®é¢˜æˆ–ä¼˜åŒ–å¤§å†…å­˜æ¶ˆè€—é€»è¾‘ã€‚</span></p></li></ul></div></div>

<script>(function(){var e=document.body.parentElement,t=[],n=null,i=document.body.classList.contains("typora-export-collapse-outline"),r=function(e,t,n){document.addEventListener(e,function(e){if(!e.defaultPrevented)for(var i=e.target;i&&i!=this;i=i.parentNode)if(i.matches(t)){!1===n.call(i,e)&&(e.preventDefault(),e.stopPropagation());break}},!1)};function o(){return e.scrollTop}r("click",".outline-expander",function(e){var t=this.closest(".outline-item-wrapper").classList;return t.contains("outline-item-open")?t.remove("outline-item-open"):t.add("outline-item-open"),d(),!1}),r("click",".outline-item",function(e){var t=this.querySelector(".outline-label");if(location.hash="#"+t.getAttribute("href"),i){var n=this.closest(".outline-item-wrapper").classList;n.contains("outline-item-open")||n.add("outline-item-open"),c(),n.add("outline-item-active")}});var a,s,l=function(){var e=o();n=null;for(var i=0;i<t.length&&t[i][1]-e<60;i++)n=t[i]},c=function(){document.querySelectorAll(".outline-item-active").forEach(e=>e.classList.remove("outline-item-active")),document.querySelectorAll(".outline-item-single.outline-item-open").forEach(e=>e.classList.remove("outline-item-open"))},d=function(){if(n){c();var e=document.querySelector('.outline-label[href="#'+(CSS.escape?CSS.escape(n[0]):n[0])+'"]');if(e)if(i){var t=e.closest(".outline-item-open>ul>.outline-item-wrapper");if(t)t.classList.add("outline-item-active");else{for(var r=(e=e.closest(".outline-item-wrapper")).parentElement.closest(".outline-item-wrapper");r;)r=(e=r).parentElement.closest(".outline-item-wrapper");e.classList.add("outline-item-active")}}else e.closest(".outline-item-wrapper").classList.add("outline-item-active")}};window.addEventListener("scroll",function(e){a&&clearTimeout(a),a=setTimeout(function(){l(),d()},300)});var u=function(){s=setTimeout(function(){!function(){t=[];var e=o();document.querySelector("#write").querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(n=>{var i=n.getAttribute("id");t.push([i,e+n.getBoundingClientRect().y])})}(),l(),d()},300)};window.addEventListener("resize",function(e){s&&clearTimeout(s),u()}),u()})();</script></body>
</html>